<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<title>QUnit Test Suite</title>
		<link rel="stylesheet" href="../node_modules/qunitjs/qunit/qunit.css" type="text/css" media="screen">
		<link rel="stylesheet" href="./vendor/qunit-image.css" type="text/css" media="screen">
	</head>
	<body>

		<div id="failing" style="display: none">
			<h2>Summary of failing tests</h2>
			<table>
				<thead>
					<tr>
						<th>Module</th><th>Name</th><th>Actual</th><th>Expected</th><th>Message</th>
					</tr>
				</thead>
				<tbody id="errortable">
				</tbody>
			</table>

			<h2>Complete test suite</h2>
		</div>


		<div id="qunit"></div>
		<div id="qunit-fixture"></div>
		<div id="testPlots" style="display: none"></div>

		<script src="../node_modules/qunitjs/qunit/qunit.js"></script>
		<script>
			QUnit.config.hidepassed = true;

			/*
			QUnit.log(function (details) {
				if (!details.result) {
					document.getElementById('errortable').innerHTML += '<tr><td>' + [details.module, details.name, details.actual, details.expected, details.message].join('</td><td>') + '</td></tr>' 
				}
			});

			QUnit.done(function (details) {
				if (details.failed) {
					document.getElementById('failing').style.setProperty('display', 'block');
				}
			});
			*/
		
			var log = [];
			var testName;
			QUnit.done = function (test_results) {
				var tests = log.map(function(details){
					return {
						name: details.name,
						result: details.result,
						expected: details.expected,
						actual: details.actual,
						source: details.source
					}
				});
				test_results.tests = tests;
			
				// delaying results a bit cause in real-world
				// scenario you won't get them immediately
				setTimeout(function () { window.global_test_results = test_results; }, 2000);
			};
			QUnit.testStart(function(testDetails){
				QUnit.log = function(details){
					if (!details.result) {
						details.name = testDetails.name;
						log.push(details);
					}
				}
			});

		</script>
		<script src="../build/MathLib.js"></script>
		<script src="../build/MathLib.test.js"></script>
	</body>
</html>
