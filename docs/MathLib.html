<!DOCTYPE html>

<html>
<head>
  <title>MathLib.ts</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>MathLib.ts</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <p>MathLib.js is a JavaScript library for mathematical computations.</p>
<h2 id="version">Version</h2>
<p>v0.6.1 - 2013-11-10<br>MathLib is currently in public beta testing.</p>
<h2 id="license">License</h2>
<p>Copyright (c) 2013 Alexander Zeilmann<br>MathLib.js is <a href="http://MathLib.de/en/license">licensed under the MIT license</a></p>
<h2 id="documentation">Documentation</h2>
<p>The source code is annotated using <a href="https://github.com/jashkenas/docco" title="View Docco on GitHub">Docco</a>
(with a modified css-file).
The syntax is more or less the JSDoc syntax.
A more detailed documentation will be coming soon.</p>
<h2 id="code-structure">Code structure</h2>
<p>The code is separated into several modules.
The first module contains some internal functions</p>
<p>Next is the <a href="#Expression" title="Jump to the Expression implementation">Expression</a> module 
and the <a href="#Functn" title="Jump to the function implementation">functions</a> module.</p>
<p>Then drawing modules:</p>
<ul>
<li><a href="#Screen" title="Jump to the screen implementation">screen</a></li>
<li><a href="#Screen2D" title="Jump to the implementation for 2D plotting">screen2D</a></li>
<li><a href="#Screen3D" title="Jump to the implementation for 3D plotting">screen3D</a></li>
</ul>
<p>The next module is the <a href="#Vector" title="Jump to the vector implementation">vector</a> module, because the Point and the Line module depend on it.</p>
<p>And at last the other modules in alphabetic order:</p>
<ul>
<li><a href="#Circle" title="Jump to the circle implementation">circle</a></li>
<li><a href="#Complex" title="Jump to the complex number implementation">complex</a></li>
<li><a href="#Expression" title="Jump to the expression implementation">expression</a></li>
<li><a href="#Line" title="Jump to the line implementation">line</a></li>
<li><a href="#Matrix" title="Jump to the matrix implementation">matrix</a></li>
<li><a href="#Permutation" title="Jump to the permutation implementation">permutation</a></li>
<li><a href="#Point" title="Jump to the point implementation">point</a></li>
<li><a href="#Polynomial" title="Jump to the polynomial implementation">polynomial</a></li>
<li><a href="#Rational" title="Jump to the rational number implementation">rational</a></li>
<li><a href="#Set" title="Jump to the set implementation">set</a>
The MathLib module which wraps everything</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>module MathLib {</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Typescript is throwing the following error otherwise:
The property &#39;methodname&#39; does not exist on value of type &#39;MathLib&#39;
see <a href="http://typescript.codeplex.com/discussions/397908"><a href="http://typescript.codeplex.com/discussions/397908">http://typescript.codeplex.com/discussions/397908</a></a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	declare <span class="keyword">var</span> MathLib : any;
	declare <span class="keyword">var</span> MathJax : any;
	declare <span class="keyword">var</span> THREE : any;



	MathLib.version = <span class="string">'0.6.1'</span>;
	MathLib.apery = <span class="number">1.2020569031595942</span>;
	MathLib.e = Math.E;</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Number.EPSILON is probably coming in ES6
(see section 20.1.2.1 in the current draft)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	MathLib.epsilon = (<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>Number).EPSILON || (function () {
			var next, result;
			for (next = 1; 1 + next !== 1; next = next / 2) {
				result = next;
			}
			return result;
		}());
	MathLib.eulerMascheroni = 0.5772156649015329;
	MathLib.goldenRatio = 1.618033988749895;
	MathLib.pi = Math.PI;

	MathLib.isArrayLike = function (x) {
		return typeof x === 'object' &amp;&amp; 'length' in x;
	};

	MathLib.isNative = function (fn) {
		return fn &amp;&amp; /^[^{]+\{\s*\[native \w/.test(fn.toString()) ? fn : false;
	};

	MathLib.argToRgba = function (h){
  	var r, g, b;
  	h = -h / (2 * Math.PI);

  	function hue2rgb(t){
   	  if (t <span class="tag">&lt; <span class="attribute">0</span>) {
   	  	<span class="attribute">t</span> += <span class="attribute">1</span>;
   	  }
     	<span class="attribute">if</span> (<span class="attribute">t</span> &gt;</span> 1) {
     		t -= 1;
     	}
     	if (t <span class="tag">&lt; <span class="attribute">1</span>/<span class="attribute">6</span>) {
     		<span class="attribute">return</span> <span class="attribute">6</span> * <span class="attribute">t</span>;
     	}
     	<span class="attribute">if</span> (<span class="attribute">t</span> &lt; <span class="attribute">1</span>/<span class="attribute">2</span>) {
     		<span class="attribute">return</span> <span class="attribute">1</span>;
     	}
     	<span class="attribute">if</span> (<span class="attribute">t</span> &lt; <span class="attribute">2</span>/<span class="attribute">3</span>) {
     		<span class="attribute">return</span> <span class="attribute">4</span> <span class="attribute">-</span> <span class="attribute">6</span>*<span class="attribute">t</span>;
     	}
      <span class="attribute">return</span> <span class="attribute">0</span>;
 	 }

  	<span class="attribute">r</span> = <span class="attribute">hue2rgb</span>(<span class="attribute">h</span> + <span class="attribute">1</span>/<span class="attribute">3</span>);
  	<span class="attribute">g</span> = <span class="attribute">hue2rgb</span>(<span class="attribute">h</span>);
  	<span class="attribute">b</span> = <span class="attribute">hue2rgb</span>(<span class="attribute">h</span> <span class="attribute">-</span> <span class="attribute">1</span>/<span class="attribute">3</span>);

  	<span class="attribute">return</span> [<span class="attribute">r</span> * <span class="attribute">255</span>, <span class="attribute">g</span> * <span class="attribute">255</span>, <span class="attribute">b</span> * <span class="attribute">255</span>, <span class="attribute">255</span>];
	};


	<span class="attribute">var</span> <span class="attribute">flatten</span> = <span class="attribute">function</span> (<span class="attribute">a</span>) {
				<span class="attribute">var</span> <span class="attribute">flattendArray</span> = [];
				<span class="attribute">a.forEach</span>(<span class="attribute">function</span> (<span class="attribute">x</span>) {
					<span class="attribute">if</span> (<span class="attribute">Array.isArray</span>(<span class="attribute">x</span>)) {
						<span class="attribute">flattendArray</span> = <span class="attribute">flattendArray.concat</span>(<span class="attribute">flatten</span>(<span class="attribute">x</span>));
					}
					<span class="attribute">else</span> {
						<span class="attribute">flattendArray.push</span>(<span class="attribute">x</span>);
					}
				});
				<span class="attribute">return</span> <span class="attribute">flattendArray</span>;
			},
			<span class="attribute">extendObject</span> = <span class="attribute">function</span> (<span class="attribute">dest</span>, <span class="attribute">src</span>) {
				<span class="attribute">for</span> (<span class="attribute">var</span> <span class="attribute">prop</span> <span class="attribute">in</span> <span class="attribute">src</span>) {
					<span class="attribute">if</span> (<span class="attribute">typeof</span> <span class="attribute">dest</span>[<span class="attribute">prop</span>] =<span class="value">==</span> '<span class="attribute">object</span>' &amp;&amp; <span class="attribute">typeof</span> <span class="attribute">src</span>[<span class="attribute">prop</span>] =<span class="value">==</span> '<span class="attribute">object</span>') {
						<span class="attribute">dest</span>[<span class="attribute">prop</span>] = <span class="attribute">extendObject</span>(<span class="attribute">dest</span>[<span class="attribute">prop</span>], <span class="attribute">src</span>[<span class="attribute">prop</span>]);
					}
					<span class="attribute">else</span> {
						<span class="attribute">dest</span>[<span class="attribute">prop</span>] = <span class="attribute">src</span>[<span class="attribute">prop</span>];
					}
				}
				<span class="attribute">return</span> <span class="attribute">dest</span>;
			},

</span></pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>A little function converting arrays to THREE.js vectors</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			to3js = <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
				<span class="keyword">if</span> (x.length === <span class="number">2</span>) {
					<span class="keyword">return</span> <span class="keyword">new</span> THREE.Vector2(x[<span class="number">0</span>], x[<span class="number">1</span>]);
				}
				<span class="keyword">else</span> <span class="keyword">if</span> (x.length === <span class="number">3</span>) {
					<span class="keyword">return</span> <span class="keyword">new</span> THREE.Vector3(x[<span class="number">0</span>], x[<span class="number">1</span>], x[<span class="number">2</span>]);
				}
			},

			colorConvert = <span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span>
				<span class="keyword">if</span> (<span class="keyword">typeof</span> n === <span class="string">'number'</span>) {
					n = Math.max(Math.min(Math.floor(n), <span class="number">0xffffff</span>), <span class="number">0</span>);
					<span class="keyword">return</span> <span class="string">'#'</span> + (<span class="string">'00000'</span> + n.toString(<span class="number">16</span>)).slice(-<span class="number">6</span>); 
				}
				<span class="keyword">return</span> n;
			};


<span class="keyword">var</span> template = <span class="function"><span class="keyword">function</span> <span class="params">(data)</span> {</span><span class="keyword">var</span> p = [];p.push(<span class="string">' &lt;figure class="MathLib_figure"&gt;     &lt;div class="MathLib_wrapper" style="width: '</span>);
p.push(data.width);
p.push(<span class="string">'px; height: '</span>);
p.push(data.height);
p.push(<span class="string">'px"&gt;   &lt;div class="MathLib_info_message"&gt;Your browser does not seem to support WebGL.&lt;br&gt;   Please update your browser to see the plot.&lt;/div&gt;  &lt;/div&gt;      '</span>);
<span class="keyword">if</span> (data.figcaption) {
	p.push(<span class="string">'   &lt;figcaption class="MathLib_figcaption"&gt;'</span>);
p.push(data.figcaption);
p.push(<span class="string">'&lt;/figcaption&gt;  '</span>);
}
p.push(<span class="string">'  &lt;/figure&gt;  '</span>);
<span class="keyword">if</span> (data.contextMenu) {
	p.push(<span class="string">'  &lt;div class="MathLib_contextMenuOverlay"&gt;   &lt;menu class="MathLib_menu MathLib_mainmenu"&gt;          '</span>);
<span class="keyword">if</span> (data.contextMenu.screenshot) {
	p.push(<span class="string">'     &lt;div class="MathLib_screenshot MathLib_menuItem"&gt;Save Screenshot&lt;/div&gt;    '</span>);
}
p.push(<span class="string">'      '</span>);
<span class="keyword">if</span> (data.contextMenu.fullscreen) {
	p.push(<span class="string">'     &lt;div class="MathLib_fullscreen MathLib_menuItem"&gt;      &lt;span class="needs-nofullscreen"&gt;Enter Fullscreen&lt;/span&gt;      &lt;span class="needs-fullscreen"&gt;Exit Fullscreen&lt;/span&gt;     &lt;/div&gt;    '</span>);
}
p.push(<span class="string">'      '</span>);
<span class="keyword">if</span> (data.contextMenu.grid) {
	p.push(<span class="string">'     &lt;div class="MathLib_menuItem MathLib_hasSubmenu"&gt;      Grid      &lt;menu class="MathLib_menu MathLib_submenu"&gt;       &lt;div class="MathLib_needs2D"&gt;        &lt;label class="MathLib_menuItem"&gt;         &lt;input type="radio" name="MathLib_grid_type_'</span>);
p.push(data.uuid);
p.push(<span class="string">'" class="MathLib_radio MathLib_grid_type" value="cartesian"&gt;cartesian        &lt;/label&gt;        &lt;label class="MathLib_menuItem"&gt;         &lt;input type="radio" name="MathLib_grid_type_'</span>);
p.push(data.uuid);
p.push(<span class="string">'" class="MathLib_radio MathLib_grid_type" value="polar"&gt;polar        &lt;/label&gt;        &lt;label class="MathLib_menuItem"&gt;         &lt;input type="radio" name="MathLib_grid_type_'</span>);
p.push(data.uuid);
p.push(<span class="string">'" class="MathLib_radio MathLib_grid_type" value="none"&gt;none        &lt;/label&gt;       &lt;/div&gt;        &lt;div class="MathLib_needs3D MathLib_menuItem MathLib_is_disabled" style="font-size: 0.7em"&gt;        Gridoptions for 3D are coming soon.       &lt;/div&gt;      &lt;/menu&gt;     &lt;/div&gt;    '</span>);
}
p.push(<span class="string">'      &lt;hr class="MathLib_separator"&gt;    &lt;div class="MathLib_is_disabled MathLib_menuItem MathLib_is_centered" style="font-size:0.83em"&gt;     Plot generated by MathLib.js    &lt;/div&gt;   &lt;/menu&gt;  &lt;/div&gt; '</span>);
}
p.push(<span class="string">''</span>);
<span class="keyword">return</span> p.join(<span class="string">""</span>);
}


<span class="keyword">var</span> errors = [],
		warnings = [];</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <h3 id="-mathlib-on-http-mathlib-de-en-docs-on-"><a href="http://mathlib.de/en/docs/on">MathLib.on()</a></h3>
<p>Binds an event handler to an event.</p>
<p><em>@param {string}</em> The name of the event.<br><em>@param {function}</em> The callback function.  </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>MathLib.on = <span class="function"><span class="keyword">function</span> <span class="params">(type, callback)</span> {</span>
	<span class="keyword">if</span> (type === <span class="string">'error'</span>) {
		errors.push(callback);
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">'warning'</span>) {
		warnings.push(callback);
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <h3 id="-mathlib-off-http-mathlib-de-en-docs-off-"><a href="http://mathlib.de/en/docs/off">MathLib.off()</a></h3>
<p>Unbinds an event handler from an event.</p>
<p><em>@param {string}</em> The name of the event.<br><em>@param {function}</em> The callback function.  </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>MathLib.off = <span class="function"><span class="keyword">function</span> <span class="params">(type, callback)</span> {</span>
	<span class="keyword">if</span> (type === <span class="string">'error'</span>) {
		errors = errors.filter(x =&gt; x !== callback);
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">'warning'</span>) {
		warnings = warnings.filter(x =&gt; x !== callback);
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <h3 id="mathlib-error-">MathLib.error()</h3>
<p>Fires an error event.</p>
<p><em>@param {oject}</em> An object describing the error further.  </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>MathLib.error = <span class="function"><span class="keyword">function</span> <span class="params">(details)</span> {</span>
	errors.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(cb)</span> {</span>
		cb(details);
	});
};</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <h3 id="mathlib-warning-">MathLib.warning()</h3>
<p>Fires a waring event.</p>
<p><em>@param {object}</em> An object describing the warning further.  </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>MathLib.warning = <span class="function"><span class="keyword">function</span> <span class="params">(details)</span> {</span>
	warnings.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(cb)</span> {</span>
		cb(details);
	});
};</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <h2 id="-a-id-expression-href-http-mathlib-de-en-docs-expression-expression-a-"><a id="Expression" href="http://mathlib.de/en/docs/Expression">Expression</a></h2>
<p>MathLib.Expression is the MathLib implementation of symbolic expressions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>export class Expression {

	type = <span class="string">'expression'</span>;

	arguments: string[];
	content: any;
	isMethod: boolean;
	mode: string;
	name: string;
	subtype: string;
	value: any;


	constructor(expr = {}) {
		<span class="keyword">var</span> prop;

		<span class="keyword">if</span> (<span class="keyword">typeof</span> expr === <span class="string">'string'</span>) {
			expr = MathLib.Expression.parse(expr);
		}
		<span class="keyword">for</span> (prop <span class="keyword">in</span> expr) {
			<span class="keyword">if</span> (expr.hasOwnProperty(prop)) {
				<span class="keyword">this</span>[prop] = expr[prop];
			}
		}
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <h3 id="-expression-prototype-compare-http-mathlib-de-en-docs-expression-compare-"><a href="http://mathlib.de/en/docs/Expression/compare">Expression.prototype.compare()</a></h3>
<p>Compares two expressions</p>
<p><em>@param {Expression}</em> The expression to compare<br><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>compare(e) {
	<span class="keyword">return</span> MathLib.sign(<span class="keyword">this</span>.toString().localeCompare(e.toString()));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <h3 id="expression-constant">Expression.constant</h3>
<p>Constructs a constant expression.</p>
<p><em>@return {Expression}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static constant(n) : Expression {
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
		subtype: <span class="string">'constant'</span>,
		value: n
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <h3 id="-a-href-http-mathlib-de-en-docs-expression-evaluate-expression-prototype-evaluate-a-"><a href="http://mathlib.de/en/docs/Expression/evaluate">Expression.prototype.evaluate</a></h3>
<p>Evaluates the symbolic expression</p>
<p><em>@return {any}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>evaluate() : any {

	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'binaryOperator'</span>) {
		<span class="keyword">return</span> MathLib[<span class="keyword">this</span>.name].apply(<span class="literal">null</span>, <span class="keyword">this</span>.content.map(x =&gt; x.evaluate()));
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'brackets'</span>) {
		<span class="keyword">return</span> <span class="keyword">this</span>.content.evaluate();
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'complexNumber'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.mode === <span class="string">'cartesian'</span>) {
			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="keyword">this</span>.value[<span class="number">0</span>].evaluate(), <span class="keyword">this</span>.value[<span class="number">1</span>].evaluate());
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.mode === <span class="string">'polar'</span>) {
			<span class="keyword">return</span> MathLib.Complex.polar(<span class="keyword">this</span>.value[<span class="number">0</span>].evaluate(), <span class="keyword">this</span>.value[<span class="number">1</span>].evaluate());
		}
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'constant'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.value === <span class="string">'false'</span>) {
			<span class="keyword">return</span> <span class="literal">false</span>;
		}
		<span class="keyword">if</span> (<span class="keyword">this</span>.value === <span class="string">'pi'</span>) {
			<span class="keyword">return</span> Math.PI;
		}
		<span class="keyword">if</span> (<span class="keyword">this</span>.value === <span class="string">'true'</span>) {
			<span class="keyword">return</span> <span class="literal">true</span>;
		}
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'functionCall'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.isMethod) {
			<span class="keyword">var</span> args = <span class="keyword">this</span>.content.map(x =&gt; x.evaluate()),
					_<span class="keyword">this</span> = args.shift();

			<span class="keyword">return</span> _<span class="keyword">this</span>[<span class="keyword">this</span>.value].apply(_<span class="keyword">this</span>, args);
		}
		<span class="keyword">else</span> {
			<span class="keyword">return</span> MathLib[<span class="keyword">this</span>.value].apply(<span class="literal">null</span>, <span class="keyword">this</span>.content.map(x =&gt; x.evaluate()));
		}
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'functionDefinition'</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Functn(<span class="keyword">this</span>.content[<span class="number">0</span>].evaluate(), {
			name: <span class="string">'f'</span>, 
			expression: <span class="keyword">this</span>.value
		});
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'matrix'</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Matrix(<span class="keyword">this</span>.value.map(r =&gt; r.map(c =&gt; c.evaluate())));
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'number'</span>) {
		<span class="keyword">return</span> parseFloat(<span class="keyword">this</span>.value);
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'naryOperator'</span>) {
		<span class="keyword">return</span> MathLib[<span class="keyword">this</span>.name].apply(<span class="literal">null</span>, <span class="keyword">this</span>.content.map(x =&gt; x.evaluate()));
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'rationalNumber'</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Rational(<span class="keyword">this</span>.value[<span class="number">0</span>].evaluate(), <span class="keyword">this</span>.value[<span class="number">1</span>].evaluate());
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'set'</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Set(<span class="keyword">this</span>.value.map(x =&gt; x.evaluate()));
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'string'</span>) {
		<span class="keyword">return</span> <span class="keyword">this</span>.value;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'variable'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.value <span class="keyword">in</span> MathLib.Expression.variables) {
			<span class="keyword">return</span> MathLib.Expression.variables[<span class="keyword">this</span>.value];
		}
		<span class="keyword">return</span> <span class="keyword">this</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'vector'</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Vector(<span class="keyword">this</span>.value.map(x =&gt; x.evaluate()));
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'unaryOperator'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.value === <span class="string">'-'</span>) {
			<span class="keyword">return</span> MathLib.negative(<span class="keyword">this</span>.content.evaluate())
		}
		<span class="keyword">return</span> <span class="keyword">this</span>.content.evaluate();
	}

}</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <h3 id="expression-prototype-map">Expression.prototype.map</h3>
<p>Maps the expression tree over to an other expression tree.</p>
<p><em>@return {Expression}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>map(f) : Expression {
	<span class="keyword">var</span> prop,
			properties = {},
			mappedProperties;

	<span class="keyword">for</span> (prop <span class="keyword">in</span> <span class="keyword">this</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.hasOwnProperty(prop) &amp;&amp; prop !== <span class="string">'content'</span>) {
			properties[prop] = <span class="keyword">this</span>[prop];
		}
	}

	mappedProperties = f(properties);
	<span class="keyword">if</span> (Array.isArray(<span class="keyword">this</span>.content)) {
		mappedProperties.content = <span class="keyword">this</span>.content.map(expr =&gt; expr.map(f));
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.content) {
		mappedProperties.content = <span class="keyword">this</span>.content.map(f);
	}

	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression(mappedProperties);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <h3 id="expression-number">Expression.number</h3>
<p>Constructs a number expression.</p>
<p><em>@return {Expression}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static number(n) : Expression {
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
		subtype: <span class="string">'number'</span>,
		value: n
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <h3 id="-a-href-http-mathlib-de-en-docs-expression-parse-expression-parse-a-"><a href="http://mathlib.de/en/docs/Expression/parse">Expression.parse</a></h3>
<p>Heavily based on Ariya Hidayat&#39;s <a href="https://code.google.com/p/tapdigit/">tapdigit library</a>
and his series &quot;math evaluator in javascript&quot;:<br><a href="http://ariya.ofilabs.com/2011/08/math-evaluator-in-javascript-part1.html">Part 1: tokenizer</a><br><a href="http://ariya.ofilabs.com/2011/08/math-evaluator-in-javascript-part-2.html">Part 2: parser</a><br><a href="http://ariya.ofilabs.com/2011/08/math-expression-evaluator-in-javascript-part-3.html">Part 3: interpreter</a>  </p>
<p><em>@return {Expression}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static parse = <span class="function"><span class="keyword">function</span> <span class="params">(str)</span> {</span>

	<span class="keyword">var</span> Token, Lexer, Parser;

	Token = {
		Operator: <span class="string">'Operator'</span>,
		Identifier: <span class="string">'Identifier'</span>,
		Number: <span class="string">'Number'</span>
	};

	Lexer = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
		<span class="keyword">var</span> expression = <span class="string">''</span>,
			length = <span class="number">0</span>,
			index = <span class="number">0</span>,
			marker = <span class="number">0</span>,
			T = Token;

		<span class="function"><span class="keyword">function</span> <span class="title">peekNextChar</span><span class="params">()</span> {</span>
			<span class="keyword">var</span> idx = index;
			<span class="keyword">return</span> ((idx &lt; length) ? expression.charAt(idx) : <span class="string">'\x00'</span>);
		}

		<span class="function"><span class="keyword">function</span> <span class="title">getNextChar</span><span class="params">()</span> {</span>
			<span class="keyword">var</span> ch = <span class="string">'\x00'</span>,
				idx = index;
			<span class="keyword">if</span> (idx &lt; length) {
				ch = expression.charAt(idx);
				index += <span class="number">1</span>;
			}
			<span class="keyword">return</span> ch;
		}

		<span class="function"><span class="keyword">function</span> <span class="title">isWhiteSpace</span><span class="params">(ch)</span> {</span>
			<span class="keyword">return</span> (ch === <span class="string">'\u0009'</span>) || (ch === <span class="string">' '</span>) || (ch === <span class="string">'\u00A0'</span>);
		}

		<span class="function"><span class="keyword">function</span> <span class="title">isLetter</span><span class="params">(ch)</span> {</span>
			<span class="keyword">return</span> (ch &gt;= <span class="string">'a'</span> &amp;&amp; ch &lt;= <span class="string">'z'</span>) || (ch &gt;= <span class="string">'A'</span> &amp;&amp; ch &lt;= <span class="string">'Z'</span>);
		}

		<span class="function"><span class="keyword">function</span> <span class="title">isDecimalDigit</span><span class="params">(ch)</span> {</span>
			<span class="keyword">return</span> (ch &gt;= <span class="string">'0'</span>) &amp;&amp; (ch &lt;= <span class="string">'9'</span>);
		}

		<span class="function"><span class="keyword">function</span> <span class="title">createToken</span><span class="params">(type, value)</span> {</span>
			<span class="keyword">return</span> {
				type: type,
				value: value,
				start: marker,
				end: index - <span class="number">1</span>
			};
		}

		<span class="function"><span class="keyword">function</span> <span class="title">skipSpaces</span><span class="params">()</span> {</span>
			<span class="keyword">var</span> ch;

			<span class="keyword">while</span> (index &lt; length) {
				ch = peekNextChar();
				<span class="keyword">if</span> (!isWhiteSpace(ch)) {
					<span class="keyword">break</span>;
				}
				getNextChar();
			}
		}

		<span class="function"><span class="keyword">function</span> <span class="title">scanOperator</span><span class="params">()</span> {</span>
			<span class="keyword">var</span> ch = peekNextChar();
			<span class="keyword">if</span> (<span class="string">'+-*/()^%=;,'</span>.indexOf(ch) &gt;= <span class="number">0</span>) {
				<span class="keyword">return</span> createToken(T.Operator, getNextChar());
			}
			<span class="keyword">return</span> <span class="literal">undefined</span>;
		}

		<span class="function"><span class="keyword">function</span> <span class="title">isIdentifierStart</span><span class="params">(ch)</span> {</span>
			<span class="keyword">return</span> (ch === <span class="string">'_'</span>) || isLetter(ch);
		}

		<span class="function"><span class="keyword">function</span> <span class="title">isIdentifierPart</span><span class="params">(ch)</span> {</span>
			<span class="keyword">return</span> isIdentifierStart(ch) || isDecimalDigit(ch);
		}

		<span class="function"><span class="keyword">function</span> <span class="title">scanIdentifier</span><span class="params">()</span> {</span>
			<span class="keyword">var</span> ch, id;

			ch = peekNextChar();
			<span class="keyword">if</span> (!isIdentifierStart(ch)) {
				<span class="keyword">return</span> <span class="literal">undefined</span>;
			}

			id = getNextChar();
			<span class="keyword">while</span> (<span class="literal">true</span>) {
				ch = peekNextChar();
				<span class="keyword">if</span> (!isIdentifierPart(ch)) {
					<span class="keyword">break</span>;
				}
				id += getNextChar();
			}

			<span class="keyword">return</span> createToken(T.Identifier, id);
		}

		<span class="function"><span class="keyword">function</span> <span class="title">scanNumber</span><span class="params">()</span> {</span>
			<span class="keyword">var</span> ch, number;

			ch = peekNextChar();
			<span class="keyword">if</span> (!isDecimalDigit(ch) &amp;&amp; (ch !== <span class="string">'.'</span>)) {
				<span class="keyword">return</span> <span class="literal">undefined</span>;
			}

			number = <span class="string">''</span>;
			<span class="keyword">if</span> (ch !== <span class="string">'.'</span>) {
				number = getNextChar();
				<span class="keyword">while</span> (<span class="literal">true</span>) {
					ch = peekNextChar();
					<span class="keyword">if</span> (!isDecimalDigit(ch)) {
						<span class="keyword">break</span>;
					}
					number += getNextChar();
				}
			}

			<span class="keyword">if</span> (ch === <span class="string">'.'</span>) {
				number += getNextChar();
				<span class="keyword">while</span> (<span class="literal">true</span>) {
					ch = peekNextChar();
					<span class="keyword">if</span> (!isDecimalDigit(ch)) {
						<span class="keyword">break</span>;
					}
					number += getNextChar();
				}
			}

			<span class="keyword">if</span> (ch === <span class="string">'e'</span> || ch === <span class="string">'E'</span>) {
				number += getNextChar();
				ch = peekNextChar();
				<span class="keyword">if</span> (ch === <span class="string">'+'</span> || ch === <span class="string">'-'</span> || isDecimalDigit(ch)) {
					number += getNextChar();
					<span class="keyword">while</span> (<span class="literal">true</span>) {
						ch = peekNextChar();
						<span class="keyword">if</span> (!isDecimalDigit(ch)) {
							<span class="keyword">break</span>;
						}
						number += getNextChar();
					}
				} <span class="keyword">else</span> {
					ch = <span class="string">'character '</span> + ch;
					<span class="keyword">if</span> (index &gt;= length) {
						ch = <span class="string">'&lt;end&gt;'</span>;
					}
					<span class="keyword">throw</span> <span class="keyword">new</span> SyntaxError(<span class="string">'Unexpected '</span> + ch + <span class="string">' after the exponent sign'</span>);
				}
			}

			<span class="keyword">if</span> (number === <span class="string">'.'</span>) {
				<span class="keyword">throw</span> <span class="keyword">new</span> SyntaxError(<span class="string">'Expecting decimal digits after the dot sign'</span>);
			}

			<span class="keyword">return</span> createToken(T.Number, number);
		}

		<span class="function"><span class="keyword">function</span> <span class="title">reset</span><span class="params">(str)</span> {</span>
			expression = str;
			length = str.length;
			index = <span class="number">0</span>;
		}

		<span class="function"><span class="keyword">function</span> <span class="title">next</span><span class="params">()</span> {</span>
			<span class="keyword">var</span> token;

			skipSpaces();
			<span class="keyword">if</span> (index &gt;= length) {
				<span class="keyword">return</span> <span class="literal">undefined</span>;
			}

			marker = index;

			token = scanNumber();
			<span class="keyword">if</span> (<span class="keyword">typeof</span> token !== <span class="string">'undefined'</span>) {
				<span class="keyword">return</span> token;
			}

			token = scanOperator();
			<span class="keyword">if</span> (<span class="keyword">typeof</span> token !== <span class="string">'undefined'</span>) {
				<span class="keyword">return</span> token;
			}

			token = scanIdentifier();
			<span class="keyword">if</span> (<span class="keyword">typeof</span> token !== <span class="string">'undefined'</span>) {
				<span class="keyword">return</span> token;
			}


			<span class="keyword">throw</span> <span class="keyword">new</span> SyntaxError(<span class="string">'Unknown token from character '</span> + peekNextChar());
		}

		<span class="function"><span class="keyword">function</span> <span class="title">peek</span><span class="params">()</span> {</span>
			<span class="keyword">var</span> token, idx;

			idx = index;
			<span class="keyword">try</span> {
				token = next();
				<span class="keyword">delete</span> token.start;
				<span class="keyword">delete</span> token.end;
			} <span class="keyword">catch</span> (e) {
				token = <span class="literal">undefined</span>;
			}
			index = idx;

			<span class="keyword">return</span> token;
		}

		<span class="keyword">return</span> {
			reset: reset,
			next: next,
			peek: peek
		};
	};







	Parser = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>

		<span class="keyword">var</span> lexer = <span class="keyword">new</span> Lexer(),
				T = Token;

		<span class="function"><span class="keyword">function</span> <span class="title">matchOp</span><span class="params">(token, op)</span> {</span>
			<span class="keyword">return</span> (<span class="keyword">typeof</span> token !== <span class="string">'undefined'</span>) &amp;&amp;
				token.type === T.Operator &amp;&amp;
				token.value === op;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>ArgumentList := Expression |
                Expression &#39;,&#39; ArgumentList</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="function"><span class="keyword">function</span> <span class="title">parseArgumentList</span><span class="params">()</span> {</span>
			<span class="keyword">var</span> token, expr, args = [];

			<span class="keyword">while</span> (<span class="literal">true</span>) {
				expr = parseExpression();
				<span class="keyword">if</span> (<span class="keyword">typeof</span> expr === <span class="string">'undefined'</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>TODO maybe throw exception?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="keyword">break</span>;
				}
				args.push(expr);
				token = lexer.peek();
				<span class="keyword">if</span> (!matchOp(token, <span class="string">','</span>)) {
					<span class="keyword">break</span>;
				}
				lexer.next();
			}

			<span class="keyword">return</span> args;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>FunctionCall ::= Identifier &#39;(&#39; &#39;)&#39; ||
                 Identifier &#39;(&#39; ArgumentList &#39;)&#39;</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="function"><span class="keyword">function</span> <span class="title">parseFunctionCall</span><span class="params">(name)</span> {</span>
			<span class="keyword">var</span> token, args = [];

			token = lexer.next();
			<span class="keyword">if</span> (!matchOp(token, <span class="string">'('</span>)) {
				<span class="keyword">throw</span> <span class="keyword">new</span> SyntaxError(<span class="string">'Expecting ( in a function call "'</span> + name + <span class="string">'"'</span>);
			}

			token = lexer.peek();
			<span class="keyword">if</span> (!matchOp(token, <span class="string">')'</span>)) {
				args = parseArgumentList();
			}

			token = lexer.next();
			<span class="keyword">if</span> (!matchOp(token, <span class="string">')'</span>)) {
				<span class="keyword">throw</span> <span class="keyword">new</span> SyntaxError(<span class="string">'Expecting ) in a function call "'</span> + name + <span class="string">'"'</span>);
			}

			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
					subtype: <span class="string">'functionCall'</span>,
					value: name,
					content: args
				});
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Primary ::= Identifier |
            Number |
            &#39;(&#39; Assignment &#39;)&#39; |
            FunctionCall</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="function"><span class="keyword">function</span> <span class="title">parsePrimary</span><span class="params">()</span> {</span>
			<span class="keyword">var</span> token, expr;

			token = lexer.peek();

			<span class="keyword">if</span> (<span class="keyword">typeof</span> token === <span class="string">'undefined'</span>) {
				<span class="keyword">throw</span> <span class="keyword">new</span> SyntaxError(<span class="string">'Unexpected termination of expression'</span>);
			}

			<span class="keyword">if</span> (token.type === T.Identifier) {
				token = lexer.next();
				<span class="keyword">if</span> (matchOp(lexer.peek(), <span class="string">'('</span>)) {
					<span class="keyword">return</span> parseFunctionCall(token.value);
				} <span class="keyword">else</span> {
					<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
						subtype: <span class="string">'Identifier'</span>,
						value: token.value
					});
				}
			}

			<span class="keyword">if</span> (token.type === T.Number) {
				token = lexer.next();
				<span class="keyword">return</span> MathLib.Expression.number(token.value);
			}

			<span class="keyword">if</span> (matchOp(token, <span class="string">'('</span>)) {
				lexer.next();
				expr = parseAssignment();
				token = lexer.next();
				<span class="keyword">if</span> (!matchOp(token, <span class="string">')'</span>)) {
					<span class="keyword">throw</span> <span class="keyword">new</span> SyntaxError(<span class="string">'Expecting )'</span>);
				}
				<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
					subtype: <span class="string">'brackets'</span>,
					value: <span class="string">'brackets'</span>,
					content: expr
				});
			}

			<span class="keyword">throw</span> <span class="keyword">new</span> SyntaxError(<span class="string">'Parse error, can not process token '</span> + token.value);
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Unary ::= Primary |
          &#39;-&#39; Unary</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="function"><span class="keyword">function</span> <span class="title">parseUnary</span><span class="params">()</span> {</span>
			<span class="keyword">var</span> token, expr;

			token = lexer.peek();
			<span class="keyword">if</span> (matchOp(token, <span class="string">'-'</span>) || matchOp(token, <span class="string">'+'</span>)) {
				token = lexer.next();
				expr = parseUnary();
				<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
						subtype: <span class="string">'unaryOperator'</span>,
						value: token.value,
						content: expr
					});
			}

			<span class="keyword">return</span> parsePrimary();
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Exponentiation ::= Unary |
                   Exponentiation &#39;^&#39; Unary |</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="function"><span class="keyword">function</span> <span class="title">parseExponentiation</span><span class="params">()</span> {</span>
			<span class="keyword">var</span> token, left, right;

			left = parseUnary();
			token = lexer.peek();
			<span class="keyword">if</span> (matchOp(token, <span class="string">'^'</span>)) {
				token = lexer.next();

				right = parseExponentiation();</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Exponentiation is right associative
a^b^c should be a^(b^c) and not (a^b)^c</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
					subtype: <span class="string">'binaryOperator'</span>,
					value: <span class="string">'^'</span>,
					content: [left, right],
					name: <span class="string">'pow'</span>
				});
				
			}
			<span class="keyword">return</span> left;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Multiplicative ::= Exponentiation |
                   Multiplicative &#39;*&#39; Exponentiation |
                   Multiplicative &#39;/&#39; Exponentiation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="function"><span class="keyword">function</span> <span class="title">parseMultiplicative</span><span class="params">()</span> {</span>
			<span class="keyword">var</span> token, left, right, r;

			left = parseExponentiation();
			token = lexer.peek();
			<span class="keyword">if</span> (matchOp(token, <span class="string">'*'</span>) || matchOp(token, <span class="string">'/'</span>)) {
				token = lexer.next();

				right = parseMultiplicative();</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Multiplication and division is left associative:
a/b/c should be (a/b)/c and not a/(b/c)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="keyword">if</span> (right.subtype === <span class="string">'naryOperator'</span> || right.subtype === <span class="string">'binaryOperator'</span>) {
					r = right;
					<span class="keyword">while</span> (r.content[<span class="number">0</span>].subtype === <span class="string">'naryOperator'</span> || r.content[<span class="number">0</span>].subtype === <span class="string">'binaryOperator'</span>) {
						r = r.content[<span class="number">0</span>];
					}
					
					r.content[<span class="number">0</span>] = <span class="keyword">new</span> MathLib.Expression({
						subtype: token.value === <span class="string">'*'</span> ? <span class="string">'naryOperator'</span> : <span class="string">'binaryOperator'</span>,
						content: [left, r.content[<span class="number">0</span>]],
						value: token.value,
						name: token.value === <span class="string">'*'</span> ? <span class="string">'times'</span> : <span class="string">'divide'</span>
					});
					<span class="keyword">return</span> right;
				}
				
				<span class="keyword">else</span> {
					<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
						subtype: token.value === <span class="string">'*'</span> ? <span class="string">'naryOperator'</span> : <span class="string">'binaryOperator'</span>,
						value: token.value,
						name: token.value === <span class="string">'*'</span> ? <span class="string">'times'</span> : <span class="string">'divide'</span>,
						content: [left, right]
					});
				}
				
			}
			<span class="keyword">return</span> left;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Additive ::= Multiplicative |
             Additive &#39;+&#39; Multiplicative |
             Additive &#39;-&#39; Multiplicative</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="function"><span class="keyword">function</span> <span class="title">parseAdditive</span><span class="params">()</span> {</span>
			<span class="keyword">var</span> token, left, right, r;

			left = parseMultiplicative();
			token = lexer.peek();
			<span class="keyword">if</span> (matchOp(token, <span class="string">'+'</span>) || matchOp(token, <span class="string">'-'</span>)) {
				token = lexer.next();
				right = parseAdditive();</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Addition and subtractio is left associative:
a-b-c should be (a-b)-c and not a-(b-c)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="keyword">if</span> (right.value === <span class="string">'+'</span> || right.value === <span class="string">'-'</span>) {
					r = right;
					<span class="keyword">while</span> (r.content[<span class="number">0</span>].subtype === <span class="string">'naryOperator'</span>) {
						r = r.content[<span class="number">0</span>];
					}
					
					r.content[<span class="number">0</span>] = <span class="keyword">new</span> MathLib.Expression({
						subtype: token.value === <span class="string">'+'</span> ? <span class="string">'naryOperator'</span> : <span class="string">'binaryOperator'</span>,
						content: [left, r.content[<span class="number">0</span>]],
						value: token.value,
						name: token.value === <span class="string">'+'</span> ? <span class="string">'plus'</span> : <span class="string">'minus'</span>
					});
					<span class="keyword">return</span> right;
				}
				
				<span class="keyword">else</span> {
					<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
						subtype: token.value === <span class="string">'+'</span> ? <span class="string">'naryOperator'</span> : <span class="string">'binaryOperator'</span>,
						value: token.value,
						name: token.value === <span class="string">'+'</span> ? <span class="string">'plus'</span> : <span class="string">'minus'</span>,
						content: [left, right]
					});
				}

			}
			<span class="keyword">return</span> left;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Assignment ::= Identifier &#39;=&#39; Assignment |
               Additive</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="function"><span class="keyword">function</span> <span class="title">parseAssignment</span><span class="params">()</span> {</span>
			<span class="keyword">var</span> expr;

			expr = parseAdditive();

			<span class="comment">/*
			TODO: support assignments
			if (typeof expr !== 'undefined' &amp;&amp; expr.Identifier) {
				token = lexer.peek();
				if (matchOp(token, '=')) {
					lexer.next();
					return new MathLib.Expression({
							subtype: 'Assignment',
							name: expr,
							value: parseAssignment()
						});
				}
				return expr;
			}
			*/</span>

			<span class="keyword">return</span> expr;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Expression ::= Assignment</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="function"><span class="keyword">function</span> <span class="title">parseExpression</span><span class="params">()</span> {</span>
			<span class="keyword">return</span> parseAssignment();
		}

		<span class="function"><span class="keyword">function</span> <span class="title">parse</span><span class="params">(expression)</span> {</span>
			<span class="keyword">var</span> expr, token;

			lexer.reset(expression);
			expr = parseExpression();

			token = lexer.next();
			<span class="keyword">if</span> (<span class="keyword">typeof</span> token !== <span class="string">'undefined'</span>) {
				<span class="keyword">throw</span> <span class="keyword">new</span> SyntaxError(<span class="string">'Unexpected token '</span> + token.value);
			}

			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression(expr);

		}

		<span class="keyword">return</span> {
			parse: parse
		};
	};


	<span class="keyword">return</span> Parser().parse(str);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <h3 id="expression-prototype-parsecontentmathml">Expression.prototype.parseContentMathML</h3>
<p>Parses a content MathML string and returns an Expression.</p>
<p><em>@return {Expression}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static parseContentMathML(MathMLString) : Expression {
	<span class="keyword">var</span> tokenizer = <span class="keyword">new</span> DOMParser(),
			MathMLdoc;</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Whitespace normalization (see section 2.1.7 of the MathML 3 specification)
TODO: Find a better way of normalizing whitespace.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	MathMLString = MathMLString.split(<span class="string">'cs&gt;'</span>).map(<span class="function"><span class="keyword">function</span> <span class="params">(x, i)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>We are not in an cs element.</p>
<ol>
<li>normalize multiple spaces to one space <pre><code> (&quot;whitespace internal to content of the element is collapsed canonically,
 i.e., each sequence of 1 or more whitespace characters is replaced with one space character&quot;)</code></pre>
</li>
<li>Remove whitespace outside of token elements<pre><code> (&quot;MathML ignores whitespace occurring outside token elements.&quot;)
 and remove whitespace at the beginning and end of elements
 (&quot;All whitespace at the beginning and end of the content is removed&quot;).</code></pre>
</li>
</ol>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (i % <span class="number">2</span> === <span class="number">0</span>) {
			<span class="keyword">return</span> x.replace(<span class="regexp">/\s+/g</span>, <span class="string">' '</span>).replace(<span class="regexp">/ &lt;/g</span>, <span class="string">'&lt;'</span>).replace(<span class="regexp">/&gt; /g</span>, <span class="string">'&gt;'</span>);
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>We are in cs element, so don&#39;t do anything.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">else</span> {
			<span class="keyword">return</span> x;
		}
	}).join(<span class="string">'cs&gt;'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Gives an error in Firefox</p>
<ul>
<li>MathML = tokenizer.parseFromString(MathMLString, &#39;application/mathml+xml&#39;); *</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>	MathMLdoc = tokenizer.parseFromString(MathMLString, <span class="string">'application/xml'</span>);


	<span class="keyword">var</span> handler = {
		apply: <span class="function"><span class="keyword">function</span> <span class="params">(node)</span> {</span>
			<span class="keyword">var</span> children = Array.prototype.slice.call(node.childNodes),
					functnName = children.shift().nodeName,
					isMethod = <span class="literal">true</span>,
					functnNames = {
						ident: <span class="string">'identity'</span>,
						power: <span class="string">'pow'</span>,
						rem: <span class="string">'mod'</span>,
						setdifference: <span class="string">'without'</span> 
					};</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Change some function names for functions with different names in MathLib</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">if</span> (functnName <span class="keyword">in</span> functnNames) {
				functnName = functnNames[functnName];
			}

			<span class="keyword">if</span> (MathLib[functnName]) {
				isMethod = <span class="literal">false</span>;
			}

			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
				subtype: <span class="string">'functionCall'</span>,
				value: functnName,
				isMethod: isMethod,
				content: parser(children)
			});
		},
		ci: <span class="function"><span class="keyword">function</span> <span class="params">(node)</span> {</span>
			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
				subtype: <span class="string">'variable'</span>,
				value: node.textContent
			});
		},
		cn: <span class="function"><span class="keyword">function</span> <span class="params">(node)</span> {</span>
			<span class="keyword">var</span> type = node.getAttribute(<span class="string">'type'</span>) !== <span class="literal">null</span> ? node.getAttribute(<span class="string">'type'</span>) : <span class="string">'number'</span>;

			<span class="keyword">if</span> (type === <span class="string">'number'</span>) {
				<span class="comment">/* TODO: base conversions
				var base = node.getAttribute('base') !== null ? node.getAttributes('base') : '10'; */</span>
				<span class="keyword">return</span> parser(node.childNodes[<span class="number">0</span>]);
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">'rational'</span>) {
				<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
					value: [parser(node.childNodes[<span class="number">0</span>]), parser(node.childNodes[<span class="number">2</span>])],
					subtype: <span class="string">'rationalNumber'</span>
				});
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">'complex-cartesian'</span>) {
				<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
					value: [parser(node.childNodes[<span class="number">0</span>]), parser(node.childNodes[<span class="number">2</span>])],
					subtype: <span class="string">'complexNumber'</span>,
					mode: <span class="string">'cartesian'</span>
				});
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">'complex-polar'</span>) {
				<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
					value: [parser(node.childNodes[<span class="number">0</span>]), parser(node.childNodes[<span class="number">2</span>])],
					subtype: <span class="string">'complexNumber'</span>,
					mode: <span class="string">'polar'</span>
				});
			}
		},
		cs: <span class="function"><span class="keyword">function</span> <span class="params">(node)</span> {</span>
			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
				subtype: <span class="string">'string'</span>,
				value: node.textContent
			});
		},
		lambda: <span class="function"><span class="keyword">function</span> <span class="params">(node)</span> {</span>
			<span class="keyword">var</span> bvar = node.childNodes[<span class="number">0</span>],
					doa = node.childNodes[<span class="number">1</span>],
					apply = node.childNodes[<span class="number">2</span>];

			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
				subtype: <span class="string">'functionDefinition'</span>,
				domain: doa.childNodes[<span class="number">0</span>].nodeName,
				arguments: Array.prototype.map.call(bvar.childNodes, variable =&gt; <span class="keyword">new</span> MathLib.Expression.variable(variable.textContent)),
				content: [parser(apply)]
			})
		},
		math: <span class="function"><span class="keyword">function</span> <span class="params">(node)</span> {</span>
			<span class="keyword">return</span> parser(node.childNodes[<span class="number">0</span>]);
		},
		matrix: <span class="function"><span class="keyword">function</span> <span class="params">(node)</span> {</span>
			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
				value: Array.prototype.slice.call(node.childNodes).map(handler.matrixrow),
				subtype: <span class="string">'matrix'</span>
			});
		},
		matrixrow: <span class="function"><span class="keyword">function</span> <span class="params">(node)</span> {</span>
			<span class="keyword">return</span> Array.prototype.map.call(node.childNodes, parser);
		},
		set: <span class="function"><span class="keyword">function</span> <span class="params">(node)</span> {</span>
			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
				value: parser(Array.prototype.slice.call(node.childNodes)),
				subtype: <span class="string">'set'</span>
			});
		},
		<span class="string">'#text'</span>: <span class="function"><span class="keyword">function</span> <span class="params">(node)</span> {</span>
			<span class="keyword">if</span> (node.parentNode.nodeName === <span class="string">'cn'</span>) {
				<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression.number(node.nodeValue.trim());
			}
			<span class="keyword">return</span> node.nodeValue;
		},
		vector: <span class="function"><span class="keyword">function</span> <span class="params">(node)</span> {</span>
			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
				value: parser(Array.prototype.slice.call(node.childNodes)),
				subtype: <span class="string">'vector'</span>
			});
		},
		<span class="literal">false</span>: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression.constant(<span class="string">'false'</span>);
		},
		pi: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression.constant(<span class="string">'pi'</span>);
		},
		<span class="literal">true</span>: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression.constant(<span class="string">'true'</span>);
		}
	}

	<span class="keyword">var</span> parser = <span class="function"><span class="keyword">function</span> <span class="params">(node)</span> {</span>
		<span class="keyword">if</span> (Array.isArray(node)) {
			<span class="keyword">var</span> nodes = node.map(parser);
			<span class="keyword">return</span> nodes;
		}

		<span class="keyword">return</span> handler[node.nodeName](node);
	};

	<span class="keyword">return</span> parser(MathMLdoc.childNodes[<span class="number">0</span>]) ;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <h3 id="-a-href-http-mathlib-de-en-docs-expression-tocontentmathml-expression-prototype-tocontentmathml-a-"><a href="http://mathlib.de/en/docs/Expression/toContentMathML">Expression.prototype.toContentMathML</a></h3>
<p>Convert the Expression to MathML.</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toContentMathML() : string {

	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'binaryOperator'</span>) {
		<span class="keyword">var</span> op = <span class="keyword">this</span>.name === <span class="string">'pow'</span> ? <span class="string">'power'</span> : <span class="keyword">this</span>.name;

		<span class="keyword">return</span> <span class="string">'&lt;apply&gt;&lt;csymbol cd="arith1"&gt;'</span> + op + <span class="string">'&lt;/csymbol&gt;'</span> +
			<span class="keyword">this</span>.content[<span class="number">0</span>].toContentMathML() +
			<span class="keyword">this</span>.content[<span class="number">1</span>].toContentMathML() +
			<span class="string">'&lt;/apply&gt;'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'brackets'</span>) {
		<span class="keyword">return</span> <span class="keyword">this</span>.content.toContentMathML();
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'number'</span>) {
		<span class="keyword">return</span> <span class="string">'&lt;cn&gt;'</span> + <span class="keyword">this</span>.value + <span class="string">'&lt;/cn&gt;'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'variable'</span>) {
		<span class="keyword">return</span> <span class="string">'&lt;ci&gt;'</span> + <span class="keyword">this</span>.value + <span class="string">'&lt;/ci&gt;'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'naryOperator'</span>) {
		<span class="keyword">return</span> <span class="string">'&lt;apply&gt;&lt;csymbol cd="arith1"&gt;'</span> + <span class="keyword">this</span>.name + <span class="string">'&lt;/csymbol&gt;'</span> +
			<span class="keyword">this</span>.content.map(expr =&gt; expr.toContentMathML()).join(<span class="string">''</span>) +
		<span class="string">'&lt;/apply&gt;'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'unaryOperator'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.value === <span class="string">'-'</span>) {
			<span class="keyword">return</span> <span class="string">'&lt;apply&gt;&lt;csymbol cd="arith1"&gt;unary_minus&lt;/csymbol&gt;'</span> +
				<span class="keyword">this</span>.content.toContentMathML() +
			<span class="string">'&lt;/apply&gt;'</span>;
		}
		<span class="keyword">return</span> <span class="keyword">this</span>.content.toContentMathML();
	}

	<span class="comment">/*
	var transc1 = ['arccos', 'arccosh', 'arccot', 'arccoth', 'arccsc', 'arccsch', 'arcsec',
			'arcsech', 'arcsin', 'arcsinh', 'arctan', 'arctanh', 'cos', 'cosh', 'cot', 'coth',
			'csc', 'csch', 'exp', 'ln', 'log', 'sec', 'sech', 'sin', 'sinh', 'tan', 'tanh'];
	*/</span>


	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'functionCall'</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>There are some functions which have different names in MathML</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">var</span> conversion = {
					arcosh: <span class="string">'arccosh'</span>,
					arcoth: <span class="string">'arccoth'</span>,
					arcsch: <span class="string">'arccsch'</span>,
					arsech: <span class="string">'arcsech'</span>,
					arsinh: <span class="string">'arcsinh'</span>,
					artanh: <span class="string">'arctanh'</span>,
					identity: <span class="string">'ident'</span>
				},
				funcName;

		<span class="keyword">if</span> (<span class="keyword">this</span>.value <span class="keyword">in</span> conversion) {
			funcName = conversion[<span class="keyword">this</span>.value];
		}
		<span class="keyword">else</span> {
			funcName = <span class="keyword">this</span>.value;
		}

		<span class="keyword">return</span> <span class="string">'&lt;apply&gt;&lt;csymbol cd="transc1"&gt;'</span> + funcName + <span class="string">'&lt;/csymbol&gt;'</span> +
			<span class="keyword">this</span>.content.map(expr =&gt; expr.toContentMathML()).join(<span class="string">''</span>) +
			<span class="string">'&lt;/apply&gt;'</span>;
	}

	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'functionDefinition'</span>) {
		<span class="keyword">return</span> <span class="string">'&lt;lambda&gt;&lt;bvar&gt;&lt;ci&gt;'</span> +
			<span class="keyword">this</span>.arguments.join(<span class="string">'&lt;/ci&gt;&lt;/bvar&gt;&lt;bvar&gt;&lt;ci&gt;'</span>) +
			<span class="string">'&lt;/ci&gt;&lt;/bvar&gt;'</span> +
			<span class="keyword">this</span>.content.map(expr =&gt; expr.toContentMathML()) +
			<span class="string">'&lt;/lambda&gt;'</span>;
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <h3 id="-a-href-http-mathlib-de-en-docs-expression-tolatex-expression-prototype-tolatex-a-"><a href="http://mathlib.de/en/docs/Expression/toLaTeX">Expression.prototype.toLaTeX</a></h3>
<p>Convert the expression to a LaTeX string</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toLaTeX(opts = {}) : string {
	<span class="keyword">var</span> op;

	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'binaryOperator'</span>) {
		<span class="keyword">var</span> str;

		<span class="keyword">if</span> (<span class="keyword">this</span>.value === <span class="string">'/'</span>) {
			str = <span class="string">'\\frac{'</span> + <span class="keyword">this</span>.content[<span class="number">0</span>].toLaTeX() + <span class="string">'}'</span>;
		}
		<span class="keyword">else</span> {
			str = <span class="keyword">this</span>.content[<span class="number">0</span>].toLaTeX() + <span class="keyword">this</span>.value;
		}

		str += <span class="keyword">this</span>.value !== <span class="string">'-'</span> ? <span class="string">'{'</span> : <span class="string">''</span>;
		str += <span class="keyword">this</span>.content[<span class="number">1</span>].toLaTeX();
		str += <span class="keyword">this</span>.value !== <span class="string">'-'</span> ? <span class="string">'}'</span> : <span class="string">''</span>;

		<span class="keyword">return</span> str;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'brackets'</span>) {
		<span class="keyword">return</span> <span class="string">'\\left('</span> + <span class="keyword">this</span>.content.toLaTeX(opts) + <span class="string">'\\right)'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'complexNumber'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.mode === <span class="string">'cartesian'</span>) {
			<span class="keyword">return</span> <span class="keyword">this</span>.value[<span class="number">0</span>] + <span class="string">'+'</span> + <span class="keyword">this</span>.value[<span class="number">1</span>] + <span class="string">'i'</span>;
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.mode === <span class="string">'polar'</span>) {
			<span class="keyword">return</span> <span class="keyword">this</span>.value[<span class="number">0</span>] + <span class="string">' \\cdot e^{'</span> + <span class="keyword">this</span>.value[<span class="number">1</span>] + <span class="string">'i}'</span>;
		}
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'constant'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.value === <span class="string">'pi'</span>) {
			<span class="keyword">return</span> <span class="string">'\\pi'</span>;
		}
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'matrix'</span>) {
		<span class="keyword">return</span> <span class="string">'\\begin{pmatrix}'</span> 
			+ <span class="keyword">this</span>.value.map(row =&gt; row.map(col =&gt; col.toLaTeX()).join(<span class="string">'&amp;'</span>) ).join(<span class="string">'\\\\'</span>) 
			+ <span class="string">'\\end{pmatrix}'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'number'</span> || <span class="keyword">this</span>.subtype === <span class="string">'variable'</span>) {
		<span class="keyword">return</span> <span class="keyword">this</span>.value;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'naryOperator'</span>) {
		op = <span class="keyword">this</span>.value === <span class="string">'*'</span> ? <span class="string">'\\cdot'</span> : <span class="keyword">this</span>.value;
		<span class="keyword">return</span> <span class="keyword">this</span>.content.reduce((old, cur, idx) =&gt; old + (idx ? op : <span class="string">''</span>) + cur.toLaTeX(opts), <span class="string">''</span>);
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'rationalNumber'</span>) {
		<span class="keyword">return</span> <span class="string">'\\frac{'</span> + <span class="keyword">this</span>.value[<span class="number">0</span>].toLaTeX() + <span class="string">'}{'</span> + <span class="keyword">this</span>.value[<span class="number">1</span>].toLaTeX() + <span class="string">'}'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'set'</span>) {
		<span class="keyword">return</span> <span class="string">'\\left{'</span> + <span class="keyword">this</span>.value.map(x =&gt; x.toLaTeX()).join(<span class="string">', '</span>) + <span class="string">'\\right}'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'string'</span>) {
		<span class="keyword">return</span> <span class="string">'\\texttt{"{}'</span> + <span class="keyword">this</span>.value + <span class="string">'"}'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'unaryOperator'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.value === <span class="string">'-'</span>) {
			<span class="keyword">return</span> <span class="string">'-'</span> + <span class="keyword">this</span>.content.toLaTeX(opts)
		}
		<span class="keyword">return</span> <span class="keyword">this</span>.content.toLaTeX(opts);
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'vector'</span>) {
		<span class="keyword">return</span> <span class="string">'\\begin{pmatrix}'</span> + <span class="keyword">this</span>.value.map(x =&gt; x.toLaTeX()).join(<span class="string">'\\\\'</span>) + <span class="string">'\\end{pmatrix}'</span>;
	}

	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'functionCall'</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>These operators are predefined by amsmath.
(There are more predefined ones, but these are the useful ones.)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> ([<span class="string">'arccos'</span>, <span class="string">'arcsin'</span>, <span class="string">'arctan'</span>, <span class="string">'arg'</span>, <span class="string">'cos'</span>, <span class="string">'cosh'</span>, <span class="string">'cot'</span>, <span class="string">'coth'</span>, <span class="string">'csc'</span>, <span class="string">'deg'</span>, <span class="string">'det'</span>, <span class="string">'dim'</span>, 
		<span class="string">'gcd'</span>, <span class="string">'lg'</span>, <span class="string">'ln'</span>, <span class="string">'log'</span>, <span class="string">'max'</span>, <span class="string">'min'</span>, <span class="string">'sec'</span>, <span class="string">'sin'</span>, <span class="string">'sinh'</span>, <span class="string">'tan'</span>, <span class="string">'tanh'</span>].indexOf(<span class="keyword">this</span>.value) + <span class="number">1</span>) {
			<span class="keyword">return</span> <span class="string">'\\'</span> + <span class="keyword">this</span>.value + <span class="string">'\\left('</span> +
				(<span class="keyword">this</span>.content.length
				? <span class="keyword">this</span>.content.reduce((old, cur, idx) =&gt; old + (idx ? <span class="string">','</span> : <span class="string">''</span>) + cur.toLaTeX(opts), <span class="string">''</span>)
				: <span class="string">'x'</span>) +
				<span class="string">'\\right)'</span>;
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.value === <span class="string">'exp'</span>) {
			<span class="keyword">return</span> <span class="string">'e^{'</span> + (<span class="keyword">this</span>.content.length ? <span class="keyword">this</span>.content[<span class="number">0</span>].toLaTeX(opts) : <span class="string">'x'</span>) + <span class="string">'}'</span>;
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.value === <span class="string">'sqrt'</span>) {
			<span class="keyword">return</span> <span class="string">'\\'</span> + <span class="keyword">this</span>.value + <span class="string">'{'</span> + (<span class="keyword">this</span>.content.length ? <span class="keyword">this</span>.content[<span class="number">0</span>].toLaTeX(opts) : <span class="string">'x'</span>) + <span class="string">'}'</span>;
		}
		<span class="keyword">else</span> {
			<span class="keyword">return</span> <span class="string">'\\operatorname{'</span> + <span class="keyword">this</span>.value + <span class="string">'}\\left('</span> +
				(<span class="keyword">this</span>.content.length
				? <span class="keyword">this</span>.content.reduce((old, cur, idx) =&gt; old + (idx ? <span class="string">','</span> : <span class="string">''</span>) + cur.toLaTeX(opts), <span class="string">''</span>) 
				: <span class="string">'x'</span>) +
				<span class="string">'\\right)'</span>;
		}

	}

	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'functionDefinition'</span>) {
		<span class="keyword">return</span> (<span class="keyword">this</span>.arguments.length === <span class="number">1</span>
			? <span class="keyword">this</span>.arguments[<span class="number">0</span>]
			: <span class="string">'\\left('</span> + <span class="keyword">this</span>.arguments.join(<span class="string">', '</span>) + <span class="string">'\\right)'</span>) +
			
			<span class="string">' \\longmapsto '</span> +

			(<span class="keyword">this</span>.content.length === <span class="number">1</span>
			? <span class="keyword">this</span>.content[<span class="number">0</span>].toLaTeX()
			: <span class="string">'\\left('</span> + <span class="keyword">this</span>.content.map(expr =&gt; expr.toLaTeX()).join(<span class="string">', '</span>) + <span class="string">'\\right)'</span>) 
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <h3 id="-a-href-http-mathlib-de-en-docs-expression-tomathml-expression-prototype-tomathml-a-"><a href="http://mathlib.de/en/docs/Expression/toMathML">Expression.prototype.toMathML</a></h3>
<p>Convert the Expression to MathML.</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toMathML() : string {

	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'binaryOperator'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.value === <span class="string">'-'</span>) {
			<span class="keyword">return</span> <span class="keyword">this</span>.content[<span class="number">0</span>].toMathML() + <span class="string">'&lt;mo&gt;-&lt;/mo&gt;'</span> + <span class="keyword">this</span>.content[<span class="number">1</span>].toMathML();
		}
		<span class="keyword">if</span> (<span class="keyword">this</span>.value === <span class="string">'/'</span>) {
			<span class="keyword">return</span> <span class="string">'&lt;mfrac&gt;'</span> + <span class="keyword">this</span>.content[<span class="number">0</span>].toMathML() + <span class="keyword">this</span>.content[<span class="number">1</span>].toMathML() + <span class="string">'&lt;/mfrac&gt;'</span>;
		}
		<span class="keyword">if</span> (<span class="keyword">this</span>.value === <span class="string">'^'</span>) {
			<span class="keyword">return</span> <span class="string">'&lt;msup&gt;'</span> + <span class="keyword">this</span>.content[<span class="number">0</span>].toMathML() + <span class="keyword">this</span>.content[<span class="number">1</span>].toMathML() + <span class="string">'&lt;/msup&gt;'</span>;
		}
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'brackets'</span>) {
		<span class="keyword">return</span> <span class="string">'&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;'</span> + <span class="keyword">this</span>.content.toMathML() + <span class="string">'&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'complexNumber'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.mode === <span class="string">'cartesian'</span>) {
			<span class="keyword">return</span>  <span class="string">'&lt;mrow&gt;'</span> + <span class="keyword">this</span>.value[<span class="number">0</span>].toMathML() + <span class="string">'&lt;mo&gt;+&lt;/mo&gt;'</span> + <span class="keyword">this</span>.value[<span class="number">1</span>].toMathML() + <span class="string">'&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;'</span>;
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.mode === <span class="string">'polar'</span>) {
			<span class="keyword">return</span> <span class="keyword">this</span>.value[<span class="number">0</span>].toMathML() + <span class="string">'&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow&gt;'</span> 
				+ <span class="keyword">this</span>.value[<span class="number">1</span>].toMathML() + <span class="string">'&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;'</span>;
		}
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'constant'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.value === <span class="string">'pi'</span>) {
			<span class="keyword">return</span> <span class="string">'&lt;mi&gt;&amp;pi;&lt;/mi&gt;'</span>;
		}
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'matrix'</span>) {
		<span class="keyword">return</span> <span class="string">'&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;'</span> 
			+ <span class="keyword">this</span>.value.map(row =&gt; row.map(col =&gt; col.toMathML()).join(<span class="string">'&lt;/mtd&gt;&lt;mtd&gt;'</span>) ).join(<span class="string">'&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;'</span>) 
			+ <span class="string">'&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'number'</span>) {
		<span class="keyword">return</span> <span class="string">'&lt;mn&gt;'</span> + <span class="keyword">this</span>.value + <span class="string">'&lt;/mn&gt;'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'rationalNumber'</span>) {
		<span class="keyword">return</span> <span class="string">'&lt;mfrac&gt;'</span> + <span class="keyword">this</span>.value[<span class="number">0</span>].toMathML() + <span class="keyword">this</span>.value[<span class="number">1</span>].toMathML() + <span class="string">'&lt;/mfrac&gt;'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'set'</span>) {
		<span class="keyword">return</span> <span class="string">'&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;'</span> + <span class="keyword">this</span>.value.map(x =&gt; x.toMathML()).join(<span class="string">'&lt;mo&gt;,&lt;/mo&gt;'</span>) + <span class="string">'&lt;mo&gt;}&lt;/mo&gt;&lt;/mrow&gt;'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'string'</span>) {
		<span class="keyword">return</span> <span class="string">'&lt;ms&gt;'</span> + <span class="keyword">this</span>.value + <span class="string">'&lt;/ms&gt;'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'variable'</span>) {
		<span class="keyword">return</span> <span class="string">'&lt;mi&gt;'</span> + <span class="keyword">this</span>.value + <span class="string">'&lt;/mi&gt;'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'vector'</span>) {
		<span class="keyword">return</span> <span class="string">'&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;'</span> + <span class="keyword">this</span>.value.map(x =&gt; x.toMathML()).join(<span class="string">'&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;'</span>) + <span class="string">'&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'naryOperator'</span>) {
		<span class="keyword">return</span> <span class="string">'&lt;mrow&gt;'</span> + <span class="keyword">this</span>.content.map(expr =&gt; expr.toMathML()).join(<span class="string">'&lt;mo&gt;'</span> + 
			(<span class="keyword">this</span>.value === <span class="string">'*'</span>
			? <span class="string">'&amp;middot;'</span>
			: <span class="keyword">this</span>.value) +
			<span class="string">'&lt;/mo&gt;'</span>) + <span class="string">'&lt;/mrow&gt;'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'unaryOperator'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.value === <span class="string">'-'</span>) {
			<span class="keyword">return</span> <span class="string">'&lt;mo&gt;-&lt;/mo&gt;'</span> + <span class="keyword">this</span>.content.toMathML()
		}
		<span class="keyword">return</span> <span class="keyword">this</span>.content.toMathML();
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'functionCall'</span>) {
		<span class="keyword">return</span> <span class="string">'&lt;mrow&gt;&lt;mi&gt;'</span> + <span class="keyword">this</span>.value + <span class="string">'&lt;/mi&gt;&lt;mo&gt;&amp;af;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;'</span> +
		( <span class="keyword">this</span>.content.length
		? <span class="keyword">this</span>.content.map(expr =&gt; expr.toMathML()).join(<span class="string">''</span>)
		: <span class="string">'&lt;mi&gt;x&lt;/mi&gt;'</span>) +
		<span class="string">'&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;'</span>;
	}

	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'functionDefinition'</span>) {
		<span class="keyword">return</span> <span class="string">'&lt;mrow&gt;'</span> +
			(<span class="keyword">this</span>.arguments.length === <span class="number">1</span>
			? <span class="string">'&lt;mi&gt;'</span> + <span class="keyword">this</span>.arguments[<span class="number">0</span>] + <span class="string">'&lt;/mi&gt;'</span>
			: <span class="string">'&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;'</span> + <span class="keyword">this</span>.arguments.join(<span class="string">'&lt;/mi&gt;&lt;mo&gt;,&lt;mo&gt;&lt;mi&gt;'</span>) + <span class="string">'&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;'</span>) +
			
			<span class="string">'&lt;mo&gt;&amp;#x27FC;&lt;/mo&gt;'</span> +

			(<span class="keyword">this</span>.content.length === <span class="number">1</span>
			? <span class="keyword">this</span>.content[<span class="number">0</span>].toMathML()
			: <span class="string">'&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;'</span> + <span class="keyword">this</span>.content.map(expr =&gt; expr.toMathML()) + <span class="string">'&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;'</span>) +
			<span class="string">'&lt;/mrow&gt;'</span>;
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <h3 id="-a-href-http-mathlib-de-en-docs-expression-tostring-expression-prototype-tostring-a-"><a href="http://mathlib.de/en/docs/Expression/toString">Expression.prototype.toString</a></h3>
<p>A custom toString function</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toString() : string {

	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'binaryOperator'</span>) {
		<span class="keyword">return</span> <span class="keyword">this</span>.content[<span class="number">0</span>].toString() + <span class="keyword">this</span>.value + <span class="keyword">this</span>.content[<span class="number">1</span>].toString();
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'brackets'</span>) {
		<span class="keyword">return</span> <span class="string">'('</span> + <span class="keyword">this</span>.content.toString() + <span class="string">')'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'complexNumber'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.mode === <span class="string">'cartesian'</span>) {
			<span class="keyword">return</span> <span class="keyword">this</span>.value[<span class="number">0</span>] + <span class="string">'+'</span> + <span class="keyword">this</span>.value[<span class="number">1</span>] + <span class="string">'i'</span>;
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.mode === <span class="string">'polar'</span>) {
			<span class="keyword">return</span> <span class="keyword">this</span>.value[<span class="number">0</span>] + <span class="string">'*e^'</span> + <span class="keyword">this</span>.value[<span class="number">1</span>] + <span class="string">'i'</span>;
		}
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'constant'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.value === <span class="string">'pi'</span>) {
			<span class="keyword">return</span> <span class="string">'π'</span>;
		}
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'matrix'</span>) {
		<span class="keyword">var</span> length = <span class="keyword">this</span>.value.length;
		<span class="keyword">return</span> <span class="keyword">this</span>.value.map(row =&gt; row.map(col =&gt; col.toString()).join(<span class="string">'\t'</span>) )
			.map(<span class="function"><span class="keyword">function</span> <span class="params">(row, index)</span> {</span>
				<span class="keyword">if</span> (index === <span class="number">0</span>) {
					<span class="keyword">return</span> <span class="string">'⎛'</span> + row + <span class="string">'⎞'</span>;
				}
				<span class="keyword">else</span> <span class="keyword">if</span> (index === length - <span class="number">1</span>) {
					<span class="keyword">return</span> <span class="string">'⎝'</span> + row + <span class="string">'⎠'</span>;
				}
				<span class="keyword">else</span> {
					<span class="keyword">return</span>  <span class="string">'⎜'</span> + row + <span class="string">'⎟'</span>;
				}
			}).join(<span class="string">'\n'</span>);
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'number'</span> || <span class="keyword">this</span>.subtype === <span class="string">'variable'</span>) {
		<span class="keyword">return</span> <span class="keyword">this</span>.value;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'naryOperator'</span>) {
		<span class="keyword">return</span> <span class="keyword">this</span>.content.reduce((old, cur) =&gt; old + <span class="keyword">this</span>.value + cur);
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'rationalNumber'</span>) {
		<span class="keyword">return</span> <span class="keyword">this</span>.value[<span class="number">0</span>].toString() + <span class="string">'/'</span> + <span class="keyword">this</span>.value[<span class="number">1</span>].toString();
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'set'</span>) {
		<span class="keyword">return</span> <span class="string">'{'</span> + <span class="keyword">this</span>.value.map(x =&gt; x.toString()).join(<span class="string">', '</span>) + <span class="string">'}'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'string'</span>) {
		<span class="keyword">return</span> <span class="string">'"'</span> + <span class="keyword">this</span>.value + <span class="string">'"'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'unaryOperator'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.value === <span class="string">'-'</span>) {
			<span class="keyword">return</span> <span class="string">'-'</span> + <span class="keyword">this</span>.content.toString()
		}
		<span class="keyword">return</span> <span class="keyword">this</span>.content.toString();
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'vector'</span>) {
		<span class="keyword">return</span> <span class="string">'('</span> + <span class="keyword">this</span>.value.map(x =&gt; x.toString()).join(<span class="string">', '</span>) + <span class="string">')'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'functionCall'</span>) {
		<span class="keyword">return</span> <span class="keyword">this</span>.value + <span class="string">'('</span> +
			(<span class="keyword">this</span>.content.length 
			? <span class="keyword">this</span>.content.map((expr) =&gt; expr.toString()).join(<span class="string">', '</span>)
			: <span class="string">'x'</span>) +
			<span class="string">')'</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.subtype === <span class="string">'functionDefinition'</span>) {
		<span class="keyword">return</span> (<span class="keyword">this</span>.arguments.length === <span class="number">1</span>
			? <span class="keyword">this</span>.arguments[<span class="number">0</span>]
			: <span class="string">'('</span> + <span class="keyword">this</span>.arguments.join(<span class="string">', '</span>) + <span class="string">')'</span>) +
			
			<span class="string">' ⟼ '</span> +

			(<span class="keyword">this</span>.content.length === <span class="number">1</span>
			? <span class="keyword">this</span>.content[<span class="number">0</span>].toString()
			: <span class="string">'('</span> + <span class="keyword">this</span>.content.map(expr =&gt; expr.toString()).join(<span class="string">', '</span>) + <span class="string">')'</span>) 
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <h3 id="expression-variable">Expression.variable</h3>
<p>Constructs a variable expression.</p>
<p><em>@return {Expression}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static variable(n) : Expression {
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
		subtype: <span class="string">'variable'</span>,
		value: n
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <h3 id="expression-variables">Expression.variables</h3>
<p>Stores all the values of variables in symbolic expressions.</p>
<p><em>@return {Expression}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static variables = {};


}<span class="comment">// ## &lt;a id="Functn" href="http://mathlib.de/en/docs/Functn"&gt;Functn&lt;/a&gt;</span></pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>Because &#39;Function&#39; is a reserved word in JavaScript,
the module is called &#39;Functn&#39;.  </p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">var</span> functnPrototype : any = {};

MathLib.Functn = <span class="function"><span class="keyword">function</span> <span class="params">(f, options)</span> {</span>
	options = options || {};

	<span class="keyword">var</span> functn = <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">if</span> (<span class="keyword">typeof</span> x === <span class="string">'number'</span> || <span class="keyword">typeof</span> x === <span class="string">'boolean'</span>) {
			<span class="keyword">return</span> f.apply(<span class="string">''</span>, arguments);
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'functn'</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>x -&gt; f(x)
y -&gt; g(y)
y -&gt; f(g(y))</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">var</span> bvar = options.expression.arguments[<span class="number">0</span>].value,
					composition = options.expression.map(<span class="function"><span class="keyword">function</span> <span class="params">(expr)</span> {</span>
						<span class="keyword">if</span> (expr.subtype === <span class="string">'variable'</span> &amp;&amp; expr.value === bvar) {
							expr = x.expression.content[<span class="number">0</span>];
						}
						<span class="keyword">return</span> expr;
					});

			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Functn(<span class="function"><span class="keyword">function</span> <span class="params">(y)</span> {</span><span class="keyword">return</span> f(x(y));}, {
					expression: <span class="keyword">new</span> MathLib.Expression({
						subtype: <span class="string">'functionDefinition'</span>,
						arguments: x.expression.arguments,
						content: composition.content
					})
				});
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'expression'</span> &amp;&amp; x.subtype === <span class="string">'variable'</span>) {
			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Functn(f, {
					expression: <span class="keyword">new</span> MathLib.Expression({
						subtype: <span class="string">'functionDefinition'</span>,
						arguments: x,
						content: x
					})
				});
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> x === <span class="string">'function'</span>) {
			<span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">(y)</span> {</span><span class="keyword">return</span> f(x(y));};
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'complex'</span>) {
			<span class="keyword">return</span> x[options.name].apply(x, Array.prototype.slice.call(arguments, <span class="number">1</span>));
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'rational'</span>) {
			<span class="keyword">return</span> f(x.toNumber());
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'set'</span>) {
			<span class="keyword">return</span> x.map(f);
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (MathLib.type(x) === <span class="string">'array'</span>) {
			<span class="keyword">return</span> x.map(f);
		}
		<span class="keyword">else</span> {
			<span class="keyword">return</span> x[options.name]();
		}
	};

	<span class="keyword">for</span> (<span class="keyword">var</span> name <span class="keyword">in</span> functnPrototype) {
		<span class="keyword">if</span> (functnPrototype.hasOwnProperty(name)) {
			functn[name] = functnPrototype[name];
		}
	}
	(<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>functn).type = 'functn';
	(<span class="tag">&lt;<span class="title">any</span>&gt;</span>functn).constructor = MathLib.Functn;


	Object.defineProperties(functn, {
		id: { value: options.name},
		expression: {value: options.expression}
	});

	return functn;
};


var binaryFunctions = {
	arctan2: Math.atan2,
	binomial: function (n, k) {
</span></pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>TODO: non integer values
What should be done with very big numbers?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">var</span> binomial = <span class="number">1</span>, i, sign;</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>not finite means ±∞ or NaN</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (MathLib.isNaN(n) || !MathLib.isFinite(k)) {
			<span class="keyword">return</span> <span class="literal">NaN</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>Exit early for areas which return 0</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> ( (n &gt;= <span class="number">0</span> &amp;&amp; k &lt;= -<span class="number">1</span>)
			|| (n &gt;= <span class="number">0</span> &amp;&amp; k &gt; n)
			|| (k &lt;  <span class="number">0</span> &amp;&amp; k &gt; n)) {
			<span class="keyword">return</span> <span class="number">0</span>;
		}

		<span class="keyword">if</span> (n &lt; <span class="number">0</span>) {
			<span class="keyword">if</span> (k &lt; <span class="number">0</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>negative odd number % 2 = -1 and not +1
This leads to the + 1 here.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="keyword">return</span> ((n + k) % <span class="number">2</span> * <span class="number">2</span> + <span class="number">1</span>) * MathLib.binomial(-k - <span class="number">1</span>, -n - <span class="number">1</span>);
			}
			<span class="keyword">else</span> {
				<span class="keyword">if</span> (k === <span class="number">0</span>) {
					sign = <span class="number">1</span>;
				}
				<span class="keyword">else</span> {
					sign = -(k % <span class="number">2</span> * <span class="number">2</span> - <span class="number">1</span>);
				}
				binomial = sign * MathLib.binomial(k - n - <span class="number">1</span>, k);
			}
		}

		<span class="keyword">if</span> (k &gt; n / <span class="number">2</span>) {
			k = n - k;
		}

		<span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= k; i++) {
			binomial *= (n + <span class="number">1</span> - i) / i;
		}
		<span class="keyword">return</span> binomial;
	},
	divide: <span class="function"><span class="keyword">function</span> <span class="params">(a, b)</span> {</span>
		<span class="keyword">return</span> MathLib.times(a, MathLib.inverse(b));
	},
	log: <span class="function"><span class="keyword">function</span> <span class="params">(base, x)</span> {</span>
		<span class="keyword">if</span> (arguments.length === <span class="number">1</span>) {
			x = base;
			base = <span class="number">10</span>;
		}
		<span class="keyword">return</span> Math.log(x) / Math.log(base);
	},
	minus: <span class="function"><span class="keyword">function</span> <span class="params">(a, b)</span> {</span>
		<span class="keyword">return</span> MathLib.plus(a, MathLib.negative(b));
	},
	mod: <span class="function"><span class="keyword">function</span> <span class="params">(n, m)</span> {</span>
		<span class="keyword">var</span> nm = n % m;
		<span class="keyword">return</span> nm &gt;= <span class="number">0</span> ? nm : nm + m;
	},
	pow: <span class="function"><span class="keyword">function</span> <span class="params">(x, y)</span> {</span>
		<span class="keyword">if</span> (x === <span class="number">1</span> || (x === -<span class="number">1</span> &amp;&amp; (y === <span class="literal">Infinity</span> || y === -<span class="literal">Infinity</span>))) {
			<span class="keyword">return</span> <span class="number">1</span>;
		}
		<span class="keyword">return</span> Math.pow(x, y);
	},
	root: <span class="function"><span class="keyword">function</span> <span class="params">(x, root)</span> {</span>
		<span class="keyword">if</span> (arguments.length === <span class="number">1</span>) {
			<span class="keyword">return</span> Math.sqrt(x);
		}
		<span class="keyword">return</span> Math.pow(x, <span class="number">1</span> / root);
	},
};


<span class="keyword">var</span> createBinaryFunction = <span class="function"><span class="keyword">function</span> <span class="params">(f, name)</span> {</span>
	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">if</span> (<span class="keyword">typeof</span> x === <span class="string">'number'</span>) {
			<span class="keyword">return</span> f.apply(<span class="string">''</span>, arguments);
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> x === <span class="string">'function'</span>) {
			<span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">(y)</span> {</span><span class="keyword">return</span> f(x(y));};
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'set'</span>) {
			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Set( x.map(f) );
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'complex'</span>) {
			<span class="keyword">return</span> x[name].apply(x, Array.prototype.slice.call(arguments, <span class="number">1</span>));
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (Array.isArray(x)) {
			<span class="keyword">return</span> x.map(f);
		}
		<span class="keyword">else</span> {
			<span class="keyword">return</span> x[name]();
		}
	};
};


<span class="keyword">var</span> func, cur;
<span class="keyword">for</span> (func <span class="keyword">in</span> binaryFunctions) {
	<span class="keyword">if</span> (binaryFunctions.hasOwnProperty(func)) {

		cur = binaryFunctions[func];
		Object.defineProperty(MathLib, func, {
			value: createBinaryFunction(binaryFunctions[func], func)
		});
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <h3 id="-functn-prototype-diff-http-mathlib-de-en-docs-functn-diff-"><a href="http://mathlib.de/en/docs/Functn/diff">Functn.prototype.diff()</a></h3>
<p>Numeric derivative at a given point</p>
<p><em>@param {number}</em> The point<br><em>@param {number}</em> Optional step size<br><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>functnPrototype.diff = <span class="function"><span class="keyword">function</span> <span class="params">(x: number, h = 1e-5)</span> : <span class="title">number</span> {</span>
	<span class="keyword">return</span> (<span class="keyword">this</span>(x + h) - <span class="keyword">this</span>(x - h)) / (<span class="number">2</span> * h);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <h3 id="-functn-prototype-draw-http-mathlib-de-en-docs-functn-draw-"><a href="http://mathlib.de/en/docs/Functn/draw">Functn.prototype.draw()</a></h3>
<p>Draws the function on the screen</p>
<p><em>@param {Screen}</em> The screen to draw the function onto.<br><em>@param {object}</em> [options] Optional drawing options.<br><em>@return {Functn}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>functnPrototype.draw = <span class="function"><span class="keyword">function</span> <span class="params">(screen, options : any = {})</span> : <span class="title">number</span> {</span>
	<span class="keyword">var</span> functn = <span class="keyword">this</span>;
	<span class="keyword">if</span> (Array.isArray(screen)) {
		screen.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
			x.path(functn, options);
		});
	}
	<span class="keyword">else</span> {
		screen.path(functn, options);
	}

	<span class="keyword">return</span> <span class="keyword">this</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>These functions will be added to the functn prototype soon.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">var</span> functionList1 = {
	divisors: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">var</span> divisors = x === <span class="number">1</span> ? [] : [<span class="number">1</span>],
				i, ii;
		<span class="keyword">for</span> (i = <span class="number">2</span>, ii = x / <span class="number">2</span>; i &lt;= ii; i++) {
			<span class="keyword">if</span> (x % i === <span class="number">0</span>) {
				divisors.push(i);
			}
		}
		divisors.push(x);
		<span class="keyword">return</span> MathLib.set(divisors);
	},
	factor: <span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span>
		<span class="keyword">var</span> factors = [],
				i;
		n = Math.abs(n);
		<span class="keyword">while</span> (n % <span class="number">2</span> === <span class="number">0</span>) {
			n = n / <span class="number">2</span>;
			factors.push(<span class="number">2</span>);
		}

		i = <span class="number">3</span>;
		<span class="keyword">while</span> (n !== <span class="number">1</span>) {
			<span class="keyword">while</span> (n % i === <span class="number">0</span>) {
				n = n / i;
				factors.push(i);
			}
			i += <span class="number">2</span>;
		}
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Set(factors, <span class="literal">true</span>);
	},
	fallingFactorial: <span class="function"><span class="keyword">function</span> <span class="params">(n, m, s)</span> {</span>
		<span class="keyword">var</span> factorial = <span class="number">1</span>, j;
		s = s || <span class="number">1</span>;

		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; m; j++) {
			factorial  *= (n - j * s);
		}
		<span class="keyword">return</span> factorial;
	},
	fibonacci: <span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span>
		<span class="keyword">return</span> Math.floor(Math.pow(MathLib.goldenRatio, n) / Math.sqrt(<span class="number">5</span>));
	},
	random: Math.random,
	risingFactorial: <span class="function"><span class="keyword">function</span> <span class="params">(n, m, s)</span> {</span>
		<span class="keyword">var</span> factorial = <span class="number">1</span>, j;
		s = s || <span class="number">1</span>;

		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; m; j++) {
			factorial  *= (n + j * s);
		}
		<span class="keyword">return</span> factorial;
	},
	round: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>Some implementations have a bug where Math.round(-0) = +0 (instead of -0).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (x === <span class="number">0</span>) {
			<span class="keyword">return</span> x;
		}
		<span class="keyword">return</span> Math.round(x);
	},
	trunc: <span class="function"><span class="keyword">function</span> <span class="params">(x, n)</span> {</span>
		<span class="keyword">return</span> x.toFixed(n || <span class="number">0</span>);
	},
	toContentMathML: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">if</span> (<span class="keyword">typeof</span> x === <span class="string">'number'</span>) {
			<span class="keyword">return</span> <span class="string">'&lt;cn&gt;'</span> + x + <span class="string">'&lt;/cn&gt;'</span>;
		}
		<span class="keyword">else</span> {
			<span class="keyword">return</span> x.toContentMathML();
		}
	},
	toLaTeX: <span class="function"><span class="keyword">function</span> <span class="params">(x, plus)</span> {</span>
		<span class="keyword">if</span> (plus) {
			<span class="keyword">return</span> (x &lt; <span class="number">0</span> ? <span class="string">'-'</span> : <span class="string">'+'</span>) + Math.abs(x);
		}
		<span class="keyword">else</span> {
			<span class="keyword">return</span> (x &lt; <span class="number">0</span> ? <span class="string">'-'</span> : <span class="string">''</span>) + Math.abs(x);
		}
	},
	toMathML: <span class="function"><span class="keyword">function</span> <span class="params">(x, plus)</span> {</span>
		<span class="keyword">if</span> (plus) {
			<span class="keyword">return</span> <span class="string">'&lt;mo&gt;'</span> + (x &lt; <span class="number">0</span> ? <span class="string">'-'</span> : <span class="string">'+'</span>) + <span class="string">'&lt;/mo&gt;&lt;mn&gt;'</span> + Math.abs(x) + <span class="string">'&lt;/mn&gt;'</span>;
		}
		<span class="keyword">else</span> {
			<span class="keyword">return</span> (x &lt; <span class="number">0</span> ? <span class="string">'&lt;mo&gt;-&lt;/mo&gt;'</span>: <span class="string">''</span>) + <span class="string">'&lt;mn&gt;'</span> + Math.abs(x) + <span class="string">'&lt;/mn&gt;'</span>;
		}
	},
	toString: <span class="function"><span class="keyword">function</span> <span class="params">(x, plus)</span> {</span>
		<span class="keyword">if</span> (plus) {
			<span class="keyword">return</span> (x &lt; <span class="number">0</span> ? <span class="string">'-'</span> : <span class="string">'+'</span>) + Math.abs(x);
		}
		<span class="keyword">else</span> {
			<span class="keyword">return</span> (x &lt; <span class="number">0</span> ? <span class="string">'-'</span> : <span class="string">''</span>) + Math.abs(x);
		}
	}
};




<span class="keyword">var</span> createFunction1 = <span class="function"><span class="keyword">function</span> <span class="params">(f, name)</span> {</span>
	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">if</span> (<span class="keyword">typeof</span> x === <span class="string">'number'</span>) {
			<span class="keyword">return</span> f.apply(<span class="string">''</span>, arguments);
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> x === <span class="string">'function'</span>) {
			<span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">(y)</span> {</span><span class="keyword">return</span> f(x(y));};
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'set'</span>) {
			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Set( x.map(f) );
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'complex'</span>) {
			<span class="keyword">return</span> x[name].apply(x, Array.prototype.slice.call(arguments, <span class="number">1</span>));
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (Array.isArray(x)) {
			<span class="keyword">return</span> x.map(f);
		}
		<span class="keyword">else</span> {
			<span class="keyword">return</span> x[name]();
		}
	};
};</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>Add the functions to the MathLib object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">for</span> (func <span class="keyword">in</span> functionList1) {
	<span class="keyword">if</span> (functionList1.hasOwnProperty(func)) {

		cur = functionList1[func];
		Object.defineProperty(MathLib, func, {
			value: createFunction1(functionList1[func], func)
		});
	}
}








MathLib.compare = <span class="function"><span class="keyword">function</span> <span class="params">(a, b)</span> {</span>
	<span class="keyword">if</span> (MathLib.type(a) !== MathLib.type(b)) {
		<span class="keyword">return</span> MathLib.sign(MathLib.type(a).localeCompare(MathLib.type(b)));
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> a === <span class="string">'number'</span>) {
		<span class="keyword">return</span> MathLib.sign(a - b);
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> a === <span class="string">'string'</span>) {
		<span class="keyword">return</span> a.localeCompare(b);
	}
	<span class="keyword">return</span> a.compare(b);
};


MathLib.type = <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
	<span class="keyword">if</span> (x === <span class="literal">null</span>) {
		<span class="keyword">return</span> <span class="string">'null'</span>;
	}
	<span class="keyword">if</span> (x === <span class="literal">undefined</span>) {
		<span class="keyword">return</span> <span class="string">'undefined'</span>;
	}
	<span class="keyword">return</span> x.type ? x.type : (x.constructor.name || Object.prototype.toString.call(x).slice(<span class="number">8</span>, -<span class="number">1</span>)).toLowerCase();
};


MathLib.is = <span class="function"><span class="keyword">function</span> <span class="params">(obj, type)</span> {</span>
	<span class="keyword">var</span> ucfirst = <span class="function"><span class="keyword">function</span> <span class="params">(str)</span> {</span>
		<span class="keyword">return</span> str.slice(<span class="number">0</span>,<span class="number">1</span>).toUpperCase() + str.slice(<span class="number">1</span>);
	};

	<span class="keyword">if</span> (MathLib.type(obj) === type) {
		<span class="keyword">return</span> <span class="literal">true</span>;
	}
	<span class="keyword">else</span> <span class="keyword">if</span> ([<span class="string">'circle'</span>, <span class="string">'complex'</span>, <span class="string">'expression'</span>, <span class="string">'functn'</span>, <span class="string">'line'</span>, <span class="string">'matrix'</span>, <span class="string">'permutation'</span>, <span class="string">'point'</span>,
			<span class="string">'polynomial'</span>, <span class="string">'rational'</span>, <span class="string">'screen'</span>, <span class="string">'screen2d'</span>, <span class="string">'screen3d'</span>, <span class="string">'set'</span>, <span class="string">'vector'</span>].indexOf(type) !== -<span class="number">1</span>) {
		<span class="keyword">return</span> obj <span class="keyword">instanceof</span> MathLib[ucfirst(type)];
	}
	<span class="keyword">else</span> {
		<span class="keyword">return</span> obj <span class="keyword">instanceof</span> window[ucfirst(type)];
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <h3 id="mathlib-ismathmlsupported-">MathLib.isMathMLSupported()</h3>
<p>Checks if MathML is supported by the browser.<br>Code stolen from <a href="http://www.modernizr.com/">Modernizr</a></p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>MathLib.isMathMLSupported = <span class="function"><span class="keyword">function</span> <span class="params">()</span> : <span class="title">boolean</span> {</span>
	<span class="keyword">var</span> hasMathML = <span class="literal">false</span>,
			ns, div, mfrac;
	<span class="keyword">if</span> (document.createElementNS) {
		ns = <span class="string">'http://www.w3.org/1998/Math/MathML'</span>;
		div = document.createElement(<span class="string">'div'</span>);
		div.style.position = <span class="string">'absolute'</span>;
		mfrac = div.appendChild(document.createElementNS(ns, <span class="string">'math'</span>))
								.appendChild(document.createElementNS(ns, <span class="string">'mfrac'</span>));
		mfrac.appendChild(document.createElementNS(ns, <span class="string">'mi'</span>))
				 .appendChild(document.createTextNode(<span class="string">'xx'</span>));
		mfrac.appendChild(document.createElementNS(ns, <span class="string">'mi'</span>))
				 .appendChild(document.createTextNode(<span class="string">'yy'</span>));
		document.body.appendChild(div);
		hasMathML = div.offsetHeight &gt; div.offsetWidth;
		document.body.removeChild(div);
	}
	<span class="keyword">return</span> hasMathML;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <h3 id="mathlib-writemathml-">MathLib.writeMathML()</h3>
<p>Writes MathML to an element.</p>
<p><em>@param {string}</em> The id of the element in which the MathML should be inserted.<br><em>@param {string}</em> The MathML to be inserted.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>MathLib.writeMathML = <span class="function"><span class="keyword">function</span> <span class="params">(id : string, math : string)</span> : <span class="title">void</span> {</span>
	<span class="keyword">var</span> formula;
	document.getElementById(id).innerHTML = <span class="string">'&lt;math&gt;'</span> + math + <span class="string">'&lt;/math&gt;'</span>;
	<span class="keyword">if</span> (<span class="keyword">typeof</span> MathJax !== <span class="string">'undefined'</span>) {
		formula = MathJax.Hub.getAllJax(id)[<span class="number">0</span>];
		MathJax.Hub.Queue([<span class="string">'Typeset'</span>, MathJax.Hub, id]);
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <h3 id="mathlib-loadmathjax-">MathLib.loadMathJax()</h3>
<p>Loads MathJax dynamically.</p>
<p><em>@param {string}</em> [config] Optional config options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>MathLib.loadMathJax = <span class="function"><span class="keyword">function</span> <span class="params">(config : string)</span> : <span class="title">void</span> {</span>
	<span class="keyword">var</span> script = <span class="xml"><span class="tag">&lt;<span class="title">HTMLScriptElement</span>&gt;</span>document.createElement('script');
	script.type = 'text/javascript';
	script.src  = 'http://cdn.mathjax.org/mathjax/latest/MathJax.js';

	config = config ||	'MathJax.Hub.Config({' +
												'config: ["MMLorHTML.js"],' +
												'jax: ["input/TeX", "input/MathML", "output/HTML-CSS", "output/NativeMML"],' +
												'extensions: ["tex2jax.js", "mml2jax.js", "MathMenu.js", "MathZoom.js"],' +
												'TeX: {' +
													'extensions: ["AMSmath.js", "AMSsymbols.js", "noErrors.js", "noUndefined.js"]' +
												'}' +
										 	'});';

	if ((<span class="tag">&lt;<span class="title">any</span>&gt;</span>window).opera) {
		script.innerHTML = config;
	}
	else {
		script.text = config;
	}

	document.getElementsByTagName('head')[0].appendChild(script);
}


</span></pre></div></div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <p>Functions that act on set-like structures and return one single number/boolean...</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">var</span> nAryFunctions = {</pre></div></div>
            
        </li>
        
        
        <li id="section-58">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-58">&#182;</a>
              </div>
              <h3 id="mathlib-and-">MathLib.and()</h3>
<p>Returns true iff all arguments are true.</p>
<p><em>@param {boolean}</em> Expects an arbitrary number of boolean arguments<br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	and: <span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span>
		<span class="keyword">return</span> n.every(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span><span class="keyword">return</span> !!x;});
	},
	arithMean: <span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span>
		<span class="keyword">return</span> MathLib.plus(n) / n.length;
	},
	gcd: <span class="function"><span class="keyword">function</span> <span class="params">(a)</span> {</span>
		<span class="keyword">var</span> min,
				reduction = <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
					<span class="keyword">return</span> x !== min ? x % min : x;
				},
				isntZero = <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
					<span class="keyword">return</span> x !== <span class="number">0</span>;
				};</pre></div></div>
            
        </li>
        
        
        <li id="section-59">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-59">&#182;</a>
              </div>
              <p>remove zeros and make negative values positive</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		a = a.filter(isntZero).map(Math.abs);

		<span class="keyword">if</span> (a.length === <span class="number">0</span>) {
			<span class="keyword">return</span> <span class="number">0</span>;
		}

		<span class="keyword">while</span> (a.length &gt; <span class="number">1</span>) {
			min = MathLib.min(a);
			a = a.map(reduction).filter(isntZero);
		}
		<span class="keyword">return</span> a[<span class="number">0</span>] || min;
	},
	geoMean: <span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span>
		<span class="keyword">return</span> MathLib.root(MathLib.times(n), n.length);
	},
	harmonicMean: <span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span>
		<span class="keyword">return</span> n.length / MathLib.plus(n.map(MathLib.inverse));
	},
	hypot: <span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span>
		<span class="keyword">var</span> a, b, max, min;

		<span class="keyword">if</span> (n.length === <span class="number">1</span>) {
			<span class="keyword">return</span> Math.abs(n[<span class="number">0</span>]);
		}

		<span class="keyword">if</span> (n.length &gt; <span class="number">2</span>) {
			<span class="keyword">return</span> n.reduce((a, b) =&gt; MathLib.hypot(a, b));
		}

		a = MathLib.abs(n[<span class="number">0</span>]);
		b = MathLib.abs(n[<span class="number">1</span>]);</pre></div></div>
            
        </li>
        
        
        <li id="section-60">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-60">&#182;</a>
              </div>
              <p>Return Infinity if one value is infinite, even if the other value is NaN.
(see IEEE 754-2008, 9.2.1)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (a === <span class="literal">Infinity</span> || b === <span class="literal">Infinity</span>) {
			<span class="keyword">return</span> <span class="literal">Infinity</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-61">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-61">&#182;</a>
              </div>
              <p>Return +0 if both values are ±0 (see IEEE 754-2008, 9.2.1)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (a === <span class="number">0</span> &amp;&amp; b === <span class="number">0</span>) {
			<span class="keyword">return</span> <span class="number">0</span>;
		}

		max = Math.max(a, b);
		min = Math.min(a, b);

		<span class="keyword">return</span> max * Math.sqrt(<span class="number">1</span> + Math.pow(min / max, <span class="number">2</span>));
	},
	hypot2: <span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-62">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-62">&#182;</a>
              </div>
              <p>Return Infinity if one value is infinite</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (n.some(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
			<span class="keyword">return</span> x === <span class="literal">Infinity</span> || x === -<span class="literal">Infinity</span>;
		})) {
			<span class="keyword">return</span> <span class="literal">Infinity</span>;
		}
		<span class="keyword">return</span> n.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(old, cur)</span> {</span>
			<span class="keyword">return</span> old + cur * cur;
		}, <span class="number">0</span>);
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-63">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-63">&#182;</a>
              </div>
              <h3 id="mathlib-isequal-">MathLib.isEqual()</h3>
<p>Determines if all arguments are equal.</p>
<p><em>@param {number, MathLib object}</em> Expects an arbitrary number of numbers or MathLib objects<br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	isEqual: <span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span>
		<span class="keyword">return</span> n.every(<span class="function"><span class="keyword">function</span> <span class="params">(a, i, args)</span> {</span>
			<span class="keyword">if</span> (a === args[<span class="number">0</span>]) {
				<span class="keyword">return</span> <span class="literal">true</span>;
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> a === <span class="string">'number'</span> &amp;&amp; <span class="keyword">typeof</span> args[<span class="number">0</span>] === <span class="string">'number'</span>) {
				<span class="keyword">return</span> Math.abs(a - args[<span class="number">0</span>]) &lt;= <span class="number">3e-15</span>;
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> a === <span class="string">'object'</span>) {
				<span class="keyword">return</span> a.isEqual(args[<span class="number">0</span>]);
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> args[<span class="number">0</span>] === <span class="string">'object'</span>) {
				<span class="keyword">return</span> args[<span class="number">0</span>].isEqual(a);
			}
			<span class="keyword">return</span> <span class="literal">false</span>;
		});
	},
	lcm: <span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span>
		<span class="keyword">if</span> (n.length === <span class="number">0</span>) {
			<span class="keyword">return</span> <span class="number">0</span>;
		}
		<span class="keyword">if</span> (n.length === <span class="number">1</span>) {
			<span class="keyword">return</span> n[<span class="number">0</span>];
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (n.length === <span class="number">2</span>) {
			<span class="keyword">return</span> MathLib.times(n) / MathLib.gcd(n);
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (n.length &gt; <span class="number">2</span>) {
			<span class="keyword">return</span> n.reduce((x, y) =&gt; MathLib.lcm(x, y));
		}
	},
	max: <span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span>
		<span class="keyword">return</span> Math.max.apply(<span class="literal">null</span>, n);
	},
	min: <span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span>
		<span class="keyword">return</span> Math.min.apply(<span class="literal">null</span>, n);
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-64">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-64">&#182;</a>
              </div>
              <h3 id="mathlib-or-">MathLib.or()</h3>
<p>Returns true iff at least one argument is true.</p>
<p><em>@param {boolean}</em> Expects an arbitrary number of boolean arguments<br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	or: <span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span>
		<span class="keyword">return</span> n.some(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span><span class="keyword">return</span> !!x;});
	},
	plus: <span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span>
		<span class="keyword">if</span> (n.length === <span class="number">0</span>) {
			<span class="keyword">return</span> <span class="number">0</span>;
		}
		<span class="keyword">return</span> n.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(a, b)</span> {</span>
			<span class="keyword">var</span> f1, f2, aExpr, bExpr;
			<span class="keyword">if</span> (<span class="keyword">typeof</span> a === <span class="string">'number'</span> &amp;&amp; <span class="keyword">typeof</span> b === <span class="string">'number'</span>) {
				<span class="keyword">return</span> a + b;
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (a.type === <span class="string">'functn'</span> || b.type === <span class="string">'functn'</span>) {
				f1 = a;
				f2 = b;
				aExpr = a.expression ? a.expression.content[<span class="number">0</span>] : {};
				bExpr = b.expression ? b.expression.content[<span class="number">0</span>] : {};

				<span class="keyword">if</span> (a.type !== <span class="string">'functn'</span>) {
					f1 = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
						<span class="keyword">return</span> a;
					};
					aExpr = <span class="keyword">new</span> MathLib.Expression({
						value: a,
						subtype: <span class="string">'number'</span>
					});
				}
				<span class="keyword">else</span> <span class="keyword">if</span> (b.type !== <span class="string">'functn'</span>) {
					f2 = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
						<span class="keyword">return</span> b;
					};
					bExpr = <span class="keyword">new</span> MathLib.Expression({
						value: b,
						subtype: <span class="string">'number'</span>
					});
				}
				<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Functn(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
					<span class="keyword">return</span> MathLib.plus(f1(x), f2(x));
				}, {
					expression: <span class="keyword">new</span> MathLib.Expression({
						subtype: <span class="string">'functionDefinition'</span>,
						arguments: [<span class="string">'x'</span>],
						content: [<span class="keyword">new</span> MathLib.Expression({
								content: [aExpr, bExpr],
								subtype: <span class="string">'naryOperator'</span>,
								value: <span class="string">'+'</span>,
								name: <span class="string">'plus'</span>
							})
						]
					})
				});
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> a === <span class="string">'object'</span>) {
				<span class="keyword">return</span> a.plus(b);
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-65">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-65">&#182;</a>
              </div>
              <p>We&#39;re assuming that the operations are commutative</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> b === <span class="string">'object'</span>) {
				<span class="keyword">return</span> b.plus(a);
			}
		});
	},
	times: <span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span>
		<span class="keyword">if</span> (n.length === <span class="number">0</span>) {
			<span class="keyword">return</span> <span class="number">1</span>;
		}
		<span class="keyword">return</span> n.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(a, b)</span> {</span>
			<span class="keyword">var</span> f1, f2, aExpr, bExpr;
			<span class="keyword">if</span> (<span class="keyword">typeof</span> a === <span class="string">'number'</span> &amp;&amp; <span class="keyword">typeof</span> b === <span class="string">'number'</span>) {
				<span class="keyword">return</span> a * b;
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (a.type === <span class="string">'functn'</span> || b.type === <span class="string">'functn'</span>) {
				f1 = a;
				f2 = b;
				aExpr = a.expression ? a.expression.content[<span class="number">0</span>] : {};
				bExpr = b.expression ? b.expression.content[<span class="number">0</span>] : {};

				<span class="keyword">if</span> (a.type !== <span class="string">'functn'</span>) {
					f1 = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
						<span class="keyword">return</span> a;
					};
					aExpr = <span class="keyword">new</span> MathLib.Expression({
						value: a,
						subtype: <span class="string">'number'</span>
					});
				}
				<span class="keyword">else</span> <span class="keyword">if</span> (b.type !== <span class="string">'functn'</span>) {
					f2 = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
						<span class="keyword">return</span> b;
					};
					bExpr = <span class="keyword">new</span> MathLib.Expression({
						value: b,
						subtype: <span class="string">'number'</span>
					});
				}
				<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Functn(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
					<span class="keyword">return</span> MathLib.times(f1(x), f2(x));
				}, {
					expression: <span class="keyword">new</span> MathLib.Expression({
						subtype: <span class="string">'functionDefinition'</span>,
						arguments: [<span class="string">'x'</span>],
						content: [<span class="keyword">new</span> MathLib.Expression({
								content: [aExpr, bExpr],
								subtype: <span class="string">'naryOperator'</span>,
								value: <span class="string">'*'</span>,
								name: <span class="string">'times'</span>
							})
						]
					})
				});
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> a === <span class="string">'object'</span>) {
				<span class="keyword">return</span> a.times(b);
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-66">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-66">&#182;</a>
              </div>
              <p>We&#39;re assuming that the operations are commutative</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> b === <span class="string">'object'</span>) {
				<span class="keyword">return</span> b.times(a);
			}
		});
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-67">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-67">&#182;</a>
              </div>
              <h3 id="mathlib-xor-">MathLib.xor()</h3>
<p>Returns true iff an odd number of the arguments is true.</p>
<p><em>@param {boolean}</em> Expects an arbitrary number of boolean arguments<br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	xor: <span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span>
		<span class="keyword">return</span> n.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(x, y)</span> {</span><span class="keyword">return</span> x + !!y;}, <span class="number">0</span>) % <span class="number">2</span> !== <span class="number">0</span>;
	}
};


<span class="keyword">var</span> createNaryFunction = <span class="function"><span class="keyword">function</span> <span class="params">(f)</span> {</span>
	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span>
		<span class="keyword">if</span> (MathLib.type(n) === <span class="string">'set'</span>) {
			<span class="keyword">return</span> f(n.slice());
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (MathLib.type(n) !== <span class="string">'array'</span>) {
			n = Array.prototype.slice.apply(arguments);
		}
		<span class="keyword">return</span> f(n);
	};
};


<span class="keyword">for</span> (func <span class="keyword">in</span> nAryFunctions) {
	<span class="keyword">if</span> (nAryFunctions.hasOwnProperty(func)) {
		Object.defineProperty(MathLib, func, {
			value: createNaryFunction(nAryFunctions[func])
		});
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-68">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-68">&#182;</a>
              </div>
              <h3 id="-functn-prototype-quad-http-mathlib-de-en-docs-functn-quad-"><a href="http://mathlib.de/en/docs/Functn/quad">Functn.prototype.quad()</a></h3>
<p>Numeric evaluation of an integral using an adative simpson approach.</p>
<p>Inspired by &quot;adaptsim.m&quot; by Walter Gander
and MatLab&#39;s &quot;quad.m&quot;</p>
<p><em>@param {number}</em> The starting point<br><em>@param {number}</em> The end point<br><em>@param {number}</em> The tolerance<br><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>functnPrototype.quad = <span class="function"><span class="keyword">function</span> <span class="params">(a, b, options : any = {})</span> : <span class="title">number</span> {</span>
	
	<span class="keyword">var</span> f = <span class="keyword">this</span>,
			warnMessage = [
				<span class="string">'Calculation succeded'</span>,
				<span class="string">'Minimum step size reached'</span>,
				<span class="string">'Maximum function count exceeded'</span>,
				<span class="string">'Infinite or NaN function value encountered'</span>
			],
			Q;

	options.calls = <span class="number">3</span>;
	options.warn = <span class="number">0</span>;


	<span class="keyword">if</span> (a === -<span class="literal">Infinity</span>) {
		a = -Number.MAX_VALUE;
	}

	<span class="keyword">if</span> (b === 	<span class="literal">Infinity</span>) {
		b = Number.MAX_VALUE;
	}

	<span class="keyword">if</span> (!(<span class="string">'minStep'</span> <span class="keyword">in</span> options)) {
		options.minStep = <span class="number">1e-15</span>;
	}
	
	<span class="keyword">if</span> (!(<span class="string">'maxCalls'</span> <span class="keyword">in</span> options)) {
		options.maxCalls = <span class="number">10000</span>;
	}

	<span class="keyword">if</span> (!(<span class="string">'tolerance'</span> <span class="keyword">in</span> options)) {
		options.tolerance = <span class="number">1e-5</span>;
	}

	Q = quadstep(f, a, b, f(a), f((a + b) / <span class="number">2</span>), f(b), options);

	options.warnMessage = warnMessage[options.warn];

	<span class="keyword">return</span> Q;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-69">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-69">&#182;</a>
              </div>
              <p>Recursive function for the quad method</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">var</span> quadstep = <span class="function"><span class="keyword">function</span>  <span class="params">(f, a, b, fa, fc, fb, options)</span> {</span>

	<span class="keyword">var</span> h = b - a,
			c = (a + b) / <span class="number">2</span>,
			fd = f((a + c) / <span class="number">2</span>),
			fe = f((c + b) / <span class="number">2</span>),</pre></div></div>
            
        </li>
        
        
        <li id="section-70">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-70">&#182;</a>
              </div>
              <p>Three point Simpson&#39;s rule</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			Q1 = (h / <span class="number">6</span>) * (fa + <span class="number">4</span> * fc + fb),</pre></div></div>
            
        </li>
        
        
        <li id="section-71">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-71">&#182;</a>
              </div>
              <p>Five point double Simpson&#39;s rule</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			Q2 = (h / <span class="number">12</span>) * (fa + <span class="number">4</span> * fd + <span class="number">2</span> * fc + <span class="number">4</span> * fe + fb),</pre></div></div>
            
        </li>
        
        
        <li id="section-72">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-72">&#182;</a>
              </div>
              <p>Romberg extrapolation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			Q = Q2 + (Q2 - Q1) / <span class="number">15</span>;

			options.calls = options.calls + <span class="number">2</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-73">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-73">&#182;</a>
              </div>
              <p>Infinite or Not-a-Number function value encountered</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (!MathLib.isFinite(Q)) {
		options.warn = Math.max(options.warn, <span class="number">3</span>);
		<span class="keyword">return</span> Q;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-74">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-74">&#182;</a>
              </div>
              <p>Maximum function count exceeded; singularity likely</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (options.calls &gt; options.maxCalls) {
		options.warn = Math.max(options.warn, <span class="number">2</span>);
		<span class="keyword">return</span> Q;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-75">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-75">&#182;</a>
              </div>
              <p>Accuracy over this subinterval is acceptable</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (Math.abs(Q2 - Q) &lt;= options.tolerance) {
		<span class="keyword">return</span> Q;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-76">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-76">&#182;</a>
              </div>
              <p>Minimum step size reached; singularity possible</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (Math.abs(h) &lt; options.minStep || c === a || c === b) {
		options.warn = Math.max(options.warn, <span class="number">1</span>);
		<span class="keyword">return</span> Q;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-77">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-77">&#182;</a>
              </div>
              <p>Otherwise, divide the interval into two subintervals</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">return</span> quadstep(f, a, c, fa, fd, fc, options) +
					quadstep(f, c, b, fc, fe, fb, options);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-78">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-78">&#182;</a>
              </div>
              <h3 id="functn-prototype-tocontentmathml-">Functn.prototype.toContentMathML()</h3>
<p>Returns a content MathML representation of the function</p>
<p><em>@return {MathML}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>functnPrototype.toContentMathML = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
	<span class="keyword">return</span> <span class="keyword">this</span>.expression.toContentMathML();
};</pre></div></div>
            
        </li>
        
        
        <li id="section-79">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-79">&#182;</a>
              </div>
              <h3 id="-functn-prototype-tolatex-http-mathlib-de-en-docs-functn-tolatex-"><a href="http://mathlib.de/en/docs/Functn/toLaTeX">Functn.prototype.toLaTeX()</a></h3>
<p>Returns a LaTeX representation of the function</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>functnPrototype.toLaTeX = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
	<span class="keyword">return</span> <span class="keyword">this</span>.expression.toLaTeX();
<span class="comment">/*
	/ / List of functions to be executed on the specified node type
	var handlers = {
		apply: function (n) {
			var f = n.childNodes[0],
					args = n.childNodes.slice(1).map(function (x) {
						return handlers[x.nodeName](x);
					}),
					str = '';

			if (f.nodeName === 'plus') {
				str = args.join('+');
			}
			else if (f.nodeName === 'times') {
				str = args.join('*');
			}
			else if (f.nodeName === 'power') {
				str = args[0] + '^{' + args[1] + '}';
			}
			else {
				/ / TODO: not all functions can be written like \sin some have to be written like \operatorname{argmax}
				str = '\\' + f.nodeName + '(' + args.join(', ') + ')';
			}
			return str;
		},
		bvar: function () {return '';},
		ci: function (n) {return bvar || n.innerMathML;},
		cn: function (n) {return n.innerMathML;},
		cs: function (n) {return n.innerMathML;},
		domainofapplication: function () {return '';},
		lambda: function (n) {
			return n.childNodes.reduce(function (old, cur) {
				return old + handlers[cur.nodeName](cur);
			}, '');
		},
		'#text': function (n) {return n.innerMathML;}
	};

	/ / Start the node handling with the first real element (not the &lt;math&gt; element)
	return handlers[this.contentMathML.childNodes[0].nodeName](this.contentMathML.childNodes[0]);
	*/</span>
};</pre></div></div>
            
        </li>
        
        
        <li id="section-80">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-80">&#182;</a>
              </div>
              <h3 id="functn-prototype-tomathml-">Functn.prototype.toMathML()</h3>
<p>Returns a MathML representation of the function</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>functnPrototype.toMathML = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
	<span class="keyword">return</span> <span class="keyword">this</span>.expression.toMathML();
};</pre></div></div>
            
        </li>
        
        
        <li id="section-81">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-81">&#182;</a>
              </div>
              <h3 id="functn-prototype-tomathmlstring">Functn.prototype.toMathMLString</h3>
<p>Returns a MathML representation of the function</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="comment">/*functnPrototype.toMathMLString = function () {
	return this.contentMathML.toMathMLString();
};*/</span></pre></div></div>
            
        </li>
        
        
        <li id="section-82">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-82">&#182;</a>
              </div>
              <h3 id="-functn-prototype-tostring-http-mathlib-de-en-docs-functn-tostring-"><a href="http://mathlib.de/en/docs/Functn/toString">Functn.prototype.toString()</a></h3>
<p>Returns a string representation of the function</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>functnPrototype.toString = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
	<span class="keyword">return</span> <span class="keyword">this</span>.expression.toString();

<span class="comment">/*
	/ / List of functions to be executed on the specified node type
	var handlers = {
		apply: function (n) {
			var f = n.childNodes[0],
					args = n.childNodes.slice(1).map(function (x) {
						return handlers[x.nodeName](x);
					}),
					str = '';

			if (f.nodeName === 'plus') {
				str = args.join('+');
			}
			else if (f.nodeName === 'times') {
				str = args.join('*');
			}
			else if (f.nodeName === 'power') {
				str = args[0] + '^' + args[1];
			}
			else {
				str = f.nodeName + '(' + args.join(', ') + ')';
			}
			return str;
		},
		bvar: function () {return '';},
		ci: function (n) {return bvar || n.innerMathML;},
		cn: function (n) {return n.innerMathML;},
		cs: function (n) {return n.innerMathML;},
		domainofapplication: function () {return '';},
		lambda: function (n) {
			return n.childNodes.reduce(function (old, cur) {
				return old + handlers[cur.nodeName](cur);
			}, '');
		}, 
		'#text': function (n) {return n.innerMathML;}
	};

	/ / Start the node handling with the first real element (not the &lt;math&gt; element)
	return handlers[this.contentMathML.childNodes[0].nodeName](this.contentMathML.childNodes[0]);
	*/</span>
}</pre></div></div>
            
        </li>
        
        
        <li id="section-83">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-83">&#182;</a>
              </div>
              <h2 id="unary-functions">unary functions</h2>
<p>Some functions for the functn prototype</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">var</span> unaryFunctions = {
	abs: Math.abs,
	arccos: Math.acos,
	arccot: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> <span class="number">1.5707963267948966</span> - Math.atan(x);
	},
	arccsc: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> Math.asin(<span class="number">1</span> / x);
	},
	arcosh: MathLib.isNative((<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>Math).acosh) || function (x) {
		return Math.log(x + Math.sqrt(x * x - 1));
	},
	arcoth: function (x) {
</span></pre></div></div>
            
        </li>
        
        
        <li id="section-84">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-84">&#182;</a>
              </div>
              <p>Handle ±∞</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (!MathLib.isFinite(x)) {
			<span class="keyword">return</span> <span class="number">1</span> / x;
		}
		<span class="keyword">return</span> <span class="number">0.5</span> * Math.log((x + <span class="number">1</span>) / (x - <span class="number">1</span>));
	},
	arcsch: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-85">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-85">&#182;</a>
              </div>
              <p>Handle ±0 and ±∞ separately</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (x === <span class="number">0</span> || !MathLib.isFinite(x)) {
			<span class="keyword">return</span> <span class="number">1</span> / x;
		}
		<span class="keyword">return</span> Math.log(<span class="number">1</span> / x + Math.sqrt(<span class="number">1</span> / (x * x) + <span class="number">1</span>));
	},
	arcsec: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> Math.acos(<span class="number">1</span> / x);
	},
	arcsin: Math.asin,
	arctan: Math.atan,
	arsech: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> Math.log((<span class="number">1</span> + Math.sqrt(<span class="number">1</span> - x * x)) / x);
	},
	arsinh: MathLib.isNative((<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>Math).asinh) || function (x) {
</span></pre></div></div>
            
        </li>
        
        
        <li id="section-86">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-86">&#182;</a>
              </div>
              <p>Handle ±0 and ±∞ separately</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (x === <span class="number">0</span> || !MathLib.isFinite(x)) {
			<span class="keyword">return</span> x;
		}
		<span class="keyword">return</span> Math.log(x + Math.sqrt(x * x + <span class="number">1</span>));
	},
	artanh: MathLib.isNative((<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>Math).atanh) || function (x) {
</span></pre></div></div>
            
        </li>
        
        
        <li id="section-87">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-87">&#182;</a>
              </div>
              <p>Handle ±0</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (x === <span class="number">0</span>) {
			<span class="keyword">return</span> x;
		}
		<span class="keyword">return</span> <span class="number">0.5</span> * Math.log((<span class="number">1</span> + x) / (<span class="number">1</span> - x));
	},
	ceil: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-88">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-88">&#182;</a>
              </div>
              <p>Some implementations have a bug where Math.ceil(-0) = +0 (instead of -0)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (x === <span class="number">0</span>) {
			<span class="keyword">return</span> x;
		}
		<span class="keyword">return</span> Math.ceil(x);
	},
	cbrt: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">var</span> a3, a3x, an, a;</pre></div></div>
            
        </li>
        
        
        <li id="section-89">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-89">&#182;</a>
              </div>
              <p>Handle ±0, NaN, ±∞</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (x === <span class="number">0</span> || x !== x || x === <span class="literal">Infinity</span> || x === -<span class="literal">Infinity</span>) {
			<span class="keyword">return</span> x;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-90">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-90">&#182;</a>
              </div>
              <p>Get an approximation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		a = MathLib.sign(x) * Math.pow(Math.abs(x), <span class="number">1</span> / <span class="number">3</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-91">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-91">&#182;</a>
              </div>
              <p>Halley&#39;s method</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">while</span> (<span class="literal">true</span>) {
			a3 = Math.pow(a, <span class="number">3</span>);
			a3x = a3 + x;
			an = a * (a3x + x) / (a3x + a3);
			<span class="keyword">if</span> (MathLib.isZero(an - a)) {
				<span class="keyword">break</span>; 
			}
			a = an;
		}
		<span class="keyword">return</span> an;
	},
	conjugate: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> x;
	},
	copy: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> x;
	},
	cos: Math.cos,
	cosh: MathLib.isNative((<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>Math).cosh) || function (x) {
		return (Math.exp(x) + Math.exp(-x)) / 2;
	},
	cot: function (x) {
</span></pre></div></div>
            
        </li>
        
        
        <li id="section-92">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-92">&#182;</a>
              </div>
              <p>Handle ±0 separate, because tan(pi/2 ± 0) is not ±∞</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (x === <span class="number">0</span>) {
			<span class="keyword">return</span> <span class="number">1</span> / x;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-93">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-93">&#182;</a>
              </div>
              <p>cot(x) = tan(pi/2 - x) is better than 1/tan(x)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">return</span> Math.tan(<span class="number">1.5707963267948966</span> - x);
	},
	coth: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-94">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-94">&#182;</a>
              </div>
              <p>Handle ±0</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (x === <span class="number">0</span>) {
			<span class="keyword">return</span> <span class="number">1</span> / x;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-95">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-95">&#182;</a>
              </div>
              <p>Handle ±∞</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (!MathLib.isFinite(x)) {
			<span class="keyword">return</span> MathLib.sign(x);
		}

		<span class="keyword">return</span> (Math.exp(x) + Math.exp(-x)) / (Math.exp(x) - Math.exp(-x));
	},
	csc: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> <span class="number">1</span> / Math.sin(x);
	},
	csch: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-96">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-96">&#182;</a>
              </div>
              <p>csch(-0) should be -∞ not ∞</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (x === <span class="number">0</span>) {
			<span class="keyword">return</span> <span class="number">1</span> / x;
		}
		<span class="keyword">return</span> <span class="number">2</span> / (Math.exp(x) - Math.exp(-x));
	},
	degToRad: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-97">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-97">&#182;</a>
              </div>
              <p>Math.PI / 180 = 0.017453292519943295</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">return</span> x * <span class="number">0.017453292519943295</span>;
	},
	digitsum: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">var</span> out = <span class="number">0</span>;
		<span class="keyword">while</span> (x &gt; <span class="number">9</span>) {
			out += x % <span class="number">10</span>;
			x = Math.floor(x / <span class="number">10</span>);
		}
		<span class="keyword">return</span> out + x;
	},
	exp: Math.exp,
	factorial: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">var</span> factorial = <span class="number">1</span>, i;
		<span class="keyword">if</span> ((x &gt; <span class="number">170</span> &amp;&amp; MathLib.isInt(x)) || x === <span class="literal">Infinity</span> ) {
			<span class="keyword">return</span> <span class="literal">Infinity</span>;
		}
		<span class="keyword">if</span> (x &lt; <span class="number">0</span> || !MathLib.isInt(x) || MathLib.isNaN(x)) {
			<span class="keyword">return</span> <span class="literal">NaN</span>;
		}
		<span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= x; i++) {
			factorial *= i;
		}
		<span class="keyword">return</span> factorial;
	},
	floor: Math.floor,
	identity: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> x;
	},
	inverse: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> <span class="number">1</span> / x;
	},
	isFinite: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> Math.abs(x) &lt; <span class="literal">Infinity</span>;
	},
	isInt: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> x % <span class="number">1</span> === <span class="number">0</span>;
	},
	isNaN: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> x !== x;
	},
	isNegZero: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> <span class="number">1</span> / x === -<span class="literal">Infinity</span>;
	},
	isOne: <span class="function"><span class="keyword">function</span> <span class="params">(a)</span>    {</span>
		<span class="keyword">return</span> Math.abs(a - <span class="number">1</span>) &lt; MathLib.epsilon;
	},
	isPosZero: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> <span class="number">1</span> / x === <span class="literal">Infinity</span>;
	},
	isPrime: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">var</span> sqrt = Math.sqrt(x), i;
		<span class="keyword">if</span> (x % <span class="number">1</span> === <span class="number">0</span> &amp;&amp; x &gt; <span class="number">1</span>) {
			<span class="keyword">if</span> (x === <span class="number">2</span>) {
				<span class="keyword">return</span> <span class="literal">true</span>;
			}
			<span class="keyword">if</span> (x % <span class="number">2</span> === <span class="number">0</span>) {
				<span class="keyword">return</span> <span class="literal">false</span>;
			}
			<span class="keyword">for</span> (i = <span class="number">3</span>; i &lt;= sqrt; i += <span class="number">2</span>) {
				<span class="keyword">if</span> (x % i === <span class="number">0</span>) {
					<span class="keyword">return</span> <span class="literal">false</span>;
				}
			}
			<span class="keyword">return</span> <span class="literal">true</span>;
		}
		<span class="keyword">return</span> <span class="literal">false</span>;
	},
	isReal: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span>    {</span>
		<span class="keyword">return</span> Math.abs(x) &lt; <span class="literal">Infinity</span>;
	},
	isZero: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> Math.abs(x) &lt; MathLib.epsilon;
	},
	lg: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> Math.log(x) / Math.LN10;
	},
	ln: Math.log,</pre></div></div>
            
        </li>
        
        
        <li id="section-98">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-98">&#182;</a>
              </div>
              <p>Algorithm based on <a href="www.nr.com">Numerical Recipes Vol. 3, p. 257</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	logGamma: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">var</span> j, tmp, y, ser,
				cof = [<span class="number">57.1562356658629235</span>, -<span class="number">59.5979603554754912</span>, <span class="number">14.1360979747417471</span>, -<span class="number">0.491913816097620199</span>,
			<span class="number">0.339946499848118887e-4</span>, <span class="number">0.465236289270485756e-4</span>, -<span class="number">0.983744753048795646e-4</span>, <span class="number">0.158088703224912494e-3</span>,
			-<span class="number">0.210264441724104883e-3</span>, <span class="number">0.217439618115212643e-3</span>, -<span class="number">0.164318106536763890e-3</span>, <span class="number">0.844182239838527433e-4</span>,
			-<span class="number">0.261908384015814087e-4</span>, <span class="number">0.368991826595316234e-5</span>];

		y = x;
		tmp = x + <span class="number">5.24218750000000000</span>; <span class="comment">// Rational 671/128.</span>
		tmp = (x + <span class="number">0.5</span>) * Math.log(tmp) - tmp;
		ser = <span class="number">0.999999999999997092</span>;
		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">14</span>; j++) {
			ser += cof[j] / ++y;
		}
		<span class="keyword">return</span> tmp + Math.log(<span class="number">2.5066282746310005</span> * ser / x);
	},
	negative: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> -x;
	},
	not: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> !x;
	},
	radToDeg: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-99">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-99">&#182;</a>
              </div>
              <p>180 / Math.PI = 57.29577951308232</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">return</span> x * <span class="number">57.29577951308232</span>;
	},
	sec: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> <span class="number">1</span> / Math.cos(x);
	},
	sech: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> <span class="number">2</span> / (Math.exp(x) + Math.exp(-x));
	},
	sign: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> x &amp;&amp; (x &lt; <span class="number">0</span> ? -<span class="number">1</span> : <span class="number">1</span>);
	},
	sin: Math.sin,
	sinh: MathLib.isNative((<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>Math).sinh) || function (x) {
</span></pre></div></div>
            
        </li>
        
        
        <li id="section-100">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-100">&#182;</a>
              </div>
              <p>sinh(-0) should be -0</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (x === <span class="number">0</span>) {
			<span class="keyword">return</span> x;
		}
		<span class="keyword">return</span> (Math.exp(x) - Math.exp(-x)) / <span class="number">2</span>;
	},
	sqrt: Math.sqrt,
	tan: Math.tan,
	tanh: MathLib.isNative((<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>Math).tanh) || function (x) {
		var p;

</span></pre></div></div>
            
        </li>
        
        
        <li id="section-101">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-101">&#182;</a>
              </div>
              <p>Handle ±0 and ±∞ separately
Their values happen to coincide with sign</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (x === <span class="number">0</span> || !MathLib.isFinite(x)) {
			<span class="keyword">return</span> MathLib.sign(x);
		}

		p = Math.exp(x);
		<span class="keyword">return</span> (p * p - <span class="number">1</span>) / (p * p + <span class="number">1</span>);
	}
};</pre></div></div>
            
        </li>
        
        
        <li id="section-102">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-102">&#182;</a>
              </div>
              <p>Create the unary functions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">for</span> (<span class="keyword">var</span> elemfn <span class="keyword">in</span> unaryFunctions) {
	<span class="keyword">if</span> (unaryFunctions.hasOwnProperty(elemfn)) {
		Object.defineProperty(MathLib, elemfn, {
			value: <span class="keyword">new</span> MathLib.Functn(unaryFunctions[elemfn], {
				name: elemfn, 
				expression: <span class="keyword">new</span> MathLib.Expression({
					subtype: <span class="string">'functionDefinition'</span>,
					arguments: [
						<span class="keyword">new</span> MathLib.Expression({
							subtype: <span class="string">'variable'</span>,
							value: <span class="string">'x'</span>
						})
					],
					content: [<span class="keyword">new</span> MathLib.Expression({
							subtype: <span class="string">'functionCall'</span>,
							content: [<span class="keyword">new</span> MathLib.Expression({
									subtype: <span class="string">'variable'</span>,
									value: <span class="string">'x'</span>
								})
							],
							value: elemfn
						})
					]
				})
			}),
			writable: <span class="literal">true</span>,
			enumerable: <span class="literal">true</span>,
			configurable: <span class="literal">true</span>
		})
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-103">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-103">&#182;</a>
              </div>
              <h2 id="-a-id-screen-a-screen"><a id="Screen"></a>Screen</h2>
<p>This module contains the common methods of all drawing modules.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>export class Screen {
	type = <span class="string">'screen'</span>;

	container: any;
	figure: any;
	wrapper: any;
	contextMenu: any;
	contextMenuOverlay: any;
	height: number;
	width: number;
	origHeight: number;
	origWidth: number;
	options: any;
	renderer: any;
	element: any;
	innerHTMLContextMenu: string;</pre></div></div>
            
        </li>
        
        
        <li id="section-104">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-104">&#182;</a>
              </div>
              <p>3D</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	camera: any;


	constructor (id: string, options = {}) {

		<span class="keyword">var</span> _<span class="keyword">this</span> = <span class="keyword">this</span>,
				defaults = {
					height: <span class="number">500</span>,
					width: <span class="number">500</span>,
					contextMenu: {
						screenshot: <span class="literal">true</span>,
						fullscreen: <span class="literal">true</span>,
						grid: <span class="literal">true</span>,
					},
					figcaption: <span class="string">''</span>
				},
				opts = extendObject(defaults, options),
				container = document.getElementById(id),
				innerHTMLContextMenu = <span class="string">''</span>,
				uuid = +Date.now(),
				fullscreenchange,
				innerHTML;


		container.innerHTML = template(opts);
		container.classList.add(<span class="string">'MathLib_container'</span>);


		<span class="keyword">this</span>.height = opts.height;
		<span class="keyword">this</span>.width = opts.width;
		<span class="keyword">this</span>.options = opts;
		<span class="keyword">this</span>.container = container;
		<span class="keyword">this</span>.figure = container.getElementsByClassName(<span class="string">'MathLib_figure'</span>)[<span class="number">0</span>];
		<span class="keyword">this</span>.wrapper = container.getElementsByClassName(<span class="string">'MathLib_wrapper'</span>)[<span class="number">0</span>];
		<span class="keyword">this</span>.contextMenu = container.getElementsByClassName(<span class="string">'MathLib_mainmenu'</span>)[<span class="number">0</span>];
		<span class="keyword">this</span>.contextMenuOverlay = container.getElementsByClassName(<span class="string">'MathLib_contextMenuOverlay'</span>)[<span class="number">0</span>];
		<span class="keyword">this</span>.innerHTMLContextMenu = innerHTMLContextMenu;


		<span class="keyword">if</span> ((<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>options).contextMenu) {
			this.wrapper.oncontextmenu = (evt) =&gt; this.oncontextmenu(evt);
		
			if ((<span class="tag">&lt;<span class="title">any</span>&gt;</span>opts).contextMenu.screenshot &amp;&amp; !('opera' in window)) {
				this.contextMenu.getElementsByClassName('MathLib_screenshot')[0].onclick = function () {
					var dataURI,
							a = document.createElement('a');

					if (_this.options.renderer === 'Canvas' &amp;&amp; _this.type === 'screen2D') {
						var canvas = document.createElement('canvas'),
								ctx = (<span class="tag">&lt;<span class="title">any</span>&gt;</span>canvas).getContext('2d');

						(<span class="tag">&lt;<span class="title">any</span>&gt;</span>canvas).height = _this.height;
						(<span class="tag">&lt;<span class="title">any</span>&gt;</span>canvas).width = _this.width;

						ctx.drawImage((<span class="tag">&lt;<span class="title">any</span>&gt;</span>_this).layer.back.element, 0, 0);
						ctx.drawImage((<span class="tag">&lt;<span class="title">any</span>&gt;</span>_this).layer.grid.element, 0, 0);
						ctx.drawImage((<span class="tag">&lt;<span class="title">any</span>&gt;</span>_this).layer.axis.element, 0, 0);
						ctx.drawImage((<span class="tag">&lt;<span class="title">any</span>&gt;</span>_this).layer.main.element, 0, 0);


						dataURI = (<span class="tag">&lt;<span class="title">any</span>&gt;</span>canvas).toDataURL('image/png');
						if ('download' in a) {
							(<span class="tag">&lt;<span class="title">any</span>&gt;</span>a).href = dataURI;
							(<span class="tag">&lt;<span class="title">any</span>&gt;</span>a).download = 'plot.png';
							(<span class="tag">&lt;<span class="title">any</span>&gt;</span>a).click();
						}
						else {
							window.location.href = dataURI.replace('image/png', 'image/octet-stream');
						}
					}

					if (_this.options.renderer === 'WebGL' &amp;&amp; _this.type === 'screen3D') {
						dataURI = _this.element.toDataURL('image/png');
						if ('download' in a) {
							(<span class="tag">&lt;<span class="title">any</span>&gt;</span>a).href = dataURI;
							(<span class="tag">&lt;<span class="title">any</span>&gt;</span>a).download = 'plot.png';
							(<span class="tag">&lt;<span class="title">any</span>&gt;</span>a).click();
						}
						else {
							window.location.href = dataURI.replace('image/png', 'image/octet-stream');
						}
					}

					else if (_this.options.renderer === 'SVG') {
						dataURI = 'data:image/svg+xml,' + _this.element.parentElement.innerHTML;

						if ('download' in a) {
							(<span class="tag">&lt;<span class="title">any</span>&gt;</span>a).href = dataURI;
							(<span class="tag">&lt;<span class="title">any</span>&gt;</span>a).download = 'plot.svg';
							(<span class="tag">&lt;<span class="title">any</span>&gt;</span>a).click();
						}
						else {
							window.location.href = dataURI.replace('image/svg+xml', 'image/octet-stream');
						}
					}
				}
			}


			if ((<span class="tag">&lt;<span class="title">any</span>&gt;</span>opts).contextMenu.fullscreen &amp;&amp; 'requestFullScreen' in document.body) {
				this.contextMenu.getElementsByClassName('MathLib_fullscreen')[0].onclick = function () {
					if ((<span class="tag">&lt;<span class="title">any</span>&gt;</span>document).fullscreenElement) {
						(<span class="tag">&lt;<span class="title">any</span>&gt;</span>document).exitFullScreen();
					}
					else {
						_this.container.requestFullScreen();
					}
				};
			}

			if ((<span class="tag">&lt;<span class="title">any</span>&gt;</span>opts).contextMenu.grid) {
				this.contextMenu.getElementsByClassName('MathLib_grid_type')[0].onchange = function () {
					(<span class="tag">&lt;<span class="title">any</span>&gt;</span>_this).options.grid.type = 'cartesian';
					(<span class="tag">&lt;<span class="title">any</span>&gt;</span>_this).draw();
				}
				this.contextMenu.getElementsByClassName('MathLib_grid_type')[1].onchange = function () {
					(<span class="tag">&lt;<span class="title">any</span>&gt;</span>_this).options.grid.type = 'polar';
					(<span class="tag">&lt;<span class="title">any</span>&gt;</span>_this).draw();
				}
				this.contextMenu.getElementsByClassName('MathLib_grid_type')[2].onchange = function () {
					(<span class="tag">&lt;<span class="title">any</span>&gt;</span>_this).options.grid.type = false;
					(<span class="tag">&lt;<span class="title">any</span>&gt;</span>_this).draw();
				}
			}


		}



		fullscreenchange = function () {
			if ((<span class="tag">&lt;<span class="title">any</span>&gt;</span>document).fullscreenElement) {
				_this.origWidth = _this.width;
				_this.origHeight = _this.height;
				(<span class="tag">&lt;<span class="title">any</span>&gt;</span>_this).resize(window.outerWidth, window.outerHeight);
			}
			else {
				(<span class="tag">&lt;<span class="title">any</span>&gt;</span>_this).resize(_this.origWidth, _this.origHeight);
				delete _this.origWidth;
				delete _this.origHeight;
			}
		};

		if ('onfullscreenchange' in this.container) {
			this.container.addEventListener('fullscreenchange', fullscreenchange);
		}

</span></pre></div></div>
            
        </li>
        
        
        <li id="section-105">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-105">&#182;</a>
              </div>
              <p>The mozfullscreenchange event is not firing at all.
Therefore the screen is not resized when going fullscreen.
FIXME: are there any workarounds?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">'onmozfullscreenchange'</span> <span class="keyword">in</span> <span class="keyword">this</span>.container) {
			<span class="keyword">this</span>.container.addEventListener(<span class="string">'mozfullscreenchange'</span>, fullscreenchange);
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">'onwebkitfullscreenchange'</span> <span class="keyword">in</span> <span class="keyword">this</span>.container) {
			<span class="keyword">this</span>.container.addEventListener(<span class="string">'webkitfullscreenchange'</span>, fullscreenchange);
		}

	}</pre></div></div>
            
        </li>
        
        
        <li id="section-106">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-106">&#182;</a>
              </div>
              <h3 id="screen-prototype-contextmenu-">Screen.prototype.contextmenu()</h3>
<p>Handles the contextmenu event</p>
<p><em>@param {event}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>oncontextmenu(evt) {

	<span class="keyword">var</span> listener,
			_<span class="keyword">this</span> = <span class="keyword">this</span>,
			menu = <span class="keyword">this</span>.contextMenu,
			overlay = <span class="keyword">this</span>.contextMenuOverlay;

	<span class="keyword">if</span> (evt.preventDefault) {
	 evt.preventDefault();
	}
	evt.returnValue = <span class="literal">false</span>;


	menu.style.setProperty(<span class="string">'top'</span>, (evt.clientY - <span class="number">20</span>) + <span class="string">'px'</span>);
	menu.style.setProperty(<span class="string">'left'</span>, evt.clientX + <span class="string">'px'</span>);
	overlay.style.setProperty(<span class="string">'display'</span>, <span class="string">'block'</span>);
	


	listener = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
		overlay.style.setProperty(<span class="string">'display'</span>, <span class="string">'none'</span>);
		
		Array.prototype.forEach.call(_<span class="keyword">this</span>.contextMenu.getElementsByClassName(<span class="string">'MathLib_temporaryMenuItem'</span>),
		<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
			_<span class="keyword">this</span>.contextMenu.removeChild(x);
		});

		overlay.removeEventListener(<span class="string">'click'</span>, listener);
	};

	overlay.addEventListener(<span class="string">'click'</span>, listener);
}


}<span class="comment">// ## &lt;a id="Layers"&gt;&lt;/a&gt;Layers</span></pre></div></div>
            
        </li>
        
        
        <li id="section-107">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-107">&#182;</a>
              </div>
              <p>Layers for two dimensional plotting</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>export class Layer {


	ctx: any;
	element: any;
	id: string;
	screen: any;
	zIndex: number;
	stack: any;
	transformation: any;
	applyTransformation: any;</pre></div></div>
            
        </li>
        
        
        <li id="section-108">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-108">&#182;</a>
              </div>
              <p>Drawing functions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	draw: any;
	circle: any;
	line: any;
	path: any;
	pixel: any;
	point: any;
	text: any;


	constructor (screen, id: string, zIndex) {
		<span class="keyword">var</span> _<span class="keyword">this</span> = <span class="keyword">this</span>;
		<span class="keyword">this</span>.screen = screen;
		<span class="keyword">this</span>.id = id;
		<span class="keyword">this</span>.zIndex = zIndex;

		<span class="keyword">this</span>.stack = [];
		<span class="keyword">this</span>.transformation = screen.transformation;

		<span class="keyword">var</span> element;


		<span class="keyword">if</span> (screen.options.renderer === <span class="string">'Canvas'</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-109">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-109">&#182;</a>
              </div>
              <p>Create the canvas</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			element = document.createElement(<span class="string">'canvas'</span>);
			element.classList.add(<span class="string">'MathLib_screen'</span>);
			element.width = screen.width;
			element.height = screen.height;
			screen.wrapper.appendChild(element);
			<span class="keyword">this</span>.element = element;</pre></div></div>
            
        </li>
        
        
        <li id="section-110">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-110">&#182;</a>
              </div>
              <p>Get the context and apply the transformations</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">this</span>.ctx = element.getContext(<span class="string">'2d'</span>);
			<span class="keyword">this</span>.applyTransformation =  <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
				<span class="keyword">var</span> m = _<span class="keyword">this</span>.transformation;
				_<span class="keyword">this</span>.ctx.setTransform(m[<span class="number">0</span>][<span class="number">0</span>], m[<span class="number">1</span>][<span class="number">0</span>], m[<span class="number">0</span>][<span class="number">1</span>], m[<span class="number">1</span>][<span class="number">1</span>], m[<span class="number">0</span>][<span class="number">2</span>], m[<span class="number">1</span>][<span class="number">2</span>]);
			};
			<span class="keyword">this</span>.applyTransformation();</pre></div></div>
            
        </li>
        
        
        <li id="section-111">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-111">&#182;</a>
              </div>
              <p>Set the drawing functions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">if</span> (id === <span class="string">'back'</span>) {
				<span class="keyword">this</span>.draw = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
					<span class="keyword">var</span> top     = (              - screen.translation.y) / screen.scale.y,
							bottom  = (screen.height - screen.translation.y) / screen.scale.y,
							left    = (              - screen.translation.x) / screen.scale.x,
							right   = (screen.width  - screen.translation.x) / screen.scale.x;</pre></div></div>
            
        </li>
        
        
        <li id="section-112">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-112">&#182;</a>
              </div>
              <p>Draw the background</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="keyword">this</span>.ctx.fillStyle = colorConvert(screen.options.background);
					<span class="keyword">this</span>.ctx.fillRect(left, bottom, right - left, top - bottom);

					<span class="keyword">this</span>.stack.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
						<span class="keyword">if</span> (x.type === <span class="string">'conic'</span>) {
							x.object.draw(_<span class="keyword">this</span>, x.options, <span class="literal">true</span>);
						}
						<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'text'</span>) {
							_<span class="keyword">this</span>.text(x.object, x.x, x.y, x.options, <span class="literal">true</span>);
						}
						<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'pixel'</span>) {
							_<span class="keyword">this</span>.pixel(x.object, x.t, x.r, x.b, x.l, x.options, <span class="literal">true</span>);
						}
						<span class="keyword">else</span> {
							_<span class="keyword">this</span>[x.type](x.object, x.options, <span class="literal">true</span>);
						}
					});
				}
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (id === <span class="string">'grid'</span>) {
				<span class="keyword">this</span>.ctx.strokeStyle = colorConvert(screen.options.grid.color) || <span class="string">'#cccccc'</span>;
				<span class="keyword">this</span>.ctx.fillStyle = <span class="string">'rgba(255, 255, 255, 0)'</span>;

				
				<span class="keyword">this</span>.draw = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
					_<span class="keyword">this</span>.ctx.lineWidth = <span class="number">4</span> / (screen.scale.x - screen.scale.y);
					_<span class="keyword">this</span>.screen.drawGrid();
				}
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (id === <span class="string">'axis'</span>) {
				<span class="keyword">this</span>.ctx.strokeStyle = colorConvert(screen.options.axis.color) || <span class="string">'#000000'</span>;
				
				<span class="keyword">this</span>.draw = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
					_<span class="keyword">this</span>.ctx.lineWidth = <span class="number">4</span> / (screen.scale.x - screen.scale.y);
					_<span class="keyword">this</span>.screen.drawAxis();
				}
			}
			<span class="keyword">else</span> {
				<span class="keyword">this</span>.ctx.strokeStyle = <span class="string">'#000000'</span>;
				<span class="keyword">this</span>.ctx.fillStyle = <span class="string">'rgba(255, 255, 255, 0)'</span>;

				<span class="keyword">this</span>.draw = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
					_<span class="keyword">this</span>.ctx.lineWidth = <span class="number">4</span> / (screen.scale.x - screen.scale.y);

					<span class="keyword">this</span>.stack.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
						<span class="keyword">if</span> (x.type === <span class="string">'conic'</span> ) {
							x.object.draw(_<span class="keyword">this</span>, x.options, <span class="literal">true</span>);
						}
						<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'text'</span> ) {
							_<span class="keyword">this</span>.text(x.object, x.x, x.y, x.options, <span class="literal">true</span>);
						}
						<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'pixel'</span> ) {
							_<span class="keyword">this</span>.pixel(x.object, x.t, x.r, x.b, x.l, x.options, <span class="literal">true</span>);
						}
						<span class="keyword">else</span> {
							_<span class="keyword">this</span>[x.type](x.object, x.options, <span class="literal">true</span>);
						}
					});
				
				}
			}


			<span class="keyword">this</span>.circle = MathLib.Canvas.circle;
			<span class="keyword">this</span>.line = MathLib.Canvas.line;
			<span class="keyword">this</span>.path = MathLib.Canvas.path;
			<span class="keyword">this</span>.pixel = MathLib.Canvas.pixel;
			<span class="keyword">this</span>.point = MathLib.Canvas.point;
			<span class="keyword">this</span>.text = MathLib.Canvas.text;

		}
		<span class="keyword">else</span> <span class="keyword">if</span> (screen.options.renderer === <span class="string">'SVG'</span>) {
			<span class="keyword">var</span> ctx = document.createElementNS(<span class="string">'http://www.w3.org/2000/svg'</span>, <span class="string">'g'</span>),
					m = screen.transformation;
			ctx.setAttribute(<span class="string">'transform'</span>,
				<span class="string">'matrix('</span> + m[<span class="number">0</span>][<span class="number">0</span>] + <span class="string">', '</span> + m[<span class="number">1</span>][<span class="number">0</span>] + <span class="string">', '</span> + m[<span class="number">0</span>][<span class="number">1</span>] + <span class="string">', '</span> + m[<span class="number">1</span>][<span class="number">1</span>] + <span class="string">', '</span> + m[<span class="number">0</span>][<span class="number">2</span>] + <span class="string">', '</span> + m[<span class="number">1</span>][<span class="number">2</span>] + <span class="string">')'</span> );
			screen.element.appendChild(ctx);
			<span class="keyword">this</span>.ctx = ctx;</pre></div></div>
            
        </li>
        
        
        <li id="section-113">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-113">&#182;</a>
              </div>
              <p>Set the drawing functions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">if</span> (id === <span class="string">'back'</span>) {
				<span class="keyword">this</span>.draw = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
					<span class="keyword">this</span>.stack.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
						<span class="keyword">if</span> (x.type === <span class="string">'conic'</span>) {
							x.object.draw(_<span class="keyword">this</span>, x.options, <span class="literal">true</span>);
						}
						<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'text'</span>) {
							_<span class="keyword">this</span>.text(x.object, x.x, x.y, x.options, <span class="literal">true</span>);
						}
						<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'pixel'</span>) {
							_<span class="keyword">this</span>.pixel(x.object, x.t, x.r, x.b, x.l, x.options, <span class="literal">true</span>);
						}
						<span class="keyword">else</span> {
							_<span class="keyword">this</span>[x.type](x.object, x.options, <span class="literal">true</span>);
						}
					});
				}
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (id === <span class="string">'grid'</span>) {
				ctx.setAttribute(<span class="string">'stroke'</span>, colorConvert(screen.options.grid.color) || <span class="string">'#cccccc'</span>);

				<span class="keyword">this</span>.draw = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
					ctx.setAttribute(<span class="string">'stroke-width'</span>, <span class="number">4</span> / (screen.scale.x - screen.scale.y) + <span class="string">''</span>);
					_<span class="keyword">this</span>.screen.drawGrid();
				};

			}
			<span class="keyword">else</span> <span class="keyword">if</span> (id === <span class="string">'axis'</span>) {
				ctx.setAttribute(<span class="string">'stroke'</span>, colorConvert(screen.options.axis.color) || <span class="string">'#000000'</span>);
				
				<span class="keyword">this</span>.draw = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
					ctx.setAttribute(<span class="string">'stroke-width'</span>, <span class="number">4</span> / (screen.scale.x - screen.scale.y) + <span class="string">''</span>);
					_<span class="keyword">this</span>.screen.drawAxis();
				}
			}
			<span class="keyword">else</span> {
				<span class="keyword">this</span>.draw = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>

					<span class="keyword">this</span>.stack.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
						<span class="keyword">if</span> (x.type === <span class="string">'conic'</span> ) {
							x.object.draw(_<span class="keyword">this</span>, x.options, <span class="literal">true</span>);
						}
						<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'text'</span> ) {
							_<span class="keyword">this</span>.text(x.object, x.x, x.y, x.options, <span class="literal">true</span>);
						}
						<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'pixel'</span> ) {
							_<span class="keyword">this</span>.pixel(x.object, x.t, x.r, x.b, x.l, x.options, <span class="literal">true</span>);
						}
						<span class="keyword">else</span> {
							_<span class="keyword">this</span>[x.type](x.object, x.options, <span class="literal">true</span>);
						}
					});
				}
			}


			<span class="keyword">this</span>.circle = MathLib.SVG.circle;
			<span class="keyword">this</span>.line = MathLib.SVG.line;
			<span class="keyword">this</span>.path = MathLib.SVG.path;
			<span class="keyword">this</span>.pixel = MathLib.SVG.pixel;
			<span class="keyword">this</span>.point = MathLib.SVG.point;
			<span class="keyword">this</span>.text = MathLib.SVG.text;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-114">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-114">&#182;</a>
              </div>
              <p>Insert the layer into the layer array of the screen object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		screen.layer.splice(zIndex, <span class="number">0</span>, <span class="keyword">this</span>);
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-115">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-115">&#182;</a>
              </div>
              <h3 id="layer-prototype-clear-">Layer.prototype.clear()</h3>
<p>Clears the Layer</p>
<p><em>@return {Layer}</em> Returns the current Layer</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>clear() {
	<span class="keyword">this</span>.screen.renderer.clear(<span class="keyword">this</span>);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}


}<span class="comment">// ## Canvas</span></pre></div></div>
            
        </li>
        
        
        <li id="section-116">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-116">&#182;</a>
              </div>
              <p>The Canvas renderer for 2D plotting</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>MathLib.Canvas = {</pre></div></div>
            
        </li>
        
        
        <li id="section-117">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-117">&#182;</a>
              </div>
              <h3 id="canvas-applytransformation">Canvas.applyTransformation</h3>
<p>Applies the current transformations to the screen</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>applyTransformation: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
	<span class="keyword">var</span> m = <span class="keyword">this</span>.transformation;
	<span class="keyword">this</span>.layer.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(l)</span> {</span>l.ctx.setTransform(m[<span class="number">0</span>][<span class="number">0</span>], m[<span class="number">1</span>][<span class="number">0</span>], m[<span class="number">0</span>][<span class="number">1</span>], m[<span class="number">1</span>][<span class="number">1</span>], m[<span class="number">0</span>][<span class="number">2</span>], m[<span class="number">1</span>][<span class="number">2</span>])});
},</pre></div></div>
            
        </li>
        
        
        <li id="section-118">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-118">&#182;</a>
              </div>
              <h3 id="canvas-circle">Canvas.circle</h3>
<p>Draws a circle on the screen.</p>
<p><em>@param {Circle}</em> The circle to be drawn<br><em>@param {object}</em> [options] Optional drawing options<br><em>@return {Screen}</em> Returns the screen</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>circle: <span class="function"><span class="keyword">function</span> <span class="params">(circle, options = {}, redraw = false)</span> {</span>
	<span class="keyword">var</span> screen = <span class="keyword">this</span>.screen,
			ctx = <span class="keyword">this</span>.ctx,
			prop, opts;

	ctx.save();
	ctx.lineWidth = ((<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>options).lineWidth || 4) / (screen.scale.x - screen.scale.y);

</span></pre></div></div>
            
        </li>
        
        
        <li id="section-119">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-119">&#182;</a>
              </div>
              <p>Set the drawing options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (options) {
		opts = MathLib.Canvas.convertOptions(options);
		<span class="keyword">for</span> (prop <span class="keyword">in</span> opts) {
			<span class="keyword">if</span> (opts.hasOwnProperty(prop)) {
				ctx[prop] = opts[prop];
			}
		}

		<span class="keyword">if</span> (<span class="string">'setLineDash'</span> <span class="keyword">in</span> ctx) {
			ctx.setLineDash((<span class="string">'dash'</span> <span class="keyword">in</span> options ? (<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>options).dash : []));
		}
		if ('lineDashOffset' in ctx) {
			ctx.lineDashOffset = ('dashOffset' in options ? (<span class="tag">&lt;<span class="title">any</span>&gt;</span>options).dashOffset : 0);
		}
	}

</span></pre></div></div>
            
        </li>
        
        
        <li id="section-120">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-120">&#182;</a>
              </div>
              <p>Draw the circle</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	ctx.beginPath();
	ctx.arc(circle.center[<span class="number">0</span>], circle.center[<span class="number">1</span>], circle.radius, <span class="number">0</span>, <span class="number">2</span> * Math.PI);
	ctx.closePath();
	ctx.fill();
	ctx.stroke();
	ctx.restore();

	<span class="keyword">if</span> (!redraw) {
		<span class="keyword">this</span>.stack.push({
			type: <span class="string">'circle'</span>,
			object: circle,
			options: options
		});
	}

	<span class="keyword">return</span> <span class="keyword">this</span>;
},</pre></div></div>
            
        </li>
        
        
        <li id="section-121">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-121">&#182;</a>
              </div>
              <h3 id="canvas-clear">Canvas.clear</h3>
<p>Clears a given Layer.</p>
<p><em>@param {Layer}</em> The layer to be cleared</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>clear: <span class="function"><span class="keyword">function</span> <span class="params">(layer)</span> {</span>
	<span class="keyword">var</span> screen = layer.screen,
			left   = -screen.translation.x / screen.scale.x,
			top    = -screen.translation.y / screen.scale.y,
			width  =  screen.width         / screen.scale.x,
			height =  screen.height        / screen.scale.y;

	layer.ctx.clearRect(left, top, width, height);
},</pre></div></div>
            
        </li>
        
        
        <li id="section-122">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-122">&#182;</a>
              </div>
              <h3 id="canvas-convertoptions">Canvas.convertOptions</h3>
<p>Converts the options to the Canvas options format</p>
<p><em>@param {object}</em> The drawing options<br><em>@return {object}</em> The converted options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>convertOptions: <span class="function"><span class="keyword">function</span> <span class="params">(opt)</span> {</span>
	<span class="keyword">var</span> convertedOptions : any = {};
	<span class="keyword">if</span> (<span class="string">'fillColor'</span> <span class="keyword">in</span> opt) {
		convertedOptions.fillStyle = colorConvert(opt.fillColor);
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">'color'</span> <span class="keyword">in</span> opt) {
		convertedOptions.fillStyle = colorConvert(opt.color);
	}


	<span class="keyword">if</span> (<span class="string">'font'</span> <span class="keyword">in</span> opt) {
		convertedOptions[<span class="string">'font-family'</span>] = opt.font;
	}

	<span class="keyword">if</span> (<span class="string">'fontSize'</span> <span class="keyword">in</span> opt) {
		convertedOptions[<span class="string">'font-size'</span>] = opt.fontSize;
	}


	<span class="keyword">if</span> (<span class="string">'lineColor'</span> <span class="keyword">in</span> opt) {
		convertedOptions.strokeStyle = colorConvert(opt.lineColor);
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">'color'</span> <span class="keyword">in</span> opt) {
		convertedOptions.strokeStyle = colorConvert(opt.color);
	}

	<span class="keyword">return</span> convertedOptions;
},</pre></div></div>
            
        </li>
        
        
        <li id="section-123">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-123">&#182;</a>
              </div>
              <h3 id="canvas-line">Canvas.line</h3>
<p>Draws a line on the screen.</p>
<p><em>@param {Line}</em> The line to be drawn<br><em>@param {object}</em> [options] Optional drawing options<br><em>@return {Screen}</em> Returns the screen</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>line: <span class="function"><span class="keyword">function</span> <span class="params">(line, options = {}, redraw = false)</span> {</span>
	<span class="keyword">var</span> screen = <span class="keyword">this</span>.screen,
			points = <span class="keyword">this</span>.screen.getLineEndPoints(line),
			ctx = <span class="keyword">this</span>.ctx,
			prop, opts;

	ctx.save()
	ctx.lineWidth = ((<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>options).lineWidth || 4) / (screen.scale.x - screen.scale.y);


</span></pre></div></div>
            
        </li>
        
        
        <li id="section-124">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-124">&#182;</a>
              </div>
              <p>Set the drawing options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (options) {
		opts = MathLib.Canvas.convertOptions(options);
		<span class="keyword">for</span> (prop <span class="keyword">in</span> opts) {
			<span class="keyword">if</span> (opts.hasOwnProperty(prop)) {
				ctx[prop] = opts[prop];
			}
		}

		<span class="keyword">if</span> (<span class="string">'setLineDash'</span> <span class="keyword">in</span> ctx) {
			ctx.setLineDash((<span class="string">'dash'</span> <span class="keyword">in</span> options ? (<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>options).dash : []));
		}
		if ('lineDashOffset' in ctx) {
			ctx.lineDashOffset = ('dashOffset' in options ? (<span class="tag">&lt;<span class="title">any</span>&gt;</span>options).dashOffset : 0);
		}
	}


</span></pre></div></div>
            
        </li>
        
        
        <li id="section-125">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-125">&#182;</a>
              </div>
              <p>Draw the line</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	ctx.beginPath();
	ctx.moveTo(points[<span class="number">0</span>][<span class="number">0</span>], points[<span class="number">0</span>][<span class="number">1</span>]);
	ctx.lineTo(points[<span class="number">1</span>][<span class="number">0</span>], points[<span class="number">1</span>][<span class="number">1</span>]);
	ctx.stroke();
	ctx.closePath();
	ctx.restore();

	<span class="keyword">if</span> (!redraw) {
		<span class="keyword">this</span>.stack.push({
			type: <span class="string">'line'</span>,
			object: line,
			options: options
		});
	}

	<span class="keyword">return</span> <span class="keyword">this</span>;
},</pre></div></div>
            
        </li>
        
        
        <li id="section-126">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-126">&#182;</a>
              </div>
              <h3 id="canvas-path">Canvas.path</h3>
<p>Draws a path on the screen.</p>
<p><em>@param {Path}</em> The path to be drawn<br><em>@param {object}</em> [options] Optional drawing options<br><em>@return {Screen}</em> Returns the scren</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>path: <span class="function"><span class="keyword">function</span> <span class="params">(curve, options = {}, redraw = false)</span> {</span>
	<span class="keyword">var</span> screen = <span class="keyword">this</span>.screen,
			ctx = <span class="keyword">this</span>.ctx,
			prop, opts, path, x, y, i,
			step = <span class="number">2</span> / (screen.scale.x - screen.scale.y),
			from, to;


	from = (<span class="string">'from'</span> <span class="keyword">in</span> options ? (<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>options).from : ( - screen.translation.x) / screen.scale.x) - step;
	to = ('to' in options ? (<span class="tag">&lt;<span class="title">any</span>&gt;</span>options).to : (screen.width  - screen.translation.x) / screen.scale.x) + step;

	ctx.save()
	ctx.lineWidth = ((<span class="tag">&lt;<span class="title">any</span>&gt;</span>options).lineWidth || 4) / (screen.scale.x - screen.scale.y);


</span></pre></div></div>
            
        </li>
        
        
        <li id="section-127">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-127">&#182;</a>
              </div>
              <p>Set the drawing options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (options) {
		opts = MathLib.Canvas.convertOptions(options);
		<span class="keyword">for</span> (prop <span class="keyword">in</span> opts) {
			<span class="keyword">if</span> (opts.hasOwnProperty(prop)) {
				ctx[prop] = opts[prop];
			}
		}

		<span class="keyword">if</span> (<span class="string">'setLineDash'</span> <span class="keyword">in</span> ctx) {
			ctx.setLineDash((<span class="string">'dash'</span> <span class="keyword">in</span> options ? (<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>options).dash : []));
		}
		if ('lineDashOffset' in ctx) {
			ctx.lineDashOffset = ('dashOffset' in options ? (<span class="tag">&lt;<span class="title">any</span>&gt;</span>options).dashOffset : 0);
		}
	}


</span></pre></div></div>
            
        </li>
        
        
        <li id="section-128">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-128">&#182;</a>
              </div>
              <p>If curve is a function f, the path will be (x, f(x))</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (<span class="keyword">typeof</span> curve === <span class="string">'function'</span>) {
		path = [];
		<span class="keyword">for</span> (i = from; i &lt;= to; i += step) {
			path.push([i, curve(i)]);
		}
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-129">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-129">&#182;</a>
              </div>
              <p>If curve is an array of two functions [f, g], the path will be (f(x), g(x))</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> curve[<span class="number">0</span>] === <span class="string">'function'</span>) {
		path = [];
		x = curve[<span class="number">0</span>];
		y = curve[<span class="number">1</span>];
		<span class="keyword">for</span> (i = from; i &lt;= to; i += step) {
			path.push([x(i), y(i)]);
		}
	}
	<span class="keyword">else</span> {
		path = curve;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-130">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-130">&#182;</a>
              </div>
              <p>Draw the path</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	ctx.beginPath();
	ctx.moveTo(path[<span class="number">0</span>][<span class="number">0</span>], path[<span class="number">0</span>][<span class="number">1</span>]);
	path.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		ctx.lineTo(x[<span class="number">0</span>], x[<span class="number">1</span>]);
	});
	ctx.stroke();
	ctx.closePath();
	ctx.restore();


	<span class="keyword">if</span> (!redraw) {
		<span class="keyword">if</span> (options.conic) {
			<span class="keyword">this</span>.stack.push({
				type: <span class="string">'conic'</span>,
				object: options.conic,
				options: options
			});
		}
		<span class="keyword">else</span> {
			<span class="keyword">this</span>.stack.push({
				type: <span class="string">'path'</span>,
				object: curve,
				options: options
			});
		}
	}

	<span class="keyword">return</span> <span class="keyword">this</span>;
},</pre></div></div>
            
        </li>
        
        
        <li id="section-131">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-131">&#182;</a>
              </div>
              <h3 id="canvas-pixel">Canvas.pixel</h3>
<p>Draws pixel on the screen.</p>
<p><em>@param {function}</em> The pixel function<br><em>@param {number}</em> The top coordinate of the draw rectangle<br><em>@param {number}</em> The right coordinate of the draw rectangle<br><em>@param {number}</em> The bottom coordinate of the draw rectangle<br><em>@param {number}</em> The left coordinate of the draw rectangle<br><em>@param {object}</em> [options] Optional drawing options<br><em>@return {Screen}</em> Returns the screen</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>pixel: <span class="function"><span class="keyword">function</span> <span class="params">(f, t, r, b, l, options = {}, redraw = false)</span> {</span>
	<span class="keyword">var</span> screen = <span class="keyword">this</span>.screen,
			top     = (              - screen.translation.y) / screen.scale.y,
			bottom  = (screen.height - screen.translation.y) / screen.scale.y,
			left    = (              - screen.translation.x) / screen.scale.x,
			right   = (screen.width  - screen.translation.x) / screen.scale.x,
			ctx = <span class="keyword">this</span>.ctx,
			x, y, i;

	t = Math.min(top, t);
	r = Math.min(right, r);
	b = Math.max(bottom, b);
	l = Math.max(left, l);


	<span class="keyword">var</span> tPxl = Math.floor(-t * screen.scale.y),
			rPxl = Math.floor( r * screen.scale.x),
			bPxl = Math.floor(-b * screen.scale.y),
			lPxl = Math.floor( l * screen.scale.x),
			w = (rPxl - lPxl),
			h = (bPxl - tPxl),
			imgData = ctx.createImageData(w, h),
			pxl;


	<span class="keyword">for</span> (y = tPxl, i = <span class="number">0</span>; y &gt; bPxl; y--) {
		<span class="keyword">for</span> (x = lPxl; x &lt; rPxl; x++, i++) {
			pxl = f(x / screen.scale.x, y / screen.scale.y);
			imgData.data[<span class="number">4</span> * i]     = pxl[<span class="number">0</span>];
			imgData.data[<span class="number">4</span> * i + <span class="number">1</span>] = pxl[<span class="number">1</span>];
			imgData.data[<span class="number">4</span> * i + <span class="number">2</span>] = pxl[<span class="number">2</span>];
			imgData.data[<span class="number">4</span> * i + <span class="number">3</span>] = pxl[<span class="number">3</span>];
		}
	}

	ctx.putImageData(imgData, (left - l) * screen.scale.x, (t - top) * screen.scale.y);


	<span class="keyword">if</span> (!redraw) {
		<span class="keyword">this</span>.stack.push({
			type: <span class="string">'pixel'</span>,
			object: f,
			t: t,
			r: r,
			b: b,
			l: l,
			options: options
		});
	}

	<span class="keyword">return</span> <span class="keyword">this</span>;
},</pre></div></div>
            
        </li>
        
        
        <li id="section-132">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-132">&#182;</a>
              </div>
              <h3 id="canvas-point">Canvas.point</h3>
<p>Draws a point on the screen.</p>
<p><em>@param {Point}</em> The point to be drawn<br><em>@param {object}</em> [options] Optional drawing options<br><em>@return {Screen}</em> Returns the screen</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>point: <span class="function"><span class="keyword">function</span> <span class="params">(point, options = {}, redraw = false)</span> {</span>
	<span class="keyword">var</span> screen = <span class="keyword">this</span>.screen,
			ctx = <span class="keyword">this</span>.ctx,
			prop, opts, dist;

	ctx.save();
	ctx.lineWidth = ((<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>options).lineWidth || 4) / (screen.scale.x - screen.scale.y);

</span></pre></div></div>
            
        </li>
        
        
        <li id="section-133">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-133">&#182;</a>
              </div>
              <p>Set the drawing options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (options) {
		opts = MathLib.Canvas.convertOptions(options);

		<span class="keyword">if</span> (!(<span class="string">'fillColor'</span> <span class="keyword">in</span> options) &amp;&amp; !(<span class="string">'color'</span> <span class="keyword">in</span> options)) {
			opts.fillStyle = <span class="string">'black'</span>;
		}

		<span class="keyword">for</span> (prop <span class="keyword">in</span> opts) {
			<span class="keyword">if</span> (opts.hasOwnProperty(prop)) {
				ctx[prop] = opts[prop];
			}
		}

		<span class="keyword">if</span> (<span class="string">'setLineDash'</span> <span class="keyword">in</span> ctx) {
			ctx.setLineDash((<span class="string">'dash'</span> <span class="keyword">in</span> options ? (<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>options).dash : []));
		}
		if ('lineDashOffset' in ctx) {
			ctx.lineDashOffset = ('dashOffset' in options ? (<span class="tag">&lt;<span class="title">any</span>&gt;</span>options).dashOffset : 0);
		}
	}


</span></pre></div></div>
            
        </li>
        
        
        <li id="section-134">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-134">&#182;</a>
              </div>
              <p>Draw the point</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	ctx.beginPath();
	ctx.arc(point[<span class="number">0</span>] / point[<span class="number">2</span>], point[<span class="number">1</span>] / point[<span class="number">2</span>], ((<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>options).size || 10) / (screen.scale.x - screen.scale.y), 0, 2 * Math.PI);
	ctx.closePath();
	ctx.fill();
	ctx.stroke();
	ctx.restore();


	if ((<span class="tag">&lt;<span class="title">any</span>&gt;</span>options).label) {
		dist = 1.75 * ((<span class="tag">&lt;<span class="title">any</span>&gt;</span>options).size || 10) + 0.75 * ((<span class="tag">&lt;<span class="title">any</span>&gt;</span>options).lineWidth || 4);
		screen.text((<span class="tag">&lt;<span class="title">any</span>&gt;</span>options).label,
			point[0] / point[2] + dist / (screen.scale.x - screen.scale.y),
			point[1] / point[2] + dist / (screen.scale.x - screen.scale.y), {}, true);
	}


	if (!redraw) {
		this.stack.push({
			type: 'point',
			object: point,
			options: options
		});
	}

	return this;
},


</span></pre></div></div>
            
        </li>
        
        
        <li id="section-135">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-135">&#182;</a>
              </div>
              <h3 id="canvas-text">Canvas.text</h3>
<p>Writes text on the screen.</p>
<p><em>@param {str}</em> The string to be drawn<br><em>@param {x}</em> The x coordinate<br><em>@param {y}</em> The y coordinate<br><em>@param {object}</em> [options] Optional drawing options<br><em>@return {Screen}</em> Returns the screen</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>text: <span class="function"><span class="keyword">function</span> <span class="params">(str, x, y, options = {}, redraw = false)</span> {</span>
	<span class="keyword">var</span> defaults = {
				font:       <span class="string">'Helvetica'</span>,
				fontSize:   <span class="number">10</span>,
				fillColor:  <span class="string">'rgba(0, 0, 0, 1)'</span>,
				lineColor:  <span class="string">'rgba(0, 0, 0, 1)'</span>,
				lineWidth:  <span class="number">0.05</span>
			},
			ctx, prop, opts;</pre></div></div>
            
        </li>
        
        
        <li id="section-136">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-136">&#182;</a>
              </div>
              <p>Determine the layer to draw onto</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	ctx = <span class="keyword">this</span>.ctx;

	opts = MathLib.Canvas.convertOptions(extendObject(defaults, options));</pre></div></div>
            
        </li>
        
        
        <li id="section-137">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-137">&#182;</a>
              </div>
              <p>Set the drawing options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">for</span> (prop <span class="keyword">in</span> opts) {
		<span class="keyword">if</span> (opts.hasOwnProperty(prop)) {
			ctx[prop] = opts[prop];
		}
	}

	ctx.font = <span class="string">'10px Helvetica'</span>;
	ctx.textAlign = <span class="string">'center'</span>;
	ctx.textBaseline = <span class="string">'middle'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-138">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-138">&#182;</a>
              </div>
              <p>Draw the text</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">var</span> tf = <span class="keyword">this</span>.screen.transformation;

	ctx.save();
		ctx.transform(<span class="number">1</span> / tf[<span class="number">0</span>][<span class="number">0</span>], <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> / tf[<span class="number">1</span>][<span class="number">1</span>], <span class="number">0</span>, <span class="number">0</span>);
		ctx.fillText(str, tf[<span class="number">0</span>][<span class="number">0</span>] * x, tf[<span class="number">1</span>][<span class="number">1</span>] * y);
	ctx.restore();


	<span class="keyword">if</span> (!redraw) {
		<span class="keyword">this</span>.stack.push({
			type: <span class="string">'text'</span>,
			object: str,
			x: x,
			y: y,
			options: options
		});
	}

	<span class="keyword">return</span> <span class="keyword">this</span>;
},


}<span class="comment">// ## SVG</span></pre></div></div>
            
        </li>
        
        
        <li id="section-139">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-139">&#182;</a>
              </div>
              <p>The SVG renderer for 2D plotting</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>MathLib.SVG = {</pre></div></div>
            
        </li>
        
        
        <li id="section-140">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-140">&#182;</a>
              </div>
              <h3 id="svg-applytransformation">SVG.applyTransformation</h3>
<p>Applies the current transformations to the screen</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>applyTransformation: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
	<span class="keyword">var</span> m = <span class="keyword">this</span>.transformation;
	<span class="keyword">this</span>.layer.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(l)</span> {</span>
		l.ctx.setAttribute(<span class="string">'transform'</span>,
			<span class="string">'matrix('</span> + m[<span class="number">0</span>][<span class="number">0</span>] + <span class="string">', '</span> + m[<span class="number">1</span>][<span class="number">0</span>] + <span class="string">', '</span> + m[<span class="number">0</span>][<span class="number">1</span>] + <span class="string">', '</span> + m[<span class="number">1</span>][<span class="number">1</span>] + <span class="string">', '</span> + m[<span class="number">0</span>][<span class="number">2</span>] + <span class="string">', '</span> + m[<span class="number">1</span>][<span class="number">2</span>] + <span class="string">')'</span> )});
},</pre></div></div>
            
        </li>
        
        
        <li id="section-141">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-141">&#182;</a>
              </div>
              <h3 id="svg-circle">SVG circle</h3>
<p>Draws a circle on the screen.</p>
<p><em>@param {Circle}</em> The circle to be drawn<br><em>@param {object}</em> [options] Optional drawing options<br><em>@return {Screen}</em> Returns the screen</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>circle: <span class="function"><span class="keyword">function</span> <span class="params">(circle, options = {}, redraw = false)</span> {</span>
	<span class="keyword">var</span> screen = <span class="keyword">this</span>.screen,
			prop, opts,
			svgCircle = document.createElementNS(<span class="string">'http://www.w3.org/2000/svg'</span>, <span class="string">'circle'</span>);

	svgCircle.setAttribute(<span class="string">'cx'</span>, circle.center[<span class="number">0</span>]);
	svgCircle.setAttribute(<span class="string">'cy'</span>, circle.center[<span class="number">1</span>]);
	svgCircle.setAttribute(<span class="string">'r'</span>, circle.radius);

	<span class="keyword">if</span> (options) {
		svgCircle.setAttribute(<span class="string">'stroke-width'</span>, ((<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>options).lineWidth || 4 ) / (screen.scale.x - screen.scale.y) + '');
		opts = MathLib.SVG.convertOptions(options);
		for (prop in opts) {
			if (opts.hasOwnProperty(prop)) {
				svgCircle.setAttribute(prop, opts[prop]);
			}
		}
	}

	this.ctx.appendChild(svgCircle)

	if (!redraw) {
		this.stack.push({
			type: 'circle',
			object: circle,
			options: options
		});
	}

	return this;
},


</span></pre></div></div>
            
        </li>
        
        
        <li id="section-142">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-142">&#182;</a>
              </div>
              <h3 id="svg-clear">SVG.clear</h3>
<p>Clears a given Layer.</p>
<p><em>@param {Layer}</em> The layer to be cleared  </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>clear: <span class="function"><span class="keyword">function</span> <span class="params">(layer)</span> {</span>
	layer.ctx.textContent = <span class="string">''</span>;
},</pre></div></div>
            
        </li>
        
        
        <li id="section-143">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-143">&#182;</a>
              </div>
              <h3 id="svg-convertoptions">SVG.convertOptions</h3>
<p>Converts the options to the SVG options format</p>
<p><em>@param {object}</em> The drawing options<br><em>@return {object}</em> The converted options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>convertOptions: <span class="function"><span class="keyword">function</span> <span class="params">(opt)</span> {</span>
	<span class="keyword">var</span> convertedOptions : any = {};
	<span class="keyword">if</span> (<span class="string">'fillColor'</span> <span class="keyword">in</span> opt) {
		convertedOptions.fill = colorConvert(opt.fillColor);
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">'color'</span> <span class="keyword">in</span> opt) {
		convertedOptions.fill = colorConvert(opt.color);
	}


	<span class="keyword">if</span> (<span class="string">'font'</span> <span class="keyword">in</span> opt) {
		convertedOptions[<span class="string">'font-family'</span>] = opt.font;
	}

	<span class="keyword">if</span> (<span class="string">'fontSize'</span> <span class="keyword">in</span> opt) {
		convertedOptions[<span class="string">'font-size'</span>] = opt.fontSize;
	}

	<span class="keyword">if</span> (<span class="string">'size'</span> <span class="keyword">in</span> opt) {
		convertedOptions.size = opt.size;
	}


	<span class="keyword">if</span> (<span class="string">'lineColor'</span> <span class="keyword">in</span> opt) {
		convertedOptions.stroke = colorConvert(opt.lineColor);
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">'color'</span> <span class="keyword">in</span> opt) {
		convertedOptions.stroke = colorConvert(opt.color);
	}


	<span class="keyword">if</span> (<span class="string">'dash'</span> <span class="keyword">in</span> opt &amp;&amp; opt.dash.length !== <span class="number">0</span>) {
		convertedOptions[<span class="string">'stroke-dasharray'</span>] = opt.dash;
	}

	<span class="keyword">if</span> (<span class="string">'dashOffset'</span> <span class="keyword">in</span> opt &amp;&amp; opt.dashOffset !== <span class="number">0</span>) {
		convertedOptions[<span class="string">'stroke-dashoffset'</span>] = opt.dashOffset;
	}


	<span class="keyword">return</span> convertedOptions;
},</pre></div></div>
            
        </li>
        
        
        <li id="section-144">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-144">&#182;</a>
              </div>
              <h3 id="svg-line">SVG line</h3>
<p>Draws a line on the screen.</p>
<p><em>@param {Line}</em> The line to be drawn<br><em>@param {object}</em> [options] Optional drawing options<br><em>@return {Canvas}</em> Returns the screen</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>line: <span class="function"><span class="keyword">function</span> <span class="params">(line, options = {}, redraw = false)</span> {</span>
	<span class="keyword">var</span> screen = <span class="keyword">this</span>.screen,
			points = <span class="keyword">this</span>.screen.getLineEndPoints(line),
			prop, opts,
			svgLine = document.createElementNS(<span class="string">'http://www.w3.org/2000/svg'</span>, <span class="string">'line'</span>);

	svgLine.setAttribute(<span class="string">'x1'</span>, points[<span class="number">0</span>][<span class="number">0</span>]);
	svgLine.setAttribute(<span class="string">'y1'</span>, points[<span class="number">0</span>][<span class="number">1</span>]);
	svgLine.setAttribute(<span class="string">'x2'</span>, points[<span class="number">1</span>][<span class="number">0</span>]);
	svgLine.setAttribute(<span class="string">'y2'</span>, points[<span class="number">1</span>][<span class="number">1</span>]);

	<span class="keyword">if</span> (options) {
		svgLine.setAttribute(<span class="string">'stroke-width'</span>, ((<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>options).lineWidth || 4 ) / (screen.scale.x - screen.scale.y) + '');
		opts = MathLib.SVG.convertOptions(options);
		for (prop in opts) {
			if (opts.hasOwnProperty(prop)) {
				svgLine.setAttribute(prop, opts[prop]);
			}
		}
	}

	this.ctx.appendChild(svgLine);
	
	if (!redraw) {
		this.stack.push({
			type: 'line',
			object: line,
			options: options
		});
	}

	return this;
},


</span></pre></div></div>
            
        </li>
        
        
        <li id="section-145">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-145">&#182;</a>
              </div>
              <h3 id="svg-path">SVG path</h3>
<p>Draws a path on the screen.</p>
<p><em>@param {curve}</em> The path to be drawn<br><em>@param {object}</em> [options] Optional drawing options<br><em>@return {Screen}</em> Returns the screen</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>path: <span class="function"><span class="keyword">function</span> <span class="params">(curve, options = {}, redraw = false)</span> {</span>
	<span class="keyword">var</span> screen = <span class="keyword">this</span>.screen,
			svgPath = document.createElementNS(<span class="string">'http://www.w3.org/2000/svg'</span>, <span class="string">'path'</span>),
			step = <span class="number">2</span> / (screen.scale.x - screen.scale.y),
			pathString, from, to, prop, opts, x, y, i, path;

	from = (<span class="string">'from'</span> <span class="keyword">in</span> options ? (<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>options).from :         - screen.translation.x  / screen.scale.x) - step;
	to = ('to' in options ? (<span class="tag">&lt;<span class="title">any</span>&gt;</span>options).to : (screen.width - screen.translation.x) / screen.scale.x) + step;


</span></pre></div></div>
            
        </li>
        
        
        <li id="section-146">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-146">&#182;</a>
              </div>
              <p>If curve is a function f, the path will be (x, f(x))</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (<span class="keyword">typeof</span> curve === <span class="string">'function'</span>) {
		path = [];
		<span class="keyword">for</span> (i = from; i &lt;= to; i += step) {
			path.push([i, curve(i)]);
		}
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-147">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-147">&#182;</a>
              </div>
              <p>If curve is an array of two functions [f, g], the path will be (f(x), g(x))</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> curve[<span class="number">0</span>] === <span class="string">'function'</span>) {
		path = [];
		x = curve[<span class="number">0</span>];
		y = curve[<span class="number">1</span>];
		<span class="keyword">for</span> (i = from; i &lt;= to; i += step) {
			path.push([x(i), y(i)]);
		}
	}
	<span class="keyword">else</span> {
		path = curve;
	}

	pathString = <span class="string">'M'</span> + path.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(prev, cur)</span> {</span>
		<span class="keyword">return</span> prev + <span class="string">' L'</span> + cur.join(<span class="string">' '</span>);
	});
	svgPath.setAttribute(<span class="string">'d'</span>, pathString);

	svgPath.setAttribute(<span class="string">'stroke-width'</span>, ((<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>options).lineWidth || 4 ) / (screen.scale.x - screen.scale.y) + '');


	if (options) {
		opts = MathLib.SVG.convertOptions(options);
		for (prop in opts) {
			if (opts.hasOwnProperty(prop)) {
				svgPath.setAttribute(prop, opts[prop]);
			}
		}
	}

	this.ctx.appendChild(svgPath);

	if (!redraw) {
		if (options.conic) {
			this.stack.push({
				type: 'conic',
				object: options.conic,
				options: options
			});
		}
		else {
			this.stack.push({
				type: 'path',
				object: curve,
				options: options
			});
		}
	}

	return this;
},


</span></pre></div></div>
            
        </li>
        
        
        <li id="section-148">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-148">&#182;</a>
              </div>
              <h3 id="svg-pixel">SVG pixel</h3>
<p>Draws pixel on the screen.</p>
<p><em>@param {function}</em> The pixel function<br><em>@param {number}</em> The top coordinate of the draw rectangle<br><em>@param {number}</em> The right coordinate of the draw rectangle<br><em>@param {number}</em> The bottom coordinate of the draw rectangle<br><em>@param {number}</em> The left coordinate of the draw rectangle<br><em>@param {object}</em> [options] Optional drawing options<br><em>@return {Screen}</em> Returns the screen</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>pixel: <span class="function"><span class="keyword">function</span> <span class="params">(f, t, r, b, l, options = {}, redraw = false)</span> {</span>
	<span class="keyword">var</span> screen = <span class="keyword">this</span>.screen,
			top     = (              - screen.translation.y) / screen.scale.y,
			bottom  = (screen.height - screen.translation.y) / screen.scale.y,
			left    = (              - screen.translation.x) / screen.scale.x,
			right   = (screen.width  - screen.translation.x) / screen.scale.x,
			canvas = <span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>document.createElement('canvas'),
			canvasCtx = canvas.getContext('2d'),
			svgImage = document.createElementNS('http://www.w3.org/2000/svg', 'image'),
			svgContainer = document.createElementNS('http://www.w3.org/2000/svg', 'g'),
			x, y, i, pxl,
			m = screen.transformation;

	canvas.width = screen.width;
	canvas.height = screen.height;
	canvasCtx.setTransform(m[0][0], m[1][0], m[0][1], m[1][1], m[0][2], m[1][2])



	svgContainer.setAttribute('transform', 'matrix(' + 1 / m[0][0] + ', 0, 0, ' + 1 / m[1][1] + ', -' + m[0][2] / m[0][0] + ', ' + -m[1][2] / m[1][1] + ')');
	svgImage.setAttribute('width', screen.width + 'px');
	svgImage.setAttribute('height', screen.height + 'px');
	svgImage.setAttribute('x', '0');
	svgImage.setAttribute('y', '0');



	t = Math.min(top, t);
	r = Math.min(right, r);
	b = Math.max(bottom, b);
	l = Math.max(left, l);


	var tPxl = Math.floor(-t * screen.scale.y),
			rPxl = Math.floor(r * screen.scale.x),
			bPxl = Math.floor(-b * screen.scale.y),
			lPxl = Math.floor(l * screen.scale.x),
			w = (rPxl - lPxl),
			h = (tPxl - bPxl),
			imgData = canvasCtx.createImageData(w, h);



	for (y = tPxl, i = 0; y &gt; bPxl; y--) {
		for (x = lPxl; x <span class="tag">&lt; <span class="attribute">rPxl</span>; <span class="attribute">x</span>++, <span class="attribute">i</span>++) {
			<span class="attribute">pxl</span> = <span class="attribute">f</span>(<span class="attribute">x</span> / <span class="attribute">screen.scale.x</span>, <span class="attribute">y</span> / <span class="attribute">screen.scale.y</span>);
			<span class="attribute">imgData.data</span>[<span class="attribute">4</span> * <span class="attribute">i</span>]     = <span class="attribute">pxl</span>[<span class="attribute">0</span>];
			<span class="attribute">imgData.data</span>[<span class="attribute">4</span> * <span class="attribute">i</span> + <span class="attribute">1</span>] = <span class="attribute">pxl</span>[<span class="attribute">1</span>];
			<span class="attribute">imgData.data</span>[<span class="attribute">4</span> * <span class="attribute">i</span> + <span class="attribute">2</span>] = <span class="attribute">pxl</span>[<span class="attribute">2</span>];
			<span class="attribute">imgData.data</span>[<span class="attribute">4</span> * <span class="attribute">i</span> + <span class="attribute">3</span>] = <span class="attribute">pxl</span>[<span class="attribute">3</span>];
		}
	}

	<span class="attribute">canvasCtx.putImageData</span>(<span class="attribute">imgData</span>, <span class="attribute">0</span>, <span class="attribute">0</span>);

	<span class="attribute">svgImage.setAttributeNS</span>('<span class="attribute">http:</span>//<span class="attribute">www.w3.org</span>/<span class="attribute">1999</span>/<span class="attribute">xlink</span>', '<span class="attribute">xlink:href</span>', <span class="attribute">canvas.toDataURL</span>());

	<span class="attribute">svgContainer.appendChild</span>(<span class="attribute">svgImage</span>);
	<span class="attribute">this.ctx.appendChild</span>(<span class="attribute">svgContainer</span>);

	<span class="attribute">if</span> (!<span class="attribute">redraw</span>) {
		<span class="attribute">this.stack.push</span>({
			<span class="attribute">type:</span> '<span class="attribute">pixel</span>',
			<span class="attribute">object:</span> <span class="attribute">f</span>,
			<span class="attribute">t:</span> <span class="attribute">t</span>,
			<span class="attribute">r:</span> <span class="attribute">r</span>,
			<span class="attribute">b:</span> <span class="attribute">b</span>,
			<span class="attribute">l:</span> <span class="attribute">l</span>,
			<span class="attribute">options:</span> <span class="attribute">options</span>
		});
	}

	<span class="attribute">return</span> <span class="attribute">this</span>;
},


</span></pre></div></div>
            
        </li>
        
        
        <li id="section-149">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-149">&#182;</a>
              </div>
              <h3 id="svg-point">SVG point</h3>
<p>Draws a point on the screen.</p>
<p><em>@param {Point}</em> The point to be drawn<br><em>@param {object}</em> [options] Optional drawing options<br><em>@return {Screen}</em> Returns the screen</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>point: <span class="function"><span class="keyword">function</span> <span class="params">(point, options = {}, redraw = false)</span> {</span>
	<span class="keyword">var</span> screen = <span class="keyword">this</span>.screen,
			prop, opts, dist,
			svgPoint = document.createElementNS(<span class="string">'http://www.w3.org/2000/svg'</span>, <span class="string">'circle'</span>);

	svgPoint.setAttribute(<span class="string">'cx'</span>, point[<span class="number">0</span>] / point[<span class="number">2</span>] + <span class="string">''</span>);
	svgPoint.setAttribute(<span class="string">'cy'</span>, point[<span class="number">1</span>] / point[<span class="number">2</span>] + <span class="string">''</span>);
	svgPoint.setAttribute(<span class="string">'r'</span>, ((<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>options).size || 10) / (screen.scale.x - screen.scale.y) + '');


	if (options) {
		svgPoint.setAttribute('stroke-width', ((<span class="tag">&lt;<span class="title">any</span>&gt;</span>options).lineWidth || 4) / (screen.scale.x - screen.scale.y) + '');
		opts = MathLib.SVG.convertOptions(options);

		if (!('fillOpacity' in options)) {
			opts['fill-opacity'] = '1';
		}

		if (!('fillColor' in options) &amp;&amp; !('color' in options)) {
			opts.fill = 'black';
		}

		for (prop in opts) {
			if (opts.hasOwnProperty(prop)) {
				svgPoint.setAttribute(prop, opts[prop]);
			}
		}
	}


	if ((<span class="tag">&lt;<span class="title">any</span>&gt;</span>options).moveable) {
		svgPoint.setAttribute('cursor', 'move');

</span></pre></div></div>
            
        </li>
        
        
        <li id="section-150">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-150">&#182;</a>
              </div>
              <p>mousedown</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		svgPoint.addEventListener(<span class="string">'mousedown'</span>,
			<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
				screen.options.interaction.type = <span class="string">'move'</span>;
				<span class="keyword">var</span> invTransformation = screen.transformation.inverse();

				<span class="keyword">var</span> move = <span class="function"><span class="keyword">function</span> <span class="params">(evt)</span> {</span>
							evt.stopPropagation();

							<span class="keyword">var</span> evtPoint = invTransformation.times(screen.getEventPoint(evt));
							point[<span class="number">0</span>] = evtPoint[<span class="number">0</span>];
							point[<span class="number">1</span>] = evtPoint[<span class="number">1</span>];
							screen.draw();
						},

						up = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
							screen.options.interaction.type = <span class="string">''</span>;

							document.body.removeEventListener(<span class="string">'mousemove'</span>, move);
							document.body.removeEventListener(<span class="string">'mouseup'</span>, up);
						};</pre></div></div>
            
        </li>
        
        
        <li id="section-151">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-151">&#182;</a>
              </div>
              <p>mousemove</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				document.body.addEventListener(<span class="string">'mousemove'</span>, move);</pre></div></div>
            
        </li>
        
        
        <li id="section-152">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-152">&#182;</a>
              </div>
              <p>mouseup</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				document.body.addEventListener(<span class="string">'mouseup'</span>, up);
			}
		);
	}


	<span class="keyword">this</span>.ctx.appendChild(svgPoint);


	<span class="keyword">if</span> ((<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>options).label) {
		dist = 1.75 * ((<span class="tag">&lt;<span class="title">any</span>&gt;</span>options).size || 10) + 0.75 * ((<span class="tag">&lt;<span class="title">any</span>&gt;</span>options).lineWidth || 4);
		screen.text((<span class="tag">&lt;<span class="title">any</span>&gt;</span>options).label,
			point[0] / point[2] + dist / (screen.scale.x - screen.scale.y),
			point[1] / point[2] + dist / (screen.scale.x - screen.scale.y), {}, true);
	}


	svgPoint.addEventListener('contextmenu', function () {
		screen.options.interaction.type = 'contextmenu';
		var x = (<span class="tag">&lt;<span class="title">any</span>&gt;</span>svgPoint).cx.baseVal.value,
				y = (<span class="tag">&lt;<span class="title">any</span>&gt;</span>svgPoint).cy.baseVal.value;

		screen.contextMenu.innerHTML = 
			'<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"MathLib_menuItem MathLib_temporaryMenuItem MathLib_is_disabled MathLib_is_centered"</span>&gt;</span>Point<span class="tag">&lt;/<span class="title">div</span>&gt;</span>' +
			'<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"MathLib_menuItem MathLib_temporaryMenuItem MathLib_hasSubmenu"</span>&gt;</span>Coordinates' +
					'<span class="tag">&lt;<span class="title">menu</span> <span class="attribute">class</span>=<span class="value">"MathLib_menu MathLib_submenu"</span>&gt;</span>' +
					'<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"MathLib_menuItem"</span>&gt;</span>cartesian: <span class="tag">&lt;<span class="title">span</span> <span class="attribute">class</span>=<span class="value">"MathLib_is_selectable MathLib_is_right"</span>&gt;</span>(' + x.toFixed(3) + ', ' + y.toFixed(3) + ')<span class="tag">&lt;/<span class="title">span</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span>' +
					'<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"MathLib_menuItem"</span>&gt;</span>polar: <span class="tag">&lt;<span class="title">span</span> <span class="attribute">class</span>=<span class="value">"MathLib_is_selectable MathLib_is_right"</span>&gt;</span>(' + MathLib.hypot(x, y).toFixed(3) + ', ' + Math.atan2(y, x).toFixed(3) + ')<span class="tag">&lt;/<span class="title">span</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span>' +
				'<span class="tag">&lt;/<span class="title">menu</span>&gt;</span>' +
			'<span class="tag">&lt;/<span class="title">div</span>&gt;</span>' +
			'<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"MathLib_menuItem MathLib_temporaryMenuItem MathLib_hasSubmenu"</span>&gt;</span>Options' +
				'<span class="tag">&lt;<span class="title">menu</span> <span class="attribute">class</span>=<span class="value">"MathLib_menu MathLib_submenu"</span>&gt;</span>' +
					'<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"MathLib_menuItem"</span>&gt;</span>Moveable:' +
						'<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"checkbox"</span> <span class="attribute">class</span>=<span class="value">"MathLib_is_right"</span>&gt;</span>' +
					'<span class="tag">&lt;/<span class="title">div</span>&gt;</span>' +
					'<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"MathLib_menuItem"</span>&gt;</span>Size:' +
						'<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"spinner"</span> <span class="attribute">class</span>=<span class="value">"MathLib_is_right"</span>&gt;</span>' +
					'<span class="tag">&lt;/<span class="title">div</span>&gt;</span>' +
					'<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"MathLib_menuItem"</span>&gt;</span>Fill color:' +
						'<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"color"</span> <span class="attribute">class</span>=<span class="value">"MathLib_is_right"</span>&gt;</span>' +
					'<span class="tag">&lt;/<span class="title">div</span>&gt;</span>' +
					'<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"MathLib_menuItem"</span>&gt;</span>Line color:' +
						'<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"color"</span> <span class="attribute">class</span>=<span class="value">"MathLib_is_right"</span>&gt;</span>' +
					'<span class="tag">&lt;/<span class="title">div</span>&gt;</span>' +
				'<span class="tag">&lt;/<span class="title">menu</span>&gt;</span>' +
			'<span class="tag">&lt;/<span class="title">div</span>&gt;</span>' +
			'<span class="tag">&lt;<span class="title">hr</span> <span class="attribute">class</span>=<span class="value">"MathLib_separator MathLib_temporaryMenuItem"</span>&gt;</span>' +
			screen.contextMenu.innerHTML;
	});


	if (!redraw) {
		this.stack.push({
			type: 'point',
			object: point,
			options: options
		});
	}

	return this;
},


</span></pre></div></div>
            
        </li>
        
        
        <li id="section-153">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-153">&#182;</a>
              </div>
              <h3 id="svg-text">SVG text</h3>
<p>Writes text on the screen.</p>
<p><em>@param {str}</em> The string to be drawn<br><em>@param {x}</em> The x coordinate<br><em>@param {y}</em> The y coordinate<br><em>@param {object}</em> [options] Optional drawing options<br><em>@return {Screen}</em> Returns the screen</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>text: <span class="function"><span class="keyword">function</span> <span class="params">(str, x, y, options = {}, redraw = false)</span> {</span>
	<span class="keyword">var</span> screen = <span class="keyword">this</span>.screen,
			svgText = document.createElementNS(<span class="string">'http://www.w3.org/2000/svg'</span>, <span class="string">'text'</span>);

	svgText.textContent = str;
	svgText.setAttribute(<span class="string">'x'</span>, x * screen.scale.x + <span class="string">''</span>);
	svgText.setAttribute(<span class="string">'y'</span>, y * screen.scale.y + <span class="string">''</span>);
	svgText.setAttribute(<span class="string">'transform'</span>, <span class="string">'matrix('</span> + <span class="number">1</span> / screen.scale.x + <span class="string">', 0, 0, '</span> + <span class="number">1</span> / screen.scale.y + <span class="string">', 0, 0)'</span>);
	svgText.setAttribute(<span class="string">'font-family'</span>, <span class="string">'Helvetica'</span>);
	svgText.setAttribute(<span class="string">'fill'</span>, colorConvert((<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>options).color) || '#000000');
	svgText.setAttribute('fill-opacity', '1');
	svgText.setAttribute('stroke', colorConvert((<span class="tag">&lt;<span class="title">any</span>&gt;</span>options).color) || '#000000');
	svgText.setAttribute('text-anchor', 'middle');

</span></pre></div></div>
            
        </li>
        
        
        <li id="section-154">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-154">&#182;</a>
              </div>
              <p>alignment-baseline isn&#39;t defined for text elements, 
only for ‘tspan’, ‘tref’, ‘altGlyph’, ‘textPath’ elements.<br>see the <a href="http://www.w3.org/TR/SVG/text.html#AlignmentBaselineProperty">Specification</a><br>But it works for text elements, so we don&#39;t need an additional tspan element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	svgText.setAttribute(<span class="string">'alignment-baseline'</span>, <span class="string">'middle'</span>);


	<span class="keyword">this</span>.ctx.appendChild(svgText);

	<span class="keyword">if</span> (!redraw) {
		<span class="keyword">this</span>.stack.push({
			type: <span class="string">'text'</span>,
			object: str,
			x: x,
			y: y,
			options: options
		});
	}

	<span class="keyword">return</span> <span class="keyword">this</span>;
}


}<span class="comment">// ## &lt;a id="Screen2D"&gt;&lt;/a&gt;Screen2D</span></pre></div></div>
            
        </li>
        
        
        <li id="section-155">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-155">&#182;</a>
              </div>
              <p>Two dimensional plotting</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>export class Screen2D extends Screen {
	type = <span class="string">'screen2D'</span>;

	applyTransformation: any;
	background: any;
	renderer: any;
	axis: any;
	grid: any;
	layer: any;
	element: any;

	init: any;
	redraw: any;</pre></div></div>
            
        </li>
        
        
        <li id="section-156">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-156">&#182;</a>
              </div>
              <p>Drawing functions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	draw: any;
	circle: any;
	line: any;
	path: any;
	pixel: any;
	point: any;
	text: any;</pre></div></div>
            
        </li>
        
        
        <li id="section-157">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-157">&#182;</a>
              </div>
              <p>Transformation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	transformation: any;
	translation: any;
	scale: any;
	lookAt: any;
	range: any;</pre></div></div>
            
        </li>
        
        
        <li id="section-158">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-158">&#182;</a>
              </div>
              <p>Interaction TODO</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	interaction: any;
	zoomSpeed: any;


	constructor (id: string, options = {}) {
		super(id, options);
		<span class="keyword">var</span> defaults = {
					axis: {
						color: <span class="number">0x000000</span>,
						textColor: <span class="number">0x000000</span>,
						tick: {x: <span class="number">1</span>, y: <span class="number">1</span>}
					},
					grid: {
						angle: Math.PI / <span class="number">8</span>,
						color: <span class="number">0xcccccc</span>,
						type: <span class="string">'cartesian'</span>,
						tick: {x: <span class="number">1</span>, y: <span class="number">1</span>, r: <span class="number">1</span>}
					},
					interaction: {
						allowPan: <span class="literal">true</span>,
						allowZoom: <span class="literal">true</span>,
						zoomSpeed: <span class="number">1</span>
					},
					background: <span class="number">0xffffff</span>,
					lookAt: {x: <span class="number">0</span>, y: <span class="number">0</span>},
					range: {x: <span class="number">1</span>, y: <span class="number">1</span>},
					figcaption: <span class="string">''</span>,
					renderer: <span class="string">'Canvas'</span>,
					transformation: <span class="keyword">new</span> MathLib.Matrix([[Math.min(<span class="keyword">this</span>.height, <span class="keyword">this</span>.width) / <span class="number">2</span>, <span class="number">0</span>, <span class="keyword">this</span>.width / <span class="number">2</span>],
																							[<span class="number">0</span>, -Math.min(<span class="keyword">this</span>.height, <span class="keyword">this</span>.width) / <span class="number">2</span>, <span class="keyword">this</span>.height / <span class="number">2</span>],
																							[<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>]])
				},
				opts = extendObject(defaults, options),
				element,
				transformation = opts.transformation,
				_<span class="keyword">this</span> = <span class="keyword">this</span>;

		<span class="keyword">this</span>.options = opts;
		<span class="keyword">this</span>.renderer = MathLib[opts.renderer];


		<span class="keyword">this</span>.circle = (...args : any[]) =&gt; <span class="keyword">this</span>.renderer.circle.apply(<span class="keyword">this</span>.layer.main, args);
		<span class="keyword">this</span>.line   = (...args : any[]) =&gt; <span class="keyword">this</span>.renderer.line.apply(  <span class="keyword">this</span>.layer.main, args);
		<span class="keyword">this</span>.path   = (...args : any[]) =&gt; <span class="keyword">this</span>.renderer.path.apply(  <span class="keyword">this</span>.layer.main, args);</pre></div></div>
            
        </li>
        
        
        <li id="section-159">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-159">&#182;</a>
              </div>
              <p>Should the pixel method default to the main layer or to the back layer?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">this</span>.pixel  = (...args : any[]) =&gt; <span class="keyword">this</span>.renderer.pixel.apply( <span class="keyword">this</span>.layer.main, args);
		<span class="keyword">this</span>.point  = (...args : any[]) =&gt; <span class="keyword">this</span>.renderer.point.apply( <span class="keyword">this</span>.layer.main, args);
		<span class="keyword">this</span>.text   = (...args : any[]) =&gt; <span class="keyword">this</span>.renderer.text.apply(  <span class="keyword">this</span>.layer.main, args);</pre></div></div>
            
        </li>
        
        
        <li id="section-160">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-160">&#182;</a>
              </div>
              <p>Remove the warning message.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">this</span>.wrapper.innerHTML = <span class="string">''</span>;

		<span class="keyword">this</span>.container.classList.add(<span class="string">'MathLib_screen2D'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-161">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-161">&#182;</a>
              </div>
              <p>This is just a dummy method for the following few lines.
The real applyTransformation method is specified after the creation of the layers.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">this</span>.applyTransformation = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>};</pre></div></div>
            
        </li>
        
        
        <li id="section-162">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-162">&#182;</a>
              </div>
              <p>The interaction methods</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">this</span>.translation = {};
		<span class="keyword">this</span>.scale = {};
		<span class="keyword">this</span>.transformation = transformation;

		Object.defineProperty(<span class="keyword">this</span>.translation, <span class="string">'x'</span>, {
			get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span><span class="keyword">return</span> _<span class="keyword">this</span>.transformation[<span class="number">0</span>][<span class="number">2</span>];},
			set: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>_<span class="keyword">this</span>.transformation[<span class="number">0</span>][<span class="number">2</span>] = x; _<span class="keyword">this</span>.applyTransformation();}
		});

		Object.defineProperty(<span class="keyword">this</span>.translation, <span class="string">'y'</span>, {
			get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span><span class="keyword">return</span> _<span class="keyword">this</span>.transformation[<span class="number">1</span>][<span class="number">2</span>];},
			set: <span class="function"><span class="keyword">function</span> <span class="params">(y)</span> {</span>_<span class="keyword">this</span>.transformation[<span class="number">1</span>][<span class="number">2</span>] = y; _<span class="keyword">this</span>.applyTransformation();}
		});

		Object.defineProperty(<span class="keyword">this</span>.scale, <span class="string">'x'</span>, {
			get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span><span class="keyword">return</span> _<span class="keyword">this</span>.transformation[<span class="number">0</span>][<span class="number">0</span>];},
			set: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>_<span class="keyword">this</span>.transformation[<span class="number">0</span>][<span class="number">0</span>] = x; _<span class="keyword">this</span>.applyTransformation();}
		});

		Object.defineProperty(<span class="keyword">this</span>.scale, <span class="string">'y'</span>, {
			get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span><span class="keyword">return</span> _<span class="keyword">this</span>.transformation[<span class="number">1</span>][<span class="number">1</span>];},
			set: <span class="function"><span class="keyword">function</span> <span class="params">(y)</span> {</span>_<span class="keyword">this</span>.transformation[<span class="number">1</span>][<span class="number">1</span>] = y; _<span class="keyword">this</span>.applyTransformation();}
		});



		<span class="keyword">this</span>.lookAt = {};
		<span class="keyword">this</span>.range = {};
		Object.defineProperty(<span class="keyword">this</span>.lookAt, <span class="string">'x'</span>, {
			get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span><span class="keyword">return</span> (_<span class="keyword">this</span>.width / <span class="number">2</span> - _<span class="keyword">this</span>.transformation[<span class="number">0</span>][<span class="number">2</span>]) / _<span class="keyword">this</span>.transformation[<span class="number">0</span>][<span class="number">0</span>];},
			set: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>_<span class="keyword">this</span>.transformation[<span class="number">0</span>][<span class="number">2</span>] = _<span class="keyword">this</span>.width / <span class="number">2</span> - x * _<span class="keyword">this</span>.transformation[<span class="number">0</span>][<span class="number">0</span>]; _<span class="keyword">this</span>.applyTransformation();}
		});

		Object.defineProperty(<span class="keyword">this</span>.lookAt, <span class="string">'y'</span>, {
			get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span><span class="keyword">return</span> (_<span class="keyword">this</span>.height / <span class="number">2</span> - _<span class="keyword">this</span>.transformation[<span class="number">1</span>][<span class="number">2</span>]) / _<span class="keyword">this</span>.transformation[<span class="number">1</span>][<span class="number">1</span>];},
			set: <span class="function"><span class="keyword">function</span> <span class="params">(y)</span> {</span>_<span class="keyword">this</span>.transformation[<span class="number">1</span>][<span class="number">2</span>] = _<span class="keyword">this</span>.height / <span class="number">2</span> - y * _<span class="keyword">this</span>.transformation[<span class="number">1</span>][<span class="number">1</span>]; _<span class="keyword">this</span>.applyTransformation();}
		});

		Object.defineProperty(<span class="keyword">this</span>.range, <span class="string">'x'</span>, {
			get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span><span class="keyword">return</span> _<span class="keyword">this</span>.width / (<span class="number">2</span> * _<span class="keyword">this</span>.transformation[<span class="number">0</span>][<span class="number">0</span>]);},
			set: <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>_<span class="keyword">this</span>.transformation[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0.5</span> * _<span class="keyword">this</span>.width / x; _<span class="keyword">this</span>.applyTransformation();}
		});

		Object.defineProperty(<span class="keyword">this</span>.range, <span class="string">'y'</span>, {
			get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span><span class="keyword">return</span> -_<span class="keyword">this</span>.height / (<span class="number">2</span> * _<span class="keyword">this</span>.transformation[<span class="number">1</span>][<span class="number">1</span>]);},
			set: <span class="function"><span class="keyword">function</span> <span class="params">(y)</span> {</span>_<span class="keyword">this</span>.transformation[<span class="number">1</span>][<span class="number">1</span>] = -<span class="number">0.5</span> * _<span class="keyword">this</span>.height / y; _<span class="keyword">this</span>.applyTransformation();}
		});


		<span class="keyword">this</span>.range.x = opts.range.x
		<span class="keyword">this</span>.range.y = opts.range.y
		<span class="keyword">this</span>.lookAt.x = opts.lookAt.x
		<span class="keyword">this</span>.lookAt.y = opts.lookAt.y</pre></div></div>
            
        </li>
        
        
        <li id="section-163">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-163">&#182;</a>
              </div>
              <p>Create the SVG element which contains the layers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (opts.renderer === <span class="string">'SVG'</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-164">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-164">&#182;</a>
              </div>
              <p>Create the canvas</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			element = document.createElementNS(<span class="string">'http://www.w3.org/2000/svg'</span>, <span class="string">'svg'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-165">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-165">&#182;</a>
              </div>
              <p>Safari does not support .classList on SVG elements
This feature has be in webkit since <a href="http://trac.webkit.org/changeset/124499">08/02/12</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="comment">/* element.classList.add('MathLib_screen'); */</span>
			element.className.baseVal = <span class="string">'MathLib_screen'</span>;
			element.setAttribute(<span class="string">'xmlns'</span>, <span class="string">'http://www.w3.org/2000/svg'</span>);
			element.setAttribute(<span class="string">'xmlns:xlink'</span>, <span class="string">'http://www.w3.org/1999/xlink'</span>);
			element.setAttribute(<span class="string">'height'</span>, <span class="keyword">this</span>.height + <span class="string">'px'</span>);
			element.setAttribute(<span class="string">'width'</span>, <span class="keyword">this</span>.width + <span class="string">'px'</span>);
			element.setAttribute(<span class="string">'version'</span>, <span class="string">'1.1'</span>);

			element.setAttribute(<span class="string">'stroke'</span>, <span class="string">'#000000'</span>);
			element.setAttribute(<span class="string">'stroke-opacity'</span>, <span class="string">'1'</span>);
			element.setAttribute(<span class="string">'fill'</span>, <span class="string">'#ffffff'</span>);
			element.setAttribute(<span class="string">'fill-opacity'</span>, <span class="string">'0'</span>);

			<span class="keyword">this</span>.element = element;
			<span class="keyword">this</span>.wrapper.appendChild(element);

			<span class="keyword">if</span> (<span class="string">'background'</span> <span class="keyword">in</span> options) {
				<span class="keyword">var</span> background = document.createElementNS(<span class="string">'http://www.w3.org/2000/svg'</span>,<span class="string">'rect'</span>);

				background.setAttribute(<span class="string">'x'</span>, <span class="string">'0px'</span>);
				background.setAttribute(<span class="string">'y'</span>, <span class="string">'0px'</span>);
				background.setAttribute(<span class="string">'width'</span>, <span class="keyword">this</span>.width + <span class="string">'px'</span>);
				background.setAttribute(<span class="string">'height'</span>, <span class="keyword">this</span>.height + <span class="string">'px'</span>);
				background.setAttribute(<span class="string">'fill'</span>, colorConvert((<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>options).background));
				background.setAttribute('fill-opacity', '1');
				this.element.appendChild(background);
			}
		}



</span></pre></div></div>
            
        </li>
        
        
        <li id="section-166">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-166">&#182;</a>
              </div>
              <h1 id="create-the-layers">Create the Layers</h1>

            </div>
            
        </li>
        
        
        <li id="section-167">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-167">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">this</span>.layer = [];
		<span class="keyword">this</span>.layer.back = <span class="keyword">new</span> MathLib.Layer(<span class="keyword">this</span>, <span class="string">'back'</span>, <span class="number">0</span>);
		<span class="keyword">this</span>.layer.grid = <span class="keyword">new</span> MathLib.Layer(<span class="keyword">this</span>, <span class="string">'grid'</span>, <span class="number">1</span>);
		<span class="keyword">this</span>.layer.axis = <span class="keyword">new</span> MathLib.Layer(<span class="keyword">this</span>, <span class="string">'axis'</span>, <span class="number">2</span>);
		<span class="keyword">this</span>.layer.main = <span class="keyword">new</span> MathLib.Layer(<span class="keyword">this</span>, <span class="string">'main'</span>, <span class="number">3</span>);


		<span class="keyword">this</span>.wrapper.addEventListener(<span class="string">'mouseup'</span>,      (evt) =&gt; <span class="keyword">this</span>.onmouseup(evt), <span class="literal">false</span>);
		<span class="keyword">this</span>.wrapper.addEventListener(<span class="string">'mousedown'</span>,    (evt) =&gt; <span class="keyword">this</span>.onmousedown(evt), <span class="literal">false</span>);
		<span class="keyword">this</span>.wrapper.addEventListener(<span class="string">'mousemove'</span>,    (evt) =&gt; <span class="keyword">this</span>.onmousemove(evt), <span class="literal">false</span>);
		<span class="keyword">this</span>.wrapper.addEventListener(<span class="string">'mousewheel'</span>,   (evt) =&gt; <span class="keyword">this</span>.onmousewheel(evt), <span class="literal">false</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-168">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-168">&#182;</a>
              </div>
              <p>For Firefox: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=111647">Bug report for the missing onmousewheel method</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">this</span>.wrapper.addEventListener(<span class="string">'DOMMouseScroll'</span>, (evt) =&gt; <span class="keyword">this</span>.onmousewheel(evt), <span class="literal">false</span>);


		<span class="keyword">this</span>.applyTransformation = <span class="keyword">this</span>.renderer.applyTransformation;


		<span class="keyword">this</span>.draw = <span class="function"><span class="keyword">function</span> <span class="params">(x, options = {})</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-169">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-169">&#182;</a>
              </div>
              <p>Clear and redraw the screen</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">if</span> (arguments.length === <span class="number">0</span>) {
				<span class="keyword">this</span>.layer.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(l)</span> {</span>
					l.clear().draw()
				});
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'circle'</span>) {
				<span class="keyword">this</span>.circle(x, options);
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'line'</span>) {
				<span class="keyword">this</span>.line(x, options);
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (Array.isArray(x)) {
				x.forEach((y) =&gt; <span class="keyword">this</span>[y.type](y, options));
			}
		};


		<span class="keyword">if</span> (<span class="keyword">this</span>.options.contextMenu) {
			<span class="keyword">var</span> gridType = opts.grid.type ? opts.grid.type : <span class="string">'none'</span>;
			<span class="keyword">this</span>.contextMenu.querySelectorAll(<span class="string">'.MathLib_grid_type[value='</span> + gridType + <span class="string">']'</span>)[<span class="number">0</span>].checked = <span class="literal">true</span>;
		}

		<span class="keyword">this</span>.draw();
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-170">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-170">&#182;</a>
              </div>
              <h3 id="screen-prototype-drawaxis">Screen.prototype.drawAxis</h3>
<p>Draws the axis.</p>
<p><em>@return {Screen2D}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>drawAxis() {

	<span class="keyword">var</span> line = (...args : any[]) =&gt; <span class="keyword">this</span>.renderer.line.apply(<span class="keyword">this</span>.layer.axis, args),
			text = (...args : any[]) =&gt; <span class="keyword">this</span>.renderer.text.apply(<span class="keyword">this</span>.layer.axis, args),
			options = {
				lineColor: colorConvert(<span class="keyword">this</span>.options.axis.color),
				<span class="string">'stroke-width'</span>: -<span class="number">1</span> / <span class="keyword">this</span>.transformation[<span class="number">1</span>][<span class="number">1</span>]
			},
			textOptions = {
				strokeStyle: colorConvert(<span class="keyword">this</span>.options.axis.textColor),
				fillStyle: colorConvert(<span class="keyword">this</span>.options.axis.textColor)
			},
			top     = (            - <span class="keyword">this</span>.translation.y) / <span class="keyword">this</span>.scale.y,
			bottom  = (<span class="keyword">this</span>.height - <span class="keyword">this</span>.translation.y) / <span class="keyword">this</span>.scale.y,
			left    = (            - <span class="keyword">this</span>.translation.x) / <span class="keyword">this</span>.scale.x,
			right   = (<span class="keyword">this</span>.width  - <span class="keyword">this</span>.translation.x) / <span class="keyword">this</span>.scale.x,
			lengthX =  <span class="number">10</span> / <span class="keyword">this</span>.transformation[<span class="number">0</span>][<span class="number">0</span>],
			lengthY = -<span class="number">10</span> / <span class="keyword">this</span>.transformation[<span class="number">1</span>][<span class="number">1</span>],

			yExp = <span class="number">1</span> - Math.floor(Math.log(-<span class="keyword">this</span>.transformation[<span class="number">1</span>][<span class="number">1</span>]) / Math.LN10 - <span class="number">0.3</span>),
			xExp = <span class="number">1</span> - Math.floor(Math.log( <span class="keyword">this</span>.transformation[<span class="number">0</span>][<span class="number">0</span>]) / Math.LN10 - <span class="number">0.3</span>),
			yTick = Math.pow(<span class="number">10</span>, yExp),
			xTick = Math.pow(<span class="number">10</span>, xExp),
			i;

  <span class="keyword">if</span> (!<span class="keyword">this</span>.options.axis) {
		<span class="keyword">return</span> <span class="keyword">this</span>;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-171">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-171">&#182;</a>
              </div>
              <p>The axes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	line([[left, <span class="number">0</span>], [right, <span class="number">0</span>]], options, <span class="literal">true</span>);
	line([[<span class="number">0</span>, bottom], [<span class="number">0</span>, top]], options, <span class="literal">true</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-172">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-172">&#182;</a>
              </div>
              <p>The ticks on the axes
The x axis</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (<span class="keyword">this</span>.options.grid.tick) {
		<span class="keyword">for</span> (i = -yTick; i &gt;= left; i -= yTick) {
			line([[i, -lengthY], [i, lengthY]], options, <span class="literal">true</span>);
		}
		<span class="keyword">for</span> (i = yTick; i &lt;= right; i += yTick) {
			line([[i, -lengthY], [i, lengthY]], options, <span class="literal">true</span>);
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-173">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-173">&#182;</a>
              </div>
              <p>The y axis</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">for</span> (i = -xTick; i &gt;= bottom; i -= xTick) {
			line([[-lengthX, i], [lengthX, i]], options, <span class="literal">true</span>);
		}
		<span class="keyword">for</span> (i = xTick; i &lt;= top; i += xTick) {
			line([[-lengthX, i], [lengthX, i]], options, <span class="literal">true</span>);
		}
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-174">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-174">&#182;</a>
              </div>
              <p>The labels
The x axis
.toFixed() is necessary to display 0.3 as &quot;0.3&quot; and not as &quot;0.30000000000000004&quot;.
.toFixed expects arguments between 0 and 20.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">var</span> xLen = Math.max(<span class="number">0</span>, Math.min(<span class="number">20</span>, -xExp)),
			yLen = Math.max(<span class="number">0</span>, Math.min(<span class="number">20</span>, -yExp));

	<span class="keyword">for</span> (i = -yTick; i &gt;= left; i -= yTick) {
		text(i.toFixed(yLen), i, -<span class="number">2</span> * lengthY, textOptions, <span class="literal">true</span>);
	}
	<span class="keyword">for</span> (i = yTick; i &lt;= right; i += yTick) {
		text(i.toFixed(yLen), i, -<span class="number">2</span> * lengthY, textOptions, <span class="literal">true</span>);
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-175">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-175">&#182;</a>
              </div>
              <p>The y axis</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">for</span> (i = -xTick; i &gt;= bottom; i -= xTick) {
		text(i.toFixed(xLen), -<span class="number">2</span> * lengthX, i, textOptions, <span class="literal">true</span>);
	}
	<span class="keyword">for</span> (i = xTick; i &lt;= top; i += xTick) {
		text(i.toFixed(xLen), -<span class="number">2</span> * lengthX, i, textOptions, <span class="literal">true</span>);
	}

	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-176">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-176">&#182;</a>
              </div>
              <h3 id="screen2d-prototype-drawgrid">Screen2D.prototype.drawGrid</h3>
<p>Draws the grid.</p>
<p><em>@return {Screen2D}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>drawGrid() {

	<span class="keyword">if</span> (!<span class="keyword">this</span>.options.grid) {
		<span class="keyword">return</span> <span class="keyword">this</span>;
	}

	<span class="keyword">var</span> line   = (...args : any[]) =&gt; <span class="keyword">this</span>.renderer.line.apply(<span class="keyword">this</span>.layer.grid, args),
			circle = (...args : any[]) =&gt; <span class="keyword">this</span>.renderer.circle.apply(<span class="keyword">this</span>.layer.grid, args),
			top    = (            - <span class="keyword">this</span>.translation.y) / <span class="keyword">this</span>.scale.y,
			bottom = (<span class="keyword">this</span>.height - <span class="keyword">this</span>.translation.y) / <span class="keyword">this</span>.scale.y,
			left   = (            - <span class="keyword">this</span>.translation.x) / <span class="keyword">this</span>.scale.x,
			right  = (<span class="keyword">this</span>.width  - <span class="keyword">this</span>.translation.x) / <span class="keyword">this</span>.scale.x,
			yTick  = Math.pow(<span class="number">10</span>, <span class="number">1</span> - Math.floor(Math.log(-<span class="keyword">this</span>.transformation[<span class="number">1</span>][<span class="number">1</span>]) / Math.LN10 - <span class="number">0.3</span>)),
			xTick  = Math.pow(<span class="number">10</span>, <span class="number">1</span> - Math.floor(Math.log( <span class="keyword">this</span>.transformation[<span class="number">0</span>][<span class="number">0</span>]) / Math.LN10 - <span class="number">0.3</span>)),
			i, ii;


	<span class="keyword">if</span> (<span class="keyword">this</span>.options.grid.type === <span class="string">'cartesian'</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-177">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-177">&#182;</a>
              </div>
              <p>The horizontal lines</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">for</span> (i = bottom - (bottom % yTick); i &lt;= top; i += yTick) {
			line([[left, i], [right, i]], <span class="literal">false</span>, <span class="literal">true</span>);
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-178">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-178">&#182;</a>
              </div>
              <p>The vertical lines</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">for</span> (i = left - (left % xTick); i &lt;= right; i += xTick) {
			line([[i, bottom], [i, top]], <span class="literal">false</span>, <span class="literal">true</span>);
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-179">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-179">&#182;</a>
              </div>
              <p>Test for logarithmic plots</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="comment">/*for (i = left - (left % this.axis.tick.x); i &lt;= right; i += this.axis.tick.x) {
			for (var j = 1; j &lt;= 10; j++ ) {
				this.line([[i * Math.log(10) + Math.log(j), bottom], [i * Math.log(10) + Math.log(j), top]], options);
			}
		}*/</span>


	}
	<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.options.grid.type === <span class="string">'polar'</span>) {
		<span class="keyword">var</span> max = Math.sqrt(Math.max(top * top, bottom * bottom) + Math.max(left * left, right * right)),
				min = <span class="number">0</span>; <span class="comment">// TODO: improve this estimate</span>

		<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="number">2</span> * Math.PI; i &lt; ii; i += <span class="keyword">this</span>.options.grid.angle) {
			line([[<span class="number">0</span>, <span class="number">0</span>], [max * Math.cos(i), max * Math.sin(i)]], <span class="literal">false</span>, <span class="literal">true</span>);
		}

		<span class="keyword">for</span> (i = min; i &lt;= max; i += Math.min(xTick, yTick)) {
			circle(<span class="keyword">new</span> MathLib.Circle([<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>], i), <span class="literal">false</span>, <span class="literal">true</span>);
		}
	}

	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-180">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-180">&#182;</a>
              </div>
              <h3 id="screen-prototype-geteventpoint">Screen.prototype.getEventPoint</h3>
<p>Creates a point based on the coordinates of an event.</p>
<p><em>@param {event}</em><br><em>@return {Point}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>getEventPoint(evt) {
	<span class="keyword">var</span> x, y;
	<span class="keyword">if</span> (evt.offsetX) {
		x = evt.offsetX;
		y = evt.offsetY;
	}
	<span class="keyword">else</span> {
		x = evt.layerX;
		y = evt.layerY;
	}
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Point([x, y, <span class="number">1</span>]);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-181">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-181">&#182;</a>
              </div>
              <h3 id="screen2d-prototype-getineendpoint-">Screen2D.prototype.getineEndPoint()</h3>
<p>Calculates the both endpoints for the line
for drawing purposes</p>
<p><em>@param {Line|array}</em><br><em>@return {array}</em> The array has the format [[x1, y1], [x2, y2]]</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>getLineEndPoints (l) {
	<span class="keyword">if</span> (l.type === <span class="string">'line'</span>) {
		<span class="keyword">var</span> top    = (            - <span class="keyword">this</span>.translation.y) / <span class="keyword">this</span>.scale.y,
				bottom = (<span class="keyword">this</span>.height - <span class="keyword">this</span>.translation.y) / <span class="keyword">this</span>.scale.y,
				left   = (            - <span class="keyword">this</span>.translation.x) / <span class="keyword">this</span>.scale.x,
				right  = (<span class="keyword">this</span>.width  - <span class="keyword">this</span>.translation.x) / <span class="keyword">this</span>.scale.x,
				lineRight  = -(l[<span class="number">2</span>] + l[<span class="number">0</span>] * right)  / l[<span class="number">1</span>],
				lineTop    = -(l[<span class="number">2</span>] + l[<span class="number">1</span>] * top)    / l[<span class="number">0</span>],
				lineLeft   = -(l[<span class="number">2</span>] + l[<span class="number">0</span>] * left)   / l[<span class="number">1</span>],
				lineBottom = -(l[<span class="number">2</span>] + l[<span class="number">1</span>] * bottom) / l[<span class="number">0</span>],
				points = [];

		<span class="keyword">if</span> (lineRight &lt;= top &amp;&amp; lineRight &gt;= bottom) {
			points.push([right, lineRight]);
		}
		<span class="keyword">if</span> (lineLeft &lt;= top &amp;&amp; lineLeft &gt;= bottom) {
			points.push([left, lineLeft]);
		}
		<span class="keyword">if</span> (lineTop &lt; right &amp;&amp; lineTop &gt; left) {
			points.push([lineTop, top]);
		}
		<span class="keyword">if</span> (lineBottom &lt; right &amp;&amp; lineBottom &gt; left) {
			points.push([lineBottom, bottom]);
		}
		<span class="keyword">return</span> points;
	}
	<span class="keyword">else</span> {
		<span class="keyword">return</span> l;
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-182">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-182">&#182;</a>
              </div>
              <h3 id="screen2d-prototype-onmousedown-">Screen2D.prototype.onmousedown()</h3>
<p>Handles the mousedown event</p>
<p><em>@param {event}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>onmousedown(evt) {</pre></div></div>
            
        </li>
        
        
        <li id="section-183">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-183">&#182;</a>
              </div>
              <p>Only start the action if the left mouse button was clicked</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (evt.button !== <span class="number">0</span>) {
		<span class="keyword">return</span>;
	}


	<span class="keyword">if</span> (evt.preventDefault) {
		evt.preventDefault();
	}

	evt.returnValue = <span class="literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-184">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-184">&#182;</a>
              </div>
              <p>Pan mode</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (<span class="keyword">this</span>.options.interaction.allowPan &amp;&amp; !<span class="keyword">this</span>.options.interaction.type) {
		<span class="keyword">this</span>.options.interaction.type = <span class="string">'pan'</span>
		<span class="keyword">this</span>.options.interaction.startPoint = <span class="keyword">this</span>.getEventPoint(evt);
		<span class="keyword">this</span>.options.interaction.startTransformation = <span class="keyword">this</span>.transformation.copy();
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-185">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-185">&#182;</a>
              </div>
              <h3 id="screen-prototype-onmousemove-">Screen.prototype.onmousemove()</h3>
<p>Handles the mousemove event</p>
<p><em>@param {event}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>onmousemove(evt) {
	<span class="keyword">var</span> p;

	<span class="keyword">if</span> (evt.preventDefault) {
		evt.preventDefault();
	}

	evt.returnValue = <span class="literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-186">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-186">&#182;</a>
              </div>
              <p>Pan mode</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (<span class="keyword">this</span>.options.interaction.type === <span class="string">'pan'</span>) {
		p = <span class="keyword">this</span>.getEventPoint(evt).minus(<span class="keyword">this</span>.options.interaction.startPoint);
		<span class="keyword">this</span>.translation.x = <span class="keyword">this</span>.options.interaction.startTransformation[<span class="number">0</span>][<span class="number">2</span>] + p[<span class="number">0</span>];
		<span class="keyword">this</span>.translation.y = <span class="keyword">this</span>.options.interaction.startTransformation[<span class="number">1</span>][<span class="number">2</span>] + p[<span class="number">1</span>];
		<span class="keyword">this</span>.draw();
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-187">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-187">&#182;</a>
              </div>
              <h3 id="screen-prototype-onmouseup-">Screen.prototype.onmouseup()</h3>
<p>Handles the mouseup event</p>
<p><em>@param {event}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>onmouseup(evt) {
	<span class="keyword">if</span> (evt.preventDefault) {
		evt.preventDefault();
	}

	evt.returnValue = <span class="literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-188">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-188">&#182;</a>
              </div>
              <p>Go back to normal mode</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (<span class="keyword">this</span>.options.interaction.type === <span class="string">'pan'</span>) {
		<span class="keyword">delete</span> <span class="keyword">this</span>.options.interaction.type;
		<span class="keyword">delete</span> <span class="keyword">this</span>.options.interaction.startPoint;
		<span class="keyword">delete</span> <span class="keyword">this</span>.options.interaction.startTransformation;
	}

}</pre></div></div>
            
        </li>
        
        
        <li id="section-189">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-189">&#182;</a>
              </div>
              <h3 id="screen-prototype-onmousewheel-">Screen.prototype.onmousewheel()</h3>
<p>Handles the mousewheel event</p>
<p><em>@param {event}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>onmousewheel(evt) {
	<span class="keyword">var</span> delta, s, p, z;

	<span class="keyword">if</span> (<span class="keyword">this</span>.options.interaction.allowZoom) {

		<span class="keyword">if</span> (evt.preventDefault) {
			evt.preventDefault();
		}
		evt.returnValue = <span class="literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-190">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-190">&#182;</a>
              </div>
              <p>Chrome/Safari</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (evt.wheelDelta) {
			delta = evt.wheelDelta / <span class="number">360</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-191">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-191">&#182;</a>
              </div>
              <p>Firefox</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">else</span> {
			delta = evt.detail / -<span class="number">9</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-192">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-192">&#182;</a>
              </div>
              <p>The amount of zoom is determined by the zoom speed
and the amount how much the scrollwheel has been moved</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		z = Math.pow(<span class="number">1</span> + <span class="keyword">this</span>.options.interaction.zoomSpeed, delta);</pre></div></div>
            
        </li>
        
        
        <li id="section-193">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-193">&#182;</a>
              </div>
              <p>Transform the (computer-)screen coordinates of the mouse to the internal coordinates</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		p = <span class="keyword">this</span>.transformation.inverse().times(<span class="keyword">this</span>.getEventPoint(evt));</pre></div></div>
            
        </li>
        
        
        <li id="section-194">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-194">&#182;</a>
              </div>
              <p>Compute new scale matrix in current mouse position</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		s = <span class="keyword">new</span> MathLib.Matrix([[z, <span class="number">0</span>, p[<span class="number">0</span>] - p[<span class="number">0</span>] * z], [<span class="number">0</span>, z, p[<span class="number">1</span>] - p[<span class="number">1</span>] * z], [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>]]);

		<span class="keyword">this</span>.transformation = <span class="keyword">this</span>.transformation.times(s);

		<span class="keyword">this</span>.applyTransformation();
		<span class="keyword">this</span>.draw();

	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-195">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-195">&#182;</a>
              </div>
              <h3 id="screen2d-prototype-resize-">Screen2D.prototype.resize()</h3>
<p>Adjust the rendering if the screen is resized</p>
<p><em>@param {number}</em> The new width<br><em>@param {number}</em> The new height<br><em>@return {Screen2D}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>resize(width : number, height : number) : Screen2D {
	<span class="keyword">this</span>.height = height;
	<span class="keyword">this</span>.width = width;


	<span class="keyword">if</span> (<span class="keyword">this</span>.options.renderer === <span class="string">'Canvas'</span>) {
		<span class="keyword">this</span>.layer.back.element.width = width;
		<span class="keyword">this</span>.layer.back.element.height = height;
		<span class="keyword">this</span>.layer.back.ctx.fillStyle = <span class="string">'rgba(255, 255, 255, 0)'</span>;
		
		<span class="keyword">this</span>.layer.grid.element.width = width;
		<span class="keyword">this</span>.layer.grid.element.height = height;
		<span class="keyword">this</span>.layer.grid.ctx.fillStyle = <span class="string">'rgba(255, 255, 255, 0)'</span>;
		<span class="keyword">this</span>.layer.grid.ctx.strokeStyle = colorConvert(<span class="keyword">this</span>.options.grid.color) || <span class="string">'#cccccc'</span>;

		<span class="keyword">this</span>.layer.axis.element.width = width;
		<span class="keyword">this</span>.layer.axis.element.height = height;
		<span class="keyword">this</span>.layer.axis.ctx.fillStyle = <span class="string">'rgba(255, 255, 255, 0)'</span>;
		<span class="keyword">this</span>.layer.axis.ctx.strokeStyle = colorConvert(<span class="keyword">this</span>.options.axis.color) || <span class="string">'#000000'</span>;

		<span class="keyword">this</span>.layer.main.element.width = width;
		<span class="keyword">this</span>.layer.main.element.height = height;
		<span class="keyword">this</span>.layer.main.ctx.fillStyle = <span class="string">'rgba(255, 255, 255, 0)'</span>;
	}


	<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.options.renderer === <span class="string">'SVG'</span>) {
		<span class="keyword">this</span>.element.setAttribute(<span class="string">'width'</span>, width + <span class="string">'px'</span>);
		<span class="keyword">this</span>.element.setAttribute(<span class="string">'height'</span>, height + <span class="string">'px'</span>);
	}

	<span class="keyword">this</span>.applyTransformation();
	<span class="keyword">this</span>.draw();

	<span class="keyword">return</span> <span class="keyword">this</span>;
}


}<span class="comment">// ## &lt;a id="Screen3D"&gt;&lt;/a&gt;Screen3D</span></pre></div></div>
            
        </li>
        
        
        <li id="section-196">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-196">&#182;</a>
              </div>
              <p>Two dimensional plotting</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>export class Screen3D extends Screen {
	type = <span class="string">'screen3D'</span>;

	grid: any;
	axis: any;
	render: any;
	camera: any;
	element: any;
	scene: any;

	constructor (id: string, options = {}) {
		super(id, options);

		<span class="keyword">var</span> defaults = {
					anaglyphMode: <span class="literal">false</span>,
					axis: <span class="literal">true</span>,
					background: <span class="number">0xffffff</span>,
					camera: {
						lookAt: [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],
						position: [<span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>]
					},
					controls: <span class="string">'Trackball'</span>,
					grid: {
						xy: {
							angle: Math.PI / <span class="number">8</span>,
							color: <span class="number">0xcccccc</span>,
							type: <span class="string">'none'</span>,
							tick: {x: <span class="number">1</span>, y: <span class="number">1</span>, r: <span class="number">1</span>}
						},
						xz: {
							angle: Math.PI / <span class="number">8</span>,
							color: <span class="number">0xcccccc</span>,
							type: <span class="string">'none'</span>,
							tick: {x: <span class="number">1</span>, z: <span class="number">1</span>, r: <span class="number">1</span>}
						},
						yz: {
							angle: Math.PI / <span class="number">8</span>,
							color: <span class="number">0xcccccc</span>,
							type: <span class="string">'none'</span>,
							tick: {y: <span class="number">1</span>, z: <span class="number">1</span>, r: <span class="number">1</span>}
						}
					},
					height: <span class="number">500</span>,
					renderer: <span class="string">'WebGL'</span>,
					width: <span class="number">500</span>
				},
				opts = extendObject(defaults, options),
				scene = <span class="keyword">new</span> THREE.Scene(),</pre></div></div>
            
        </li>
        
        
        <li id="section-197">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-197">&#182;</a>
              </div>
              <p>clock = new THREE.Clock(),</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				camera, renderer, controls, viewAngle, aspect, near, far;

		<span class="keyword">this</span>.options = opts;
		<span class="keyword">this</span>.scene = scene;</pre></div></div>
            
        </li>
        
        
        <li id="section-198">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-198">&#182;</a>
              </div>
              <h1 id="camera">Camera</h1>

            </div>
            
        </li>
        
        
        <li id="section-199">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-199">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>		viewAngle = <span class="number">45</span>;
		aspect = opts.width / opts.height;
		near = <span class="number">0.1</span>;
		far = <span class="number">20000</span>;

		camera = <span class="keyword">new</span> THREE.PerspectiveCamera(viewAngle, aspect, near, far);
		camera.position = to3js(opts.camera.position);
		camera.lookAt(to3js(opts.camera.lookAt));
		camera.up = <span class="keyword">new</span> THREE.Vector3(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>);
		scene.add(camera);</pre></div></div>
            
        </li>
        
        
        <li id="section-200">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-200">&#182;</a>
              </div>
              <h1 id="renderer">Renderer</h1>

            </div>
            
        </li>
        
        
        <li id="section-201">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-201">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>		renderer = <span class="keyword">new</span> THREE[opts.renderer + <span class="string">'Renderer'</span>]({antialias: <span class="literal">true</span>, preserveDrawingBuffer: <span class="literal">true</span>});</pre></div></div>
            
        </li>
        
        
        <li id="section-202">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-202">&#182;</a>
              </div>
              <p>Remove the warning message.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">this</span>.wrapper.innerHTML = <span class="string">''</span>;
		<span class="keyword">this</span>.wrapper.appendChild(renderer.domElement);</pre></div></div>
            
        </li>
        
        
        <li id="section-203">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-203">&#182;</a>
              </div>
              <p>Storing the the original renderer to recover it easily when leaving anaglyph mode</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">var</span> origRenderer = renderer;</pre></div></div>
            
        </li>
        
        
        <li id="section-204">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-204">&#182;</a>
              </div>
              <p>Overwrite the renderer with the anaglyph mode renderer</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (opts.anaglyphMode) {
			renderer = <span class="keyword">new</span> THREE.AnaglyphEffect(renderer);
		}

		renderer.setSize(opts.width, opts.height);</pre></div></div>
            
        </li>
        
        
        <li id="section-205">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-205">&#182;</a>
              </div>
              <h1 id="controls">Controls</h1>

            </div>
            
        </li>
        
        
        <li id="section-206">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-206">&#182;</a>
              </div>
              <p>Other possible values are: &#39;FirstPerson&#39;, &#39;Fly&#39;, &#39;Orbit&#39;, &#39;Path&#39;, &#39;Roll&#39;, &#39;Trackback&#39; or false
MathLib defaults to the TrackballControls
move mouse and left   click (or hold &#39;A&#39;) to rotate
               middle click (or hold &#39;S&#39;) to zoom
               right  click (or hold &#39;D&#39;) to pan</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (opts.controls) {
			controls = <span class="keyword">new</span> THREE[opts.controls + <span class="string">'Controls'</span>](camera, renderer.domElement);
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-207">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-207">&#182;</a>
              </div>
              <p>A update function for the controls doing nothing.
The function is called in the update function.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">else</span> {
			controls = {
				update: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>}
			};
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-208">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-208">&#182;</a>
              </div>
              <h1 id="light">Light</h1>

            </div>
            
        </li>
        
        
        <li id="section-209">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-209">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">var</span> light1 = <span class="keyword">new</span> THREE.PointLight(<span class="number">0xffffff</span>);
		light1.position.set(<span class="number">0</span>, <span class="number">0</span>, <span class="number">200</span>);
		scene.add(light1);
		<span class="keyword">var</span> light2 = <span class="keyword">new</span> THREE.PointLight(<span class="number">0xffffff</span>);
		light2.position.set(<span class="number">0</span>, <span class="number">0</span>, -<span class="number">200</span>);
		scene.add(light2);</pre></div></div>
            
        </li>
        
        
        <li id="section-210">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-210">&#182;</a>
              </div>
              <h1 id="background">Background</h1>

            </div>
            
        </li>
        
        
        <li id="section-211">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-211">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>		renderer.setClearColorHex(opts.background, <span class="number">1</span>);
		renderer.clear();</pre></div></div>
            
        </li>
        
        
        <li id="section-212">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-212">&#182;</a>
              </div>
              <h1 id="grid">Grid</h1>

            </div>
            
        </li>
        
        
        <li id="section-213">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-213">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (opts.grid) {
			<span class="keyword">this</span>.drawGrid();
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-214">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-214">&#182;</a>
              </div>
              <h1 id="axis">Axis</h1>

            </div>
            
        </li>
        
        
        <li id="section-215">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-215">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (opts.axis) {
			<span class="keyword">var</span> axis = <span class="keyword">new</span> THREE.AxisHelper(<span class="number">10</span>);
			scene.add(axis);
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-216">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-216">&#182;</a>
              </div>
              <h1 id="animate-the-scene">Animate the scene</h1>

            </div>
            
        </li>
        
        
        <li id="section-217">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-217">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="function"><span class="keyword">function</span> <span class="title">animate</span><span class="params">()</span> {</span>
			requestAnimationFrame(animate);
			render();
			update();
		}

		<span class="function"><span class="keyword">function</span> <span class="title">update</span><span class="params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-218">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-218">&#182;</a>
              </div>
              <p>var delta = clock.getDelta();</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			controls.update();
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-219">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-219">&#182;</a>
              </div>
              <p>Render the scene</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="function"><span class="keyword">function</span> <span class="title">render</span><span class="params">()</span> {</span>
			renderer.render(scene, camera);
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-220">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-220">&#182;</a>
              </div>
              <p>kick of the animation loop</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		animate();


		<span class="keyword">this</span>.options = opts;
		<span class="keyword">this</span>.element = renderer.domElement;
		<span class="keyword">this</span>.renderer = renderer;
		<span class="keyword">this</span>.camera = camera;

		<span class="keyword">this</span>.container.classList.add(<span class="string">'MathLib_screen3D'</span>);
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-221">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-221">&#182;</a>
              </div>
              <h3 id="screen3d-prototype-drawgrid">Screen3D.prototype.drawGrid</h3>
<p>Draws the grid.</p>
<p><em>@return {Screen3D}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>drawGrid() {
	<span class="keyword">if</span> (!<span class="keyword">this</span>.options.grid) {
		<span class="keyword">return</span> <span class="keyword">this</span>;
	}

	<span class="keyword">var</span> _<span class="keyword">this</span> = <span class="keyword">this</span>,
			gridDrawer = <span class="function"><span class="keyword">function</span> <span class="params">(opts, rotX, rotY)</span> {</span>
				<span class="keyword">var</span> size = <span class="number">10</span>,
						grid = <span class="keyword">new</span> THREE.Object3D(),
						color = <span class="keyword">new</span> THREE.Color(opts.color),
						i, ii;

				<span class="keyword">if</span> (opts.type === <span class="string">'cartesian'</span>) {
					<span class="keyword">var</span> tickX = <span class="string">'x'</span> <span class="keyword">in</span> opts.tick ? opts.tick.x : opts.tick.y,
							tickY = <span class="string">'z'</span> <span class="keyword">in</span> opts.tick ? opts.tick.z : opts.tick.y,
							lines = <span class="keyword">new</span> THREE.Shape();

					<span class="keyword">for</span> (i = -size; i &lt;= size; i += tickX) {
						lines.moveTo(-size, i);
						lines.lineTo(size, i);
					}

					<span class="keyword">for</span> (i = -size; i &lt;= size; i += tickY) {
						lines.moveTo(i, -size);
						lines.lineTo(i, size);
					}

					grid.add(<span class="keyword">new</span> THREE.Line(lines.createPointsGeometry(), <span class="keyword">new</span> THREE.LineBasicMaterial({color: color}), THREE.LinePieces));

					grid.rotation.x = rotX;
					grid.rotation.y = rotY;

					_<span class="keyword">this</span>.scene.add(grid);
				}

				<span class="keyword">else</span> <span class="keyword">if</span> (opts.type === <span class="string">'polar'</span>) {

					<span class="keyword">var</span> circles = <span class="keyword">new</span> THREE.Shape(),
							rays = <span class="keyword">new</span> THREE.Shape();

					<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= size; i += opts.tick.r) {
						circles.moveTo(i, <span class="number">0</span>);
						circles.absarc(<span class="number">0</span>, <span class="number">0</span>, i, <span class="number">0</span>, <span class="number">2</span> * Math.PI + <span class="number">0.001</span>, <span class="literal">false</span>);
					}
					grid.add(<span class="keyword">new</span> THREE.Line(circles.createPointsGeometry(),
											<span class="keyword">new</span> THREE.LineBasicMaterial({color: color})));

					<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="number">2</span> * Math.PI; i &lt; ii; i += opts.angle) {
						rays.moveTo(<span class="number">0</span>, <span class="number">0</span>);
						rays.lineTo(size * Math.cos(i), size * Math.sin(i));
					}

					grid.add(<span class="keyword">new</span> THREE.Line(rays.createPointsGeometry(), <span class="keyword">new</span> THREE.LineBasicMaterial({color: color})));

					grid.rotation.x = rotX;
					grid.rotation.y = rotY;

					_<span class="keyword">this</span>.scene.add(grid);

				}
			};


	gridDrawer(<span class="keyword">this</span>.options.grid.xy, <span class="number">0</span>, <span class="number">0</span>);
	gridDrawer(<span class="keyword">this</span>.options.grid.xz, Math.PI / <span class="number">2</span>, <span class="number">0</span>);
	gridDrawer(<span class="keyword">this</span>.options.grid.yz, <span class="number">0</span>, Math.PI / <span class="number">2</span>);

	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-222">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-222">&#182;</a>
              </div>
              <h3 id="matrix-parametricplot3d-">Matrix.parametricPlot3D()</h3>
<p><em>@param {function}</em> The function which is called on every argument<br><em>@return {Screen3D}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>parametricPlot3D(f, options) : Screen3D {

	<span class="keyword">var</span> defaults = {
				closed: <span class="literal">false</span>,
				debug: <span class="literal">false</span>,
				min: <span class="number">0</span>,
				max: <span class="number">1</span>,
				pointNum: <span class="number">1000</span>,
				radius: <span class="number">0.05</span>,
				segmentsRadius: <span class="number">6</span>,
				material: {
					type: <span class="string">'MeshLambert'</span>
				}
			},
			opts = extendObject(defaults, options),


			Curve = THREE.Curve.create(
				<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>},
				<span class="function"><span class="keyword">function</span> <span class="params">(t)</span> {</span>
					t = (opts.max - opts.min) * t + opts.min;
					<span class="keyword">var</span> ft = f(t);
					<span class="keyword">return</span> <span class="keyword">new</span> THREE.Vector3(ft[<span class="number">0</span>], ft[<span class="number">1</span>], ft[<span class="number">2</span>]);
				}
			),
		

			mesh = <span class="keyword">new</span> THREE.Mesh(
				<span class="keyword">new</span> THREE.TubeGeometry(<span class="keyword">new</span> Curve(), opts.pointNum, opts.radius, opts.segmentsRadius, opts.closed, opts.debug),
				<span class="keyword">new</span> THREE[opts.material.type + <span class="string">'Material'</span>](opts.material)
			);


	<span class="keyword">this</span>.scene.add(mesh);


	<span class="comment">/*
	guiObj = {
		color: [mesh.material.color.r, mesh.material.color.g, mesh.material.color.b]
	};


	var folder = _3D.datGUI.addFolder(options.name);
	folder.add(mesh, 'visible');
	folder.addColor(guiObj, 'color')
		.onChange(function (value) {mesh.material.color.setRGB(value[0] / 255, value[1] / 255, value[2] / 255);});
	*/</span>

	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-223">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-223">&#182;</a>
              </div>
              <h3 id="screen3d-prototype-plot3d-">Screen3D.prototype.plot3D()</h3>
<p><em>@param {function}</em> The map for the height<br><em>@param {object}</em> Options<br><em>@return {Screen3D}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>plot3D(f, options) : Screen3D {
	<span class="keyword">return</span> <span class="keyword">this</span>.surfacePlot3D(<span class="function"><span class="keyword">function</span> <span class="params">(u, v)</span> {</span>
		<span class="keyword">return</span> [u, v, f(u, v)];
	},
	options);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-224">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-224">&#182;</a>
              </div>
              <h3 id="screen3d-prototype-resize-">Screen3D.prototype.resize()</h3>
<p>Adjust the rendering if the screen is resized</p>
<p><em>@param {number}</em> The new width<br><em>@param {number}</em> The new height<br><em>@return {Screen3D}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>resize(width : number, height : number) : Screen3D {
	<span class="keyword">this</span>.renderer.setSize(width, height);
	<span class="keyword">this</span>.camera.aspect = width / height;
	<span class="keyword">this</span>.camera.updateProjectionMatrix();

	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-225">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-225">&#182;</a>
              </div>
              <h3 id="screen3d-prototype-surfaceplot-">screen3D.prototype.surfacePlot()</h3>
<p><em>@param {function}</em> The map for the surface<br><em>@param {object}</em> Options<br><em>@return {Screen3D}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>surfacePlot3D(f, options) : Screen3D {
	<span class="keyword">var</span> defaults = {
				material: {
					type: <span class="string">'MeshLambert'</span>
				},
				pointNumX: <span class="number">100</span>,
				pointNumY: <span class="number">100</span>,
				xmin: <span class="number">0</span>,
				xmax: <span class="number">1</span>,
				ymin: <span class="number">0</span>,
				ymax: <span class="number">1</span>
			},
			opts = extendObject(defaults, options),
			map = <span class="function"><span class="keyword">function</span> <span class="params">(u, v)</span> {</span>
				u = (opts.xmax - opts.xmin) * u + opts.xmin;
				v = (opts.ymax - opts.ymin) * v + opts.ymin;
				<span class="keyword">var</span> fuv = f(u, v);
				<span class="keyword">return</span> <span class="keyword">new</span> THREE.Vector3(fuv[<span class="number">0</span>], fuv[<span class="number">1</span>], fuv[<span class="number">2</span>]);
			},
			material = <span class="keyword">new</span> THREE[opts.material.type + <span class="string">'Material'</span>](opts.material),
			mesh;

			material.side = THREE.DoubleSide;

			mesh = <span class="keyword">new</span> THREE.Mesh(
				<span class="keyword">new</span> THREE.ParametricGeometry(map, opts.pointNumX, opts.pointNumY, <span class="literal">false</span>),
				material
			);

	<span class="keyword">this</span>.scene.add(mesh);</pre></div></div>
            
        </li>
        
        
        <li id="section-226">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-226">&#182;</a>
              </div>
              <p>if (options.datGUI) {
  guiObj = {
    color: [mesh.material.color.r, mesh.material.color.g, mesh.material.color.b]
  };</p>
<p>  var folder = _3D.datGUI.addFolder(options.datGUI.name);
  if (options.datGUI.visible) {
    folder.add(mesh, &#39;visible&#39;);
  }</p>
<p>  if (options.datGUI.wireframe) {
    folder.add(mesh.material, &#39;wireframe&#39;);
  }</p>
<p>  if (options.datGUI.color) {
    color = mesh.material.color.getHex();
    var guiObj = {
      color: color
    };</p>
<pre><code>folder.addColor(guiObj, &#39;color&#39;).name(&#39;color&#39;)
  .onChange(function (value) {mesh.material.color = new THREE.Color(value);});</code></pre>
<p>  }
}</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">return</span> <span class="keyword">this</span>;
}


}<span class="comment">// ## &lt;a id="Vector" href="http://mathlib.de/en/docs/Vector"&gt;Vector&lt;/a&gt;</span></pre></div></div>
            
        </li>
        
        
        <li id="section-227">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-227">&#182;</a>
              </div>
              <p>The vector implementation of MathLib makes calculations with vectors of
arbitrary size possible. The entries of the vector can be numbers and complex
numbers.</p>
<p>It is as easy as
<code>new MathLib.Vector([1, 2, 3])</code>
to create the following vector:<br>   ⎛ 1 ⎞<br>   ⎜ 2 ⎟<br>   ⎝ 3 ⎠</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>export class Vector {
	type = <span class="string">'vector'</span>;

	length: number;

	constructor (coords: number[]) {
		coords.forEach((x, i) =&gt; {<span class="keyword">this</span>[i] = x;});
		<span class="keyword">this</span>.length = coords.length;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-228">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-228">&#182;</a>
              </div>
              <h3 id="-vector-prototype-arelinearindependent-http-mathlib-de-en-docs-vector-arelinearindependent-"><a href="http://mathlib.de/en/docs/Vector/areLinearIndependent">Vector.prototype.areLinearIndependent()</a></h3>
<p>Checks if the vectors are linear independent.</p>
<p><em>@param {array}</em> An array containing the vectors.<br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static areLinearIndependent = <span class="function"><span class="keyword">function</span> <span class="params">(v : Vector[])</span> : <span class="title">boolean</span> {</span>
	<span class="keyword">var</span> n = v.length,
			m = v[<span class="number">0</span>].length;

	<span class="keyword">if</span> (n &gt; m) {
		<span class="keyword">return</span> <span class="literal">false</span>;
	}

	<span class="keyword">if</span> (! v.every(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> x.length === m;
		}) ) {
		<span class="keyword">return</span> <span class="literal">undefined</span>;
	}

	<span class="keyword">return</span> (<span class="keyword">new</span> MathLib.Matrix(v)).rank() === n;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-229">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-229">&#182;</a>
              </div>
              <h3 id="-vector-prototype-compare-http-mathlib-de-en-docs-vector-compare-"><a href="http://mathlib.de/en/docs/Vector/compare">Vector.prototype.compare()</a></h3>
<p>Compares two vectors.</p>
<p><em>@param {Vector}</em> The vector to compare<br><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>compare(v : Vector) : number {
	<span class="keyword">var</span> i, ii;

	<span class="keyword">if</span> (<span class="keyword">this</span>.length !== v.length) {
		<span class="keyword">return</span> MathLib.sign(<span class="keyword">this</span>.length - v.length);
	}

	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.length; i &lt; ii; i++) {
		<span class="keyword">if</span> (v[i] - <span class="keyword">this</span>[i]) {
			<span class="keyword">return</span> MathLib.sign(<span class="keyword">this</span>[i] - v[i]);
		}
	}

	<span class="keyword">return</span> <span class="number">0</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-230">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-230">&#182;</a>
              </div>
              <h3 id="-vector-prototype-every-http-mathlib-de-en-docs-vector-every-"><a href="http://mathlib.de/en/docs/Vector/every">Vector.prototype.every()</a></h3>
<p>Works like Array.prototype.every.</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>every(f : (value : any, index : number, vector : Vector ) =&gt; boolean) : boolean {
	<span class="keyword">return</span> Array.prototype.every.call(<span class="keyword">this</span>, f);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-231">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-231">&#182;</a>
              </div>
              <h3 id="-vector-prototype-foreach-http-mathlib-de-en-docs-vector-foreach-"><a href="http://mathlib.de/en/docs/Vector/forEach">Vector.prototype.forEach()</a></h3>
<p>Works like Array.prototype.forEach.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>forEach(f : (value : any, index : number, vector : Vector ) =&gt; <span class="keyword">void</span>) : <span class="keyword">void</span> {
	Array.prototype.forEach.call(<span class="keyword">this</span>, f);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-232">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-232">&#182;</a>
              </div>
              <h3 id="-vector-prototype-isequal-http-mathlib-de-en-docs-vector-isequal-"><a href="http://mathlib.de/en/docs/Vector/isEqual">Vector.prototype.isEqual()</a></h3>
<p>Determines if two vectors are equal</p>
<p><em>@param {Vector}</em> v The vector to compare<br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isEqual(v : Vector) : boolean {
	<span class="keyword">if</span> (<span class="keyword">this</span>.length !== v.length) {
		<span class="keyword">return</span> <span class="literal">false</span>;
	}

	<span class="keyword">return</span> <span class="keyword">this</span>.every(<span class="function"><span class="keyword">function</span> <span class="params">(x, i)</span> {</span>
		<span class="keyword">return</span> MathLib.isEqual(x, v[i]);
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-233">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-233">&#182;</a>
              </div>
              <h3 id="-vector-prototype-iszero-http-mathlib-de-en-docs-vector-iszero-"><a href="http://mathlib.de/en/docs/Vector/isZero">Vector.prototype.isZero()</a></h3>
<p>Determines if the vector is the zero vector.</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isZero() : boolean {
	<span class="keyword">return</span> <span class="keyword">this</span>.every(MathLib.isZero);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-234">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-234">&#182;</a>
              </div>
              <h3 id="-vector-prototype-map-http-mathlib-de-en-docs-vector-map-"><a href="http://mathlib.de/en/docs/Vector/map">Vector.prototype.map()</a></h3>
<p>Works like Array.prototype.map.</p>
<p><em>@param {function}</em><br><em>@return {Vector}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>map(f : (value : any, index : number, vector : Vector ) =&gt; any) : any {
	<span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">this</span>[<span class="string">'constructor'</span>](Array.prototype.map.call(<span class="keyword">this</span>, f));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-235">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-235">&#182;</a>
              </div>
              <h3 id="-vector-prototype-minus-http-mathlib-de-en-docs-vector-minus-"><a href="http://mathlib.de/en/docs/Vector/minus">Vector.prototype.minus()</a></h3>
<p>Calculates the difference of two vectors.</p>
<p><em>@param {Vector}</em> The vector to be subtracted.<br><em>@return {Vector}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>minus(v : Vector) : Vector {
	<span class="keyword">if</span> (<span class="keyword">this</span>.length === v.length) {
		<span class="keyword">return</span> <span class="keyword">this</span>.plus(v.negative());
	}
	<span class="keyword">else</span> {
		MathLib.error({message: <span class="string">'Vector sizes not matching'</span>, method: <span class="string">'Vector#minus'</span>});
		<span class="keyword">return</span>;
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-236">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-236">&#182;</a>
              </div>
              <h3 id="-vector-prototype-negative-http-mathlib-de-en-docs-vector-negative-"><a href="http://mathlib.de/en/docs/Vector/negative">Vector.prototype.negative()</a></h3>
<p>Returns the negative vector.</p>
<p><em>@return {Vector}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>negative() : Vector {
	<span class="keyword">return</span> <span class="keyword">this</span>.map(MathLib.negative);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-237">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-237">&#182;</a>
              </div>
              <h3 id="-vector-prototype-norm-http-mathlib-de-en-docs-vector-norm-"><a href="http://mathlib.de/en/docs/Vector/norm">Vector.prototype.norm()</a></h3>
<p>Calcultes the norm of the vector.</p>
<p><em>@param {number}</em> [default=2] The p for the p-norm<br><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>norm(p = <span class="number">2</span>) : number {
	<span class="keyword">if</span> (p === <span class="number">2</span>) {
		<span class="keyword">return</span> MathLib.hypot.apply(<span class="literal">null</span>, <span class="keyword">this</span>.toArray());
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (p === <span class="literal">Infinity</span>) {
		<span class="keyword">return</span> Math.max.apply(<span class="literal">null</span>, <span class="keyword">this</span>.map(Math.abs).toArray());
	}
	<span class="keyword">else</span> {
		<span class="keyword">return</span> MathLib.root(<span class="keyword">this</span>.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(prev, curr)</span> {</span>
			<span class="keyword">return</span> prev + Math.pow(Math.abs(curr), p);
		}, <span class="number">0</span>), p);
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-238">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-238">&#182;</a>
              </div>
              <h3 id="-vector-prototype-outerproduct-http-mathlib-de-en-docs-vector-outerproduct-"><a href="http://mathlib.de/en/docs/Vector/outerProduct">Vector.prototype.outerProduct()</a></h3>
<p>Calculates the outer product of two vectors.</p>
<p><em>@param {Vector}</em><br><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>outerProduct(v : Vector) : Matrix {
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Matrix(<span class="keyword">this</span>.map(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> v.map(<span class="function"><span class="keyword">function</span> <span class="params">(y)</span> {</span>
			<span class="keyword">return</span> MathLib.times(x, y);
		});
	}));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-239">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-239">&#182;</a>
              </div>
              <h3 id="-vector-prototype-plus-http-mathlib-de-en-docs-vector-plus-"><a href="http://mathlib.de/en/docs/Vector/plus">Vector.prototype.plus()</a></h3>
<p>Calculates the sum of two vectors.</p>
<p><em>@param {Vector}</em><br><em>@return {Vector}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>plus(v : Vector) : Vector {
	<span class="keyword">if</span> (<span class="keyword">this</span>.length === v.length) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Vector(<span class="keyword">this</span>.map(<span class="function"><span class="keyword">function</span> <span class="params">(x, i)</span> {</span>
			<span class="keyword">return</span> MathLib.plus(x, v[i]);
		}));
	}
	<span class="keyword">else</span> {
		MathLib.error({message: <span class="string">'Vector sizes not matching'</span>, method: <span class="string">'Vector#plus'</span>});
		<span class="keyword">return</span>;
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-240">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-240">&#182;</a>
              </div>
              <h3 id="-vector-prototype-reduce-http-mathlib-de-en-docs-vector-reduce-"><a href="http://mathlib.de/en/docs/Vector/reduce">Vector.prototype.reduce()</a></h3>
<p>Works like Array.prototype.reduce.</p>
<p><em>@return {any}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>reduce(...args : any[]) : any {
	<span class="keyword">return</span> Array.prototype.reduce.apply(<span class="keyword">this</span>, args);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-241">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-241">&#182;</a>
              </div>
              <h3 id="-vector-prototype-scalarproduct-http-mathlib-de-en-docs-vector-scalarproduct-"><a href="http://mathlib.de/en/docs/Vector/scalarProduct">Vector.prototype.scalarProduct()</a></h3>
<p>Calculates the scalar product of two vectors.</p>
<p><em>@param {Vector}</em><br><em>@return {number|Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>scalarProduct(v : Vector) : any {
	<span class="keyword">if</span> (<span class="keyword">this</span>.length === v.length) {
		<span class="keyword">return</span> <span class="keyword">this</span>.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(old, cur, i, w)</span> {</span>
			<span class="keyword">return</span> MathLib.plus(old, MathLib.times(w[i], v[i]));
		}, <span class="number">0</span>);
	}
	<span class="keyword">else</span> {
		MathLib.error({message: <span class="string">'Vector sizes not matching'</span>, method: <span class="string">'Vector#scalarProduct'</span>});
		<span class="keyword">return</span>;
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-242">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-242">&#182;</a>
              </div>
              <h3 id="-vector-prototype-slice-http-mathlib-de-en-docs-vector-slice-"><a href="http://mathlib.de/en/docs/Vector/slice">Vector.prototype.slice()</a></h3>
<p>Works like the Array.prototype.slice function</p>
<p><em>@return {array}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>slice(...args : any[]) : any[] {
	<span class="keyword">return</span> Array.prototype.slice.apply(<span class="keyword">this</span>, args);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-243">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-243">&#182;</a>
              </div>
              <h3 id="-vector-prototype-times-http-mathlib-de-en-docs-vector-times-"><a href="http://mathlib.de/en/docs/Vector/times">Vector.prototype.times()</a></h3>
<p>Multiplies the vector by a (complex) number or a matrix.
The vector is multiplied from left to the matrix. 
If you want to multiply it from the right use
matrix.times(vector) instead of vector.times(matrix)</p>
<p><em>@param {number|Complex|Matrix}</em><br><em>@return {Vector}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>times(n : any) : any {
	<span class="keyword">var</span> i, ii, colVectors,
			product = [];
	<span class="keyword">if</span> (n.type === <span class="string">'rational'</span>) {
		n = n.toNumber(); 
	}
	<span class="keyword">if</span> (<span class="keyword">typeof</span> n === <span class="string">'number'</span> || n.type === <span class="string">'complex'</span>) {
		<span class="keyword">return</span> <span class="keyword">this</span>.map(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
			<span class="keyword">return</span> MathLib.times(n, x);
		});
	}
	<span class="keyword">if</span> (n.type === <span class="string">'matrix'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.length === n.rows) {
			colVectors = n.toColVectors();
			<span class="keyword">for</span> (i = <span class="number">0</span>, ii = colVectors.length; i &lt; ii; i++) {
				product[i] = <span class="keyword">this</span>.scalarProduct(colVectors[i]);
			}
			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Vector(product);
		}
		<span class="keyword">else</span> {
			MathLib.error({message: <span class="string">'Vector/Matrix sizes not matching'</span>, method: <span class="string">'Vector#times'</span>});
			<span class="keyword">return</span>;
		}
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-244">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-244">&#182;</a>
              </div>
              <h3 id="-vector-prototype-toarray-http-mathlib-de-en-docs-vector-toarray-"><a href="http://mathlib.de/en/docs/Vector/toArray">Vector.prototype.toArray()</a></h3>
<p>Converts the vector to an array.</p>
<p><em>@return {array}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toArray() : any[] {
	<span class="keyword">return</span> Array.prototype.slice.call(<span class="keyword">this</span>);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-245">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-245">&#182;</a>
              </div>
              <h3 id="-vector-prototype-tocontentmathml-http-mathlib-de-en-docs-vector-tocontentmathml-"><a href="http://mathlib.de/en/docs/Vector/toContentMathML">Vector.prototype.toContentMathML()</a></h3>
<p>Returns the content MathML representation of the vector.</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toContentMathML() : string {
	<span class="keyword">return</span> <span class="keyword">this</span>.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(old, cur)</span> {</span>
		<span class="keyword">return</span> old + MathLib.toContentMathML(cur);
	}, <span class="string">'&lt;vector&gt;'</span>) + <span class="string">'&lt;/vector&gt;'</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-246">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-246">&#182;</a>
              </div>
              <h3 id="-vector-prototype-tolatex-http-mathlib-de-en-docs-vector-tolatex-"><a href="http://mathlib.de/en/docs/Vector/toLaTeX">Vector.prototype.toLaTeX()</a></h3>
<p>Returns a LaTeX representation of the vector.</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toLaTeX() : string {
	<span class="keyword">return</span> <span class="string">'\\begin{pmatrix}\n\t'</span> + <span class="keyword">this</span>.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(old, cur)</span> {</span>
		<span class="keyword">return</span> old + <span class="string">'\\\\\n\t'</span> + MathLib.toLaTeX(cur);
	}) + <span class="string">'\n\\end{pmatrix}'</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-247">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-247">&#182;</a>
              </div>
              <h3 id="-vector-prototype-tomathml-http-mathlib-de-en-docs-vector-tomathml-"><a href="http://mathlib.de/en/docs/Vector/toMathML">Vector.prototype.toMathML()</a></h3>
<p>Returns the (presentation) MathML representation of the vector.</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toMathML() : string {
	<span class="keyword">return</span> <span class="keyword">this</span>.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(old, cur)</span> {</span>
		<span class="keyword">return</span> old + <span class="string">'&lt;mtr&gt;&lt;mtd&gt;'</span> + MathLib.toMathML(cur) + <span class="string">'&lt;/mtd&gt;&lt;/mtr&gt;'</span>;
	}, <span class="string">'&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mtable&gt;'</span>) + <span class="string">'&lt;/mtable&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;'</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-248">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-248">&#182;</a>
              </div>
              <h3 id="-vector-prototype-tostring-http-mathlib-de-en-docs-vector-tostring-"><a href="http://mathlib.de/en/docs/Vector/toString">Vector.prototype.toString()</a></h3>
<p>Returns a string representation of the vector.</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toString() : string {
	<span class="keyword">return</span> <span class="string">'('</span> + <span class="keyword">this</span>.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(old, cur)</span> {</span>
		<span class="keyword">return</span> old + <span class="string">', '</span> + MathLib.toString(cur);
	}) + <span class="string">')'</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-249">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-249">&#182;</a>
              </div>
              <h3 id="-vector-prototype-vectorproduct-http-mathlib-de-en-docs-vector-vectorproduct-"><a href="http://mathlib.de/en/docs/Vector/vectorProduct">Vector.prototype.vectorProduct()</a></h3>
<p>Calculates the vector product of two vectors.</p>
<p><em>@param {Vector}</em><br><em>@return {Vector}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>vectorProduct(v : Vector) : Vector {
	<span class="comment">/* TODO: Implement vectorproduct for non three-dimensional vectors */</span>
	<span class="keyword">if</span> (<span class="keyword">this</span>.length === <span class="number">3</span> &amp;&amp; v.length === <span class="number">3</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Vector([
			MathLib.minus(MathLib.times(<span class="keyword">this</span>[<span class="number">1</span>], v[<span class="number">2</span>]), MathLib.times(<span class="keyword">this</span>[<span class="number">2</span>], v[<span class="number">1</span>])),
			MathLib.minus(MathLib.times(<span class="keyword">this</span>[<span class="number">2</span>], v[<span class="number">0</span>]), MathLib.times(<span class="keyword">this</span>[<span class="number">0</span>], v[<span class="number">2</span>])),
			MathLib.minus(MathLib.times(<span class="keyword">this</span>[<span class="number">0</span>], v[<span class="number">1</span>]), MathLib.times(<span class="keyword">this</span>[<span class="number">1</span>], v[<span class="number">0</span>]))
		]);
	}
	<span class="keyword">else</span> {
		MathLib.error({message: <span class="string">'Vectors are not three-dimensional'</span>, method: <span class="string">'Vector#vectorProduct'</span>});
		<span class="keyword">return</span>;
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-250">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-250">&#182;</a>
              </div>
              <h3 id="-vector-prototype-zero-http-mathlib-de-en-docs-vector-zero-"><a href="http://mathlib.de/en/docs/Vector/zero">Vector.prototype.zero()</a></h3>
<p>Returns a zero vector of given size.</p>
<p><em>@param {number}</em> The number of entries in the vector.<br><em>@return {Vector}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static zero = <span class="function"><span class="keyword">function</span> <span class="params">(n : number)</span> : <span class="title">Vector</span> {</span>
	<span class="keyword">var</span> vector = [], i;
	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++) {
		vector.push(<span class="number">0</span>);
	}
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Vector(vector);
}


}<span class="comment">// ## &lt;a id="Circle" href="http://mathlib.de/en/docs/Circle"&gt;Circle&lt;/a&gt;</span></pre></div></div>
            
        </li>
        
        
        <li id="section-251">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-251">&#182;</a>
              </div>
              <p>MathLib.Circle expects two arguments.
First the center in the form of an Array or a MathLib.point.
The second argument should be the radius of the circle.</p>
<h4 id="simple-use-case-">Simple use case:</h4>
<pre><code>// Create a circle with center (1, 2) and radius 3.  
var c = new MathLib.Circle([1, 2], 3);  
c.center                   // The center of the circle (point)  
c.radius                   // returns the radius of the circle</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>export class Circle {

	type = <span class="string">'circle'</span>;

	center: Point;
	radius: number;

	constructor (center: any, radius: number) {

		<span class="keyword">if</span> (center.type === <span class="literal">undefined</span>) {
			center = <span class="keyword">new</span> MathLib.Point(center.concat(<span class="number">1</span>));
		}

		<span class="keyword">this</span>.center = center;
		<span class="keyword">this</span>.radius = radius;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-252">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-252">&#182;</a>
              </div>
              <h3 id="-circle-prototype-area-http-mathlib-de-en-docs-circle-area-"><a href="http://mathlib.de/en/docs/Circle/area">Circle.prototype.area()</a></h3>
<p>Calculates the area of the circle.</p>
<p><em>@return {number}</em> The area of the circle</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>area() : number {
	<span class="keyword">return</span> <span class="keyword">this</span>.radius * <span class="keyword">this</span>.radius * Math.PI;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-253">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-253">&#182;</a>
              </div>
              <h3 id="-circle-prototype-circumference-http-mathlib-de-en-docs-circle-circumference-"><a href="http://mathlib.de/en/docs/Circle/circumference">Circle.prototype.circumference()</a></h3>
<p>Calculates the circumference of the circle.</p>
<p><em>@return {number}</em> The circumference of the circle</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>circumference() : number {
	<span class="keyword">return</span> <span class="number">2</span> * <span class="keyword">this</span>.radius * Math.PI;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-254">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-254">&#182;</a>
              </div>
              <h3 id="-circle-prototype-compare-http-mathlib-de-en-docs-circle-compare-"><a href="http://mathlib.de/en/docs/Circle/compare">Circle.prototype.compare()</a></h3>
<p>Compares two circles</p>
<p><em>@param {Circle}</em> The circle to compare<br><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>compare(c : Circle) : number {
	<span class="keyword">return</span> MathLib.sign(<span class="keyword">this</span>.center.compare(c.center)) || MathLib.sign(<span class="keyword">this</span>.radius - c.radius);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-255">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-255">&#182;</a>
              </div>
              <h3 id="-circle-prototype-draw-http-mathlib-de-en-docs-circle-draw-"><a href="http://mathlib.de/en/docs/Circle/draw">Circle.prototype.draw()</a></h3>
<p>Draw the circle onto the screen.</p>
<p><em>@param {Screen}</em> The screen to draw onto.<br><em>@param {object}</em> Optional drawing options<br><em>@return {Circle}</em> Returns the circle for chaining</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>draw(screen, options) {
	<span class="keyword">if</span> (Array.isArray(screen)) {
		<span class="keyword">var</span> circle = <span class="keyword">this</span>;
		screen.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
			x.circle(circle, options);
		});
	}
	<span class="keyword">else</span> {
		screen.circle(<span class="keyword">this</span>, options);
	}
	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-256">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-256">&#182;</a>
              </div>
              <h3 id="-circle-prototype-isequal-http-mathlib-de-en-docs-circle-isequal-"><a href="http://mathlib.de/en/docs/Circle/isEqual">Circle.prototype.isEqual()</a></h3>
<p>Checks if two circles are equal</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isEqual(c: Circle) : boolean {
	<span class="keyword">return</span> MathLib.isEqual(<span class="keyword">this</span>.radius, c.radius) &amp;&amp; <span class="keyword">this</span>.center.isEqual(c.center);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-257">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-257">&#182;</a>
              </div>
              <h3 id="-circle-prototype-positionof-http-mathlib-de-en-docs-circle-positionof-"><a href="http://mathlib.de/en/docs/Circle/positionOf">Circle.prototype.positionOf()</a></h3>
<p>Determine if a point is in, on or outside a circle.</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>positionOf(p) : string {
	<span class="keyword">var</span> diff;
	<span class="keyword">if</span> (p.type === <span class="string">'point'</span> &amp;&amp; p.dimension === <span class="number">2</span>) {
		diff = p.distanceTo(<span class="keyword">this</span>.center) - <span class="keyword">this</span>.radius;
		<span class="keyword">if</span> (MathLib.isZero(diff)) {
			<span class="keyword">return</span> <span class="string">'on'</span>;
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (diff &lt; <span class="number">0</span>) {
			<span class="keyword">return</span> <span class="string">'in'</span>;
		}
		<span class="keyword">else</span> {
			<span class="keyword">return</span> <span class="string">'out'</span>;
		}
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-258">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-258">&#182;</a>
              </div>
              <h3 id="-circle-prototype-reflectat-http-mathlib-de-en-docs-circle-reflectat-"><a href="http://mathlib.de/en/docs/Circle/reflectAt">Circle.prototype.reflectAt()</a></h3>
<p>Reflect the circle at a point or line</p>
<p><em>@return {Circle}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>reflectAt(a) : Circle {
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Circle(<span class="keyword">this</span>.center.reflectAt(a), <span class="keyword">this</span>.radius);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-259">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-259">&#182;</a>
              </div>
              <h3 id="-circle-prototype-tolatex-http-mathlib-de-en-docs-circle-tolatex-"><a href="http://mathlib.de/en/docs/Circle/toLaTeX">Circle.prototype.toLaTeX()</a></h3>
<p>Returns a LaTeX expression of the circle</p>
<p><em>@return {string}</em> </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toLaTeX() : string {
	<span class="keyword">return</span> <span class="string">'B_{'</span> + MathLib.toLaTeX(<span class="keyword">this</span>.radius) + <span class="string">'}\\left('</span> + <span class="keyword">this</span>.center.toLaTeX() + <span class="string">'\\right)'</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-260">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-260">&#182;</a>
              </div>
              <h3 id="-circle-prototype-tomatrix-http-mathlib-de-en-docs-circle-tomatrix-"><a href="http://mathlib.de/en/docs/Circle/toMatrix">Circle.prototype.toMatrix()</a></h3>
<p>Converts the circle to the corresponding matrix.</p>
<p><em>@return {Matrix}</em> </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toMatrix() : Matrix {
	<span class="keyword">var</span> x = <span class="keyword">this</span>.center[<span class="number">0</span>] / <span class="keyword">this</span>.center[<span class="number">2</span>],
			y = <span class="keyword">this</span>.center[<span class="number">1</span>] / <span class="keyword">this</span>.center[<span class="number">2</span>],
			r = <span class="keyword">this</span>.radius;
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Matrix([[<span class="number">1</span>, <span class="number">0</span>, -x], [<span class="number">0</span>, <span class="number">1</span>, -y], [-x, -y, x * x + y * y - r * r]]);
}


}<span class="comment">// ## &lt;a id="Complex"&gt;&lt;/a&gt;Complex</span></pre></div></div>
            
        </li>
        
        
        <li id="section-261">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-261">&#182;</a>
              </div>
              <p>MathLib.Complex is the MathLib implementation of complex numbers.</p>
<p>There are two ways of defining complex numbers:</p>
<ul>
<li>Two numbers representing the real and the complex part.</li>
<li>MathLib.Complex.polar(abs, arg)</li>
</ul>
<h4 id="simple-example-">Simple example:</h4>
<pre><code>// Create the complex number 1 + 2i  
var c = new MathLib.Complex(1, 2);</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>export class Complex {

	type = <span class="string">'complex'</span>;

	re: number;
	im: number;

	constructor (re: number, im = <span class="number">0</span>) {
		<span class="keyword">if</span> (MathLib.isNaN(re) || MathLib.isNaN(im)) {
			<span class="keyword">this</span>.re = <span class="literal">NaN</span>;
			<span class="keyword">this</span>.im = <span class="literal">NaN</span>;
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (!MathLib.isFinite(re) || !MathLib.isFinite(im)) {
			<span class="keyword">this</span>.re = <span class="literal">Infinity</span>;
			<span class="keyword">this</span>.im = <span class="literal">Infinity</span>;
		}
		<span class="keyword">else</span> {
			<span class="keyword">this</span>.re = re;		
			<span class="keyword">this</span>.im = im;
		}
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-262">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-262">&#182;</a>
              </div>
              <h3 id="-complex-prototype-abs-http-mathlib-de-en-docs-complex-abs-"><a href="http://mathlib.de/en/docs/Complex/abs">Complex.prototype.abs()</a></h3>
<p>Returns the absolute value of the number.</p>
<p><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>abs() : number {
	<span class="keyword">return</span> MathLib.hypot(<span class="keyword">this</span>.re, <span class="keyword">this</span>.im);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-263">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-263">&#182;</a>
              </div>
              <h3 id="-complex-prototype-arccos-http-mathlib-de-en-docs-complex-arccos-"><a href="http://mathlib.de/en/docs/Complex/arccos">Complex.prototype.arccos()</a></h3>
<p>Returns the inverse cosine of the number.</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>arccos() : Complex {
	<span class="keyword">return</span> MathLib.minus(Math.PI / <span class="number">2</span>, <span class="keyword">this</span>.arcsin());
}</pre></div></div>
            
        </li>
        
        
        <li id="section-264">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-264">&#182;</a>
              </div>
              <h3 id="-complex-prototype-arccot-http-mathlib-de-en-docs-complex-arccot-"><a href="http://mathlib.de/en/docs/Complex/arccot">Complex.prototype.arccot()</a></h3>
<p>Returns the inverse cotangent of the number.</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>arccot() : Complex {
	<span class="keyword">if</span> (<span class="keyword">this</span>.isZero()) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(MathLib.sign(<span class="number">1</span>/<span class="keyword">this</span>.re) * Math.PI / <span class="number">2</span>, -<span class="keyword">this</span>.im);
	}
	<span class="keyword">return</span> <span class="keyword">this</span>.inverse().arctan();</pre></div></div>
            
        </li>
        
        
        <li id="section-265">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-265">&#182;</a>
              </div>
              <p>var c = this.arctan();
console.log(c.toString());
return new MathLib.Complex(Math.PI / 2 - c.re, c.im);
return MathLib.minus(Math.PI / 2, this.arctan());</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>}</pre></div></div>
            
        </li>
        
        
        <li id="section-266">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-266">&#182;</a>
              </div>
              <h3 id="-complex-prototype-arccsc-http-mathlib-de-en-docs-complex-arccsc-"><a href="http://mathlib.de/en/docs/Complex/arccsc">Complex.prototype.arccsc()</a></h3>
<p>Returns the inverse cosecant of the number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>arccsc() : Complex {</pre></div></div>
            
        </li>
        
        
        <li id="section-267">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-267">&#182;</a>
              </div>
              <p>arccsc(0) = ComplexInfinity not ComplexNaN</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (<span class="keyword">this</span>.isZero()) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="literal">Infinity</span>);
	}

	<span class="keyword">return</span> <span class="keyword">this</span>.inverse().arcsin();
}</pre></div></div>
            
        </li>
        
        
        <li id="section-268">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-268">&#182;</a>
              </div>
              <h3 id="-complex-prototype-arcsec-http-mathlib-de-en-docs-complex-arcsec-"><a href="http://mathlib.de/en/docs/Complex/arcsec">Complex.prototype.arcsec()</a></h3>
<p>Returns the inverse secant of the number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>arcsec() : Complex {</pre></div></div>
            
        </li>
        
        
        <li id="section-269">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-269">&#182;</a>
              </div>
              <p>arcsec(0) = ComplexInfinity not ComplexNaN</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (<span class="keyword">this</span>.isZero()) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="literal">Infinity</span>);
	}

	<span class="keyword">return</span> <span class="keyword">this</span>.inverse().arccos();
}</pre></div></div>
            
        </li>
        
        
        <li id="section-270">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-270">&#182;</a>
              </div>
              <h3 id="-complex-prototype-arcsin-http-mathlib-de-en-docs-complex-arcsin-"><a href="http://mathlib.de/en/docs/Complex/arcsin">Complex.prototype.arcsin()</a></h3>
<p>Returns the inverse sine of the number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>arcsin() : Complex {
	<span class="keyword">var</span> a = <span class="keyword">this</span>.re,
			b = <span class="keyword">this</span>.im,
			aa = a * a,
			bb = b * b,
			sqrt = Math.sqrt(Math.pow(aa + bb - <span class="number">1</span>, <span class="number">2</span>) + <span class="number">4</span> * bb),
			sgn = <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
				<span class="keyword">if</span> (x &gt; <span class="number">0</span>) {
					<span class="keyword">return</span> <span class="number">1</span>; 
				}
				<span class="keyword">if</span> (x &lt; <span class="number">0</span>) {
					<span class="keyword">return</span> -<span class="number">1</span>; 
				}
				<span class="keyword">if</span> (<span class="number">1</span>/x === <span class="literal">Infinity</span>) {
					<span class="keyword">return</span> <span class="number">1</span>; 
				}
				<span class="keyword">if</span> (<span class="number">1</span>/x === -<span class="literal">Infinity</span>) {
					<span class="keyword">return</span> -<span class="number">1</span>; 
				}
			};

	<span class="keyword">if</span> (a === <span class="literal">Infinity</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="literal">Infinity</span>);
	}

	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(
			sgn(a) / <span class="number">2</span> * MathLib.arccos(sqrt - (aa + bb)),
			sgn(b) / <span class="number">2</span> * MathLib.arcosh(sqrt + (aa + bb))
		);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-271">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-271">&#182;</a>
              </div>
              <h3 id="-complex-prototype-arctan-http-mathlib-de-en-docs-complex-arctan-"><a href="http://mathlib.de/en/docs/Complex/arctan">Complex.prototype.arctan()</a></h3>
<p>Returns the inverse tangent of the number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>arctan() : Complex {
	<span class="keyword">var</span> res,
			iz = <span class="keyword">new</span> MathLib.Complex(-<span class="keyword">this</span>.im, <span class="keyword">this</span>.re);

	<span class="keyword">if</span> (<span class="keyword">this</span>.isZero()) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="keyword">this</span>.re, <span class="keyword">this</span>.im);
	}
	
	res = MathLib.times(<span class="keyword">new</span> MathLib.Complex(<span class="number">0</span>, -<span class="number">0.5</span>),
		MathLib.plus(<span class="number">1</span>, iz).divide(MathLib.minus(<span class="number">1</span>, iz)).ln());</pre></div></div>
            
        </li>
        
        
        <li id="section-272">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-272">&#182;</a>
              </div>
              <p>Correct some values on the axis imaginary axis.
TODO: Are this all the wrong values?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (MathLib.isNegZero(<span class="keyword">this</span>.re) &amp;&amp; res.re !== <span class="literal">Infinity</span> &amp;&amp; (<span class="keyword">this</span>.im &lt; <span class="number">0</span> || <span class="keyword">this</span>.im &gt; <span class="number">1</span>)) {
		res.re = -res.re;
	}

	<span class="keyword">return</span> res;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-273">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-273">&#182;</a>
              </div>
              <h3 id="-complex-prototype-arg-http-mathlib-de-en-docs-complex-arg-"><a href="http://mathlib.de/en/docs/Complex/arg">Complex.prototype.arg()</a></h3>
<p>Returns the argument (= the angle) of the complex number</p>
<p><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>arg() : number {
	<span class="keyword">if</span> (<span class="keyword">this</span>.re === <span class="literal">Infinity</span>) {
		<span class="keyword">return</span> <span class="literal">NaN</span>;
	}
	<span class="keyword">return</span> Math.atan2(<span class="keyword">this</span>.im, <span class="keyword">this</span>.re);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-274">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-274">&#182;</a>
              </div>
              <h3 id="complex-prototype-artanh-">Complex.prototype.artanh()</h3>
<p>Returns the inverse hyperbolic tangent of the number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>artanh() : Complex {
	<span class="keyword">if</span> (<span class="keyword">this</span>.isZero()) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="keyword">this</span>.re, <span class="keyword">this</span>.im);
	}
	
	<span class="keyword">if</span> (<span class="keyword">this</span>.re === <span class="literal">Infinity</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="literal">NaN</span>);
	}

	<span class="keyword">return</span> MathLib.times(<span class="number">0.5</span>, MathLib.minus(MathLib.ln(MathLib.plus(<span class="number">1</span>, <span class="keyword">this</span>)), MathLib.ln(MathLib.minus(<span class="number">1</span>, <span class="keyword">this</span>))));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-275">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-275">&#182;</a>
              </div>
              <h3 id="-complex-prototype-compare-http-mathlib-de-en-docs-complex-compare-"><a href="http://mathlib.de/en/docs/Complex/compare">Complex.prototype.compare()</a></h3>
<p>Compares two complex numbers</p>
<p><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>compare(x) : number {
	<span class="keyword">var</span> a = MathLib.sign(<span class="keyword">this</span>.abs() - x.abs());

	<span class="keyword">if</span> (MathLib.isNaN(<span class="keyword">this</span>.re)) {
		<span class="keyword">if</span> (MathLib.isNaN(x.re)) {
			<span class="keyword">return</span> <span class="number">0</span>;
		}
		<span class="keyword">return</span> -<span class="number">1</span>;
	}

	<span class="keyword">if</span> (<span class="keyword">this</span>.re === <span class="literal">Infinity</span>) {
		<span class="keyword">if</span> (x.re === <span class="literal">Infinity</span>) {
			<span class="keyword">return</span> <span class="number">0</span>;
		}
		<span class="keyword">return</span> <span class="number">1</span>;
	}

	<span class="keyword">return</span> a ? a : MathLib.sign(<span class="keyword">this</span>.arg() - x.arg());
}</pre></div></div>
            
        </li>
        
        
        <li id="section-276">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-276">&#182;</a>
              </div>
              <h3 id="-complex-prototype-conjugate-http-mathlib-de-en-docs-complex-conjugate-"><a href="http://mathlib.de/en/docs/Complex/conjugate">Complex.prototype.conjugate()</a></h3>
<p>Calculates the conjugate of a complex number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>conjugate() : Complex {
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="keyword">this</span>.re, MathLib.negative(<span class="keyword">this</span>.im));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-277">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-277">&#182;</a>
              </div>
              <h3 id="-complex-prototype-copy-http-mathlib-de-en-docs-complex-copy-"><a href="http://mathlib.de/en/docs/Complex/copy">Complex.prototype.copy()</a></h3>
<p>Copies the complex number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>copy() : Complex {
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(MathLib.copy(<span class="keyword">this</span>.re), MathLib.copy(<span class="keyword">this</span>.im));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-278">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-278">&#182;</a>
              </div>
              <h3 id="-complex-prototype-cos-http-mathlib-de-en-docs-complex-cos-"><a href="http://mathlib.de/en/docs/Complex/cos">Complex.prototype.cos()</a></h3>
<p>Calculates the cosine of a complex number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>cos() : Complex {
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(MathLib.cos(<span class="keyword">this</span>.re) * MathLib.cosh(<span class="keyword">this</span>.im), -MathLib.sin(<span class="keyword">this</span>.re) * MathLib.sinh(<span class="keyword">this</span>.im));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-279">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-279">&#182;</a>
              </div>
              <h3 id="-complex-prototype-cosh-http-mathlib-de-en-docs-complex-cosh-"><a href="http://mathlib.de/en/docs/Complex/cosh">Complex.prototype.cosh()</a></h3>
<p>Calculates the hyperbolic cosine of a complex number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>cosh() : Complex {
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(MathLib.cos(<span class="keyword">this</span>.im) * MathLib.cosh(<span class="keyword">this</span>.re), MathLib.sin(<span class="keyword">this</span>.im) * MathLib.sinh(<span class="keyword">this</span>.re));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-280">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-280">&#182;</a>
              </div>
              <h3 id="-complex-prototype-cot-http-mathlib-de-en-docs-complex-cot-"><a href="http://mathlib.de/en/docs/Complex/cot">Complex.prototype.cot()</a></h3>
<p>Calculates the cotangent of a complex number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>cot() : Complex {
	<span class="keyword">var</span> aa = <span class="number">2</span> * <span class="keyword">this</span>.re,
			bb = <span class="number">2</span> * <span class="keyword">this</span>.im,
			d = MathLib.cos(aa) - MathLib.cosh(bb);

	<span class="keyword">if</span> (<span class="keyword">this</span>.isZero()) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="literal">Infinity</span>);
	}
			
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(-MathLib.sin(aa) / d , MathLib.sinh(bb) / d);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-281">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-281">&#182;</a>
              </div>
              <h3 id="-complex-prototype-coth-http-mathlib-de-en-docs-complex-coth-"><a href="http://mathlib.de/en/docs/Complex/coth">Complex.prototype.coth()</a></h3>
<p>Calculates the hyperbolic cotangent of a complex number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>coth() : Complex {
	<span class="keyword">var</span> aa = <span class="number">2</span> * <span class="keyword">this</span>.re,
			bb = <span class="number">2</span> * <span class="keyword">this</span>.im,
			d = MathLib.cosh(aa) - MathLib.cos(bb);

	<span class="keyword">if</span> (<span class="keyword">this</span>.isZero()) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="literal">Infinity</span>);
	}

	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(MathLib.sinh(aa) / d , -MathLib.sin(bb) / d);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-282">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-282">&#182;</a>
              </div>
              <h3 id="-complex-prototype-csc-http-mathlib-de-en-docs-complex-csc-"><a href="http://mathlib.de/en/docs/Complex/csc">Complex.prototype.csc()</a></h3>
<p>Calculates the cosecant of a complex number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>csc() : Complex {
	<span class="keyword">var</span> a = <span class="keyword">this</span>.re,
			b = <span class="keyword">this</span>.im,
			d = MathLib.cos(<span class="number">2</span> * a) - MathLib.cosh(<span class="number">2</span> * b);
	
	<span class="keyword">if</span> (<span class="keyword">this</span>.isZero()) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="literal">Infinity</span>);
	}

	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(-<span class="number">2</span> * MathLib.sin(a) * MathLib.cosh(b) / d , <span class="number">2</span> * MathLib.cos(a) * MathLib.sinh(b) / d);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-283">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-283">&#182;</a>
              </div>
              <h3 id="-complex-prototype-csch-http-mathlib-de-en-docs-complex-csch-"><a href="http://mathlib.de/en/docs/Complex/csch">Complex.prototype.csch()</a></h3>
<p>Calculates the hyperbolic cosecant of a complex number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>csch() : Complex {
	<span class="keyword">var</span> a = <span class="keyword">this</span>.re,
			b = <span class="keyword">this</span>.im,
			d = MathLib.cosh(<span class="number">2</span> * a) - MathLib.cos(<span class="number">2</span> * b);
	
	<span class="keyword">if</span> (<span class="keyword">this</span>.isZero()) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="literal">Infinity</span>);
	}

	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="number">2</span> * MathLib.sinh(a) * MathLib.cos(b) / d , -<span class="number">2</span> * MathLib.cosh(a) * MathLib.sin(b) / d);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-284">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-284">&#182;</a>
              </div>
              <h3 id="-complex-prototype-divide-http-mathlib-de-en-docs-complex-divide-"><a href="http://mathlib.de/en/docs/Complex/divide">Complex.prototype.divide()</a></h3>
<p>Divides a complex number by an other</p>
<p><em>@param {number|Complex}</em> The divisor<br><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>divide(c) : Complex {
	<span class="keyword">return</span> <span class="keyword">this</span>.times(MathLib.inverse(c));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-285">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-285">&#182;</a>
              </div>
              <h3 id="-complex-prototype-exp-http-mathlib-de-en-docs-complex-exp-"><a href="http://mathlib.de/en/docs/Complex/exp">Complex.prototype.exp()</a></h3>
<p>Evaluates the exponential function with a complex argument</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>exp() : Complex {
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(MathLib.exp(<span class="keyword">this</span>.re) * MathLib.cos(<span class="keyword">this</span>.im), MathLib.exp(<span class="keyword">this</span>.re) * MathLib.sin(<span class="keyword">this</span>.im));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-286">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-286">&#182;</a>
              </div>
              <h3 id="-complex-prototype-inverse-http-mathlib-de-en-docs-complex-inverse-"><a href="http://mathlib.de/en/docs/Complex/inverse">Complex.prototype.inverse()</a></h3>
<p>Calculates the inverse of a complex number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>inverse() : Complex {
	<span class="keyword">var</span> d = MathLib.plus(MathLib.pow(<span class="keyword">this</span>.re, <span class="number">2</span>), MathLib.pow(<span class="keyword">this</span>.im, <span class="number">2</span>));

	<span class="keyword">if</span> (<span class="keyword">this</span>.isZero()) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="literal">Infinity</span>);
	}

	<span class="keyword">if</span> (<span class="keyword">this</span>.re === <span class="literal">Infinity</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="number">0</span>);
	}

	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(MathLib.divide(<span class="keyword">this</span>.re, d), MathLib.divide(MathLib.negative(<span class="keyword">this</span>.im), d));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-287">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-287">&#182;</a>
              </div>
              <h3 id="-complex-prototype-isequal-http-mathlib-de-en-docs-complex-isequal-"><a href="http://mathlib.de/en/docs/Complex/isEqual">Complex.prototype.isEqual()</a></h3>
<p>Determines if the complex number is equal to another number.</p>
<p><em>@param {Complex|number|Rational}</em> The number to be compared<br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isEqual(n) : boolean {
	<span class="keyword">if</span> (<span class="keyword">typeof</span> n === <span class="string">'number'</span>) {
		<span class="keyword">return</span> MathLib.isEqual(<span class="keyword">this</span>.re, n) &amp;&amp; MathLib.isZero(<span class="keyword">this</span>.im);
	}
	<span class="keyword">if</span> (n.type === <span class="string">'complex'</span>) {
		<span class="keyword">return</span> MathLib.isEqual(<span class="keyword">this</span>.re, n.re) &amp;&amp; MathLib.isEqual(<span class="keyword">this</span>.im, n.im);
	}
	<span class="keyword">return</span> <span class="literal">false</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-288">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-288">&#182;</a>
              </div>
              <h3 id="-complex-prototype-isfinite-http-mathlib-de-en-docs-complex-isfinite-"><a href="http://mathlib.de/en/docs/Complex/isFinite">Complex.prototype.isFinite()</a></h3>
<p>Determines if the complex number is finite.</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isFinite() : boolean {
	<span class="keyword">return</span> MathLib.isFinite(<span class="keyword">this</span>.re);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-289">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-289">&#182;</a>
              </div>
              <h3 id="-complex-prototype-iszero-http-mathlib-de-en-docs-complex-iszero-"><a href="http://mathlib.de/en/docs/Complex/isZero">Complex.prototype.isZero()</a></h3>
<p>Determines if the complex number is equal to 0.</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isZero() : boolean {
	<span class="keyword">return</span> MathLib.isZero(<span class="keyword">this</span>.re) &amp;&amp; MathLib.isZero(<span class="keyword">this</span>.im);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-290">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-290">&#182;</a>
              </div>
              <h3 id="-complex-prototype-ln-http-mathlib-de-en-docs-complex-ln-"><a href="http://mathlib.de/en/docs/Complex/ln">Complex.prototype.ln()</a></h3>
<p>Evaluates the natural logarithm with complex arguments</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>ln() : Complex {
	<span class="keyword">if</span> (<span class="keyword">this</span>.re === <span class="literal">Infinity</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="literal">Infinity</span>);
	}
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(MathLib.ln(<span class="keyword">this</span>.abs()), <span class="keyword">this</span>.arg());
}</pre></div></div>
            
        </li>
        
        
        <li id="section-291">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-291">&#182;</a>
              </div>
              <h3 id="-complex-prototype-minus-http-mathlib-de-en-docs-complex-minus-"><a href="http://mathlib.de/en/docs/Complex/minus">Complex.prototype.minus()</a></h3>
<p>Calculates the difference of two complex numbers</p>
<p><em>@param {number|Complex}</em> The subtrahend<br><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>minus(c) : Complex {
	<span class="keyword">return</span> <span class="keyword">this</span>.plus(MathLib.negative(c));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-292">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-292">&#182;</a>
              </div>
              <h3 id="-complex-prototype-negative-http-mathlib-de-en-docs-complex-negative-"><a href="http://mathlib.de/en/docs/Complex/negative">Complex.prototype.negative()</a></h3>
<p>Calculates the negative of the complex number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>negative() : Complex {
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(MathLib.negative(<span class="keyword">this</span>.re), MathLib.negative(<span class="keyword">this</span>.im));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-293">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-293">&#182;</a>
              </div>
              <h3 id="-complex-prototype-plus-http-mathlib-de-en-docs-complex-plus-"><a href="http://mathlib.de/en/docs/Complex/plus">Complex.prototype.plus()</a></h3>
<p>Add complex numbers</p>
<p><em>@param {Complex|number|Rational}</em> The number to be added<br><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>plus(c) : Complex {
	<span class="keyword">if</span> (c.type === <span class="string">'complex'</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(MathLib.plus(<span class="keyword">this</span>.re, c.re), MathLib.plus(<span class="keyword">this</span>.im, c.im));
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (c.type === <span class="string">'rational'</span>) {
		c = c.toNumber();
	}
	<span class="keyword">if</span> (<span class="keyword">typeof</span> c === <span class="string">'number'</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(MathLib.plus(<span class="keyword">this</span>.re, c), <span class="keyword">this</span>.im);
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-294">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-294">&#182;</a>
              </div>
              <h3 id="-complex-polar-http-mathlib-de-en-docs-complex-polar-"><a href="http://mathlib.de/en/docs/Complex/polar">Complex.polar()</a></h3>
<p>Construct a complex number out of the absolute value and the argument</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static polar = <span class="function"><span class="keyword">function</span> <span class="params">(abs, arg)</span> : <span class="title">Complex</span> {</span>
	<span class="keyword">if</span> (abs === <span class="literal">Infinity</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="literal">Infinity</span>);
	}
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(abs * Math.cos(arg), abs * Math.sin(arg));
};</pre></div></div>
            
        </li>
        
        
        <li id="section-295">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-295">&#182;</a>
              </div>
              <h3 id="-complex-prototype-pow-http-mathlib-de-en-docs-complex-pow-"><a href="http://mathlib.de/en/docs/Complex/pow">Complex.prototype.pow()</a></h3>
<p>Calculates the complex number raised to some power</p>
<p><em>@param {numeric}</em> The power to which the complex number should be raised<br><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>pow(c) : Complex {	
	<span class="keyword">var</span> re, im, abs, arg;

	<span class="keyword">if</span> (MathLib.type(c) === <span class="string">'complex'</span>) {
		re = c.re;
		im = c.im;
		abs = <span class="keyword">this</span>.abs();
		arg = <span class="keyword">this</span>.arg();</pre></div></div>
            
        </li>
        
        
        <li id="section-296">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-296">&#182;</a>
              </div>
              <p>Fixes inf^(2+5i) = inf and 0^(2+5i) = 0</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> ((<span class="keyword">this</span>.isZero() || <span class="keyword">this</span>.re === <span class="literal">Infinity</span>) &amp;&amp; !(c.isZero() || c.re === <span class="literal">Infinity</span> || MathLib.isNaN(c.re))) {
			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="keyword">this</span>.re, <span class="keyword">this</span>.im);
		}

		<span class="keyword">return</span> MathLib.Complex.polar(
			MathLib.times(
				MathLib.pow(abs, re),
				MathLib.exp(
					MathLib.negative(
						MathLib.times(im, arg)
					)
				)
			),
			MathLib.plus(MathLib.times(re, arg), MathLib.times(im, MathLib.ln(abs)))
		);
	}
	<span class="keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-297">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-297">&#182;</a>
              </div>
              <p>The naive pow method has some rounding errrors. For example
(2+5i)^3 = -142.00000000000006-64.99999999999999i<br>instead of -142-65i which are errors of magnitude around 1e-14.
This error increases quickly for increasing exponents.
(2+5i)^21 has an error of 5.8 in the real part</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="comment">/*
		return MathLib.Complex.polar(MathLib.pow(abs, c), MathLib.times(arg, c));
		*/</span></pre></div></div>
            
        </li>
        
        
        <li id="section-298">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-298">&#182;</a>
              </div>
              <p>The following algorithm uses a sifferent approach for integer exponents,
where it yields exact results.
Non integer exponents are evaluated using the naive approach.
TODO: Improve the algorithm.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">var</span> i,
				int = MathLib.floor(Math.abs(c)),
				res = <span class="keyword">new</span> MathLib.Complex(<span class="number">1</span>),
				power = <span class="keyword">this</span>,
				bin = int.toString(<span class="number">2</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-299">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-299">&#182;</a>
              </div>
              <p>If the exponent is not an integer we use the naive approach</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (c % <span class="number">1</span>) {
			abs = <span class="keyword">this</span>.abs();
			arg = <span class="keyword">this</span>.arg();
			<span class="keyword">return</span> MathLib.Complex.polar(MathLib.pow(abs, c), MathLib.times(arg, c));
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-300">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-300">&#182;</a>
              </div>
              <p>The imaginary part of (2+5i)^-0 should be -0 not +0.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (MathLib.isZero(c)) {
			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="number">1</span>, c);
		}

		<span class="keyword">for</span> (i = bin.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) {
			<span class="keyword">if</span> (bin[i] === <span class="string">'1'</span>) {
				res = MathLib.times(res, power);
			}
			power = MathLib.times(power, power);
		}


		<span class="keyword">if</span> (c &lt; <span class="number">0</span>) {
			res = res.inverse();
		}

		<span class="keyword">return</span> res;
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-301">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-301">&#182;</a>
              </div>
              <h3 id="-complex-prototype-sec-http-mathlib-de-en-docs-complex-sec-"><a href="http://mathlib.de/en/docs/Complex/sec">Complex.prototype.sec()</a></h3>
<p>Calculates the secant of a complex number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>sec() : Complex {
	<span class="keyword">var</span> a = <span class="keyword">this</span>.re,
			b = <span class="keyword">this</span>.im,
			d = MathLib.cos(<span class="number">2</span> * a) + MathLib.cosh(<span class="number">2</span> * b);
			
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="number">2</span> * MathLib.cos(a) * MathLib.cosh(b) / d , <span class="number">2</span> * MathLib.sin(a) * MathLib.sinh(b) / d);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-302">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-302">&#182;</a>
              </div>
              <h3 id="-complex-prototype-sech-http-mathlib-de-en-docs-complex-sech-"><a href="http://mathlib.de/en/docs/Complex/sech">Complex.prototype.sech()</a></h3>
<p>Calculates the hyperbolic secant of a complex number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>sech() : Complex {
	<span class="keyword">var</span> a = <span class="keyword">this</span>.re,
			b = <span class="keyword">this</span>.im,
			d = MathLib.cosh(<span class="number">2</span> * a) + MathLib.cos(<span class="number">2</span> * b);
			
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="number">2</span> * MathLib.cosh(a) * MathLib.cos(b) / d , -<span class="number">2</span> * MathLib.sinh(a) * MathLib.sin(b) / d);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-303">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-303">&#182;</a>
              </div>
              <h3 id="-complex-prototype-sign-http-mathlib-de-en-docs-complex-sign-"><a href="http://mathlib.de/en/docs/Complex/sign">Complex.prototype.sign()</a></h3>
<p>Calculates the signum of a complex number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>sign() : Complex {
	<span class="keyword">if</span> (<span class="keyword">this</span>.isZero() || MathLib.isNaN(<span class="keyword">this</span>.re)) {
		<span class="keyword">return</span> <span class="keyword">this</span>;
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.re === <span class="literal">Infinity</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="literal">NaN</span>);
	}
	<span class="keyword">return</span> MathLib.Complex.polar(<span class="number">1</span>, <span class="keyword">this</span>.arg());
}</pre></div></div>
            
        </li>
        
        
        <li id="section-304">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-304">&#182;</a>
              </div>
              <h3 id="-complex-prototype-sin-http-mathlib-de-en-docs-complex-sin-"><a href="http://mathlib.de/en/docs/Complex/sin">Complex.prototype.sin()</a></h3>
<p>Calculates the sine of a complex number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>sin() : Complex {
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(MathLib.sin(<span class="keyword">this</span>.re) * MathLib.cosh(<span class="keyword">this</span>.im), MathLib.cos(<span class="keyword">this</span>.re) * MathLib.sinh(<span class="keyword">this</span>.im));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-305">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-305">&#182;</a>
              </div>
              <h3 id="-complex-prototype-sinh-http-mathlib-de-en-docs-complex-sinh-"><a href="http://mathlib.de/en/docs/Complex/sinh">Complex.prototype.sinh()</a></h3>
<p>Calculates the hyperbolic sine of a complex number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>sinh() : Complex {
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(MathLib.cos(<span class="keyword">this</span>.im) * MathLib.sinh(<span class="keyword">this</span>.re), MathLib.sin(<span class="keyword">this</span>.im) * MathLib.cosh(<span class="keyword">this</span>.re));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-306">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-306">&#182;</a>
              </div>
              <h3 id="-complex-prototype-sqrt-http-mathlib-de-en-docs-complex-sqrt-"><a href="http://mathlib.de/en/docs/Complex/sqrt">Complex.prototype.sqrt()</a></h3>
<p>Takes the square root of a complex number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>sqrt() : Complex {
	<span class="keyword">return</span> MathLib.Complex.polar(Math.sqrt(<span class="keyword">this</span>.abs()), <span class="keyword">this</span>.arg() / <span class="number">2</span>);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-307">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-307">&#182;</a>
              </div>
              <h3 id="-complex-prototype-tan-http-mathlib-de-en-docs-complex-tan-"><a href="http://mathlib.de/en/docs/Complex/tan">Complex.prototype.tan()</a></h3>
<p>Calculates the tangent of a complex number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>tan() : Complex {
	<span class="keyword">var</span> aa = <span class="number">2</span> * <span class="keyword">this</span>.re,
			bb = <span class="number">2</span> * <span class="keyword">this</span>.im,
			d = MathLib.cos(aa) + MathLib.cosh(bb);
			
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(MathLib.sin(aa) / d , MathLib.sinh(bb) / d);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-308">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-308">&#182;</a>
              </div>
              <h3 id="-complex-prototype-tanh-http-mathlib-de-en-docs-complex-tanh-"><a href="http://mathlib.de/en/docs/Complex/tanh">Complex.prototype.tanh()</a></h3>
<p>Calculates the hyperbolic tangent of a complex number</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>tanh() : Complex {
	<span class="keyword">var</span> aa = <span class="number">2</span> * <span class="keyword">this</span>.re,
			bb = <span class="number">2</span> * <span class="keyword">this</span>.im,
			d = MathLib.cosh(aa) + MathLib.cos(bb);
			
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(MathLib.sinh(aa) / d , MathLib.sin(bb) / d);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-309">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-309">&#182;</a>
              </div>
              <h3 id="-complex-prototype-times-http-mathlib-de-en-docs-complex-times-"><a href="http://mathlib.de/en/docs/Complex/times">Complex.prototype.times()</a></h3>
<p>Multiplies complex numbers</p>
<p><em>@param {Complex|number|Rational}</em> The number to be multiplied<br><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>times(c) : Complex {
	<span class="keyword">if</span> (c.type === <span class="string">'complex'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.re === <span class="literal">Infinity</span>) {
			<span class="keyword">if</span> (c.isZero() || MathLib.isNaN(c.re)) {
				<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="literal">NaN</span>);
			}
			<span class="keyword">else</span> {
				<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="literal">Infinity</span>);
			}
		}

		<span class="keyword">if</span> (c.re === <span class="literal">Infinity</span>) {
			<span class="keyword">if</span> (<span class="keyword">this</span>.isZero() || MathLib.isNaN(<span class="keyword">this</span>.re)) {
				<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="literal">NaN</span>);
			}
			<span class="keyword">else</span> {
				<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="literal">Infinity</span>);
			}
		}

		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(MathLib.minus(MathLib.times(<span class="keyword">this</span>.re, c.re), MathLib.times(<span class="keyword">this</span>.im, c.im)),
			MathLib.plus(MathLib.times(<span class="keyword">this</span>.re, c.im), MathLib.times(<span class="keyword">this</span>.im, c.re)));
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (c.type === <span class="string">'rational'</span>) {
		c = c.toNumber();
	}
	<span class="keyword">if</span> (<span class="keyword">typeof</span> c === <span class="string">'number'</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(MathLib.times(<span class="keyword">this</span>.re, c), MathLib.times(<span class="keyword">this</span>.im, c));
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-310">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-310">&#182;</a>
              </div>
              <h3 id="-complex-prototype-tocontentmathml-http-mathlib-de-en-docs-complex-tocontentmathml-"><a href="http://mathlib.de/en/docs/Complex/toContentMathML">Complex.prototype.toContentMathML()</a></h3>
<p>Returns the content MathML representation of the number</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toContentMathML() : string {

	<span class="keyword">if</span> (!<span class="keyword">this</span>.isFinite()) {
		<span class="keyword">return</span> <span class="string">'&lt;csymbol cd="nums1"&gt;'</span> + 
			(<span class="keyword">this</span>.re === <span class="literal">Infinity</span> ? <span class="string">'infinity'</span> : <span class="string">'NaN'</span>) +
			<span class="string">'&lt;/csymbol&gt;'</span>;
	}

	<span class="keyword">return</span> <span class="string">'&lt;apply&gt;&lt;plus /&gt;'</span> + MathLib.toContentMathML(<span class="keyword">this</span>.re) + <span class="string">'&lt;apply&gt;&lt;times /&gt;'</span>
					+ MathLib.toContentMathML(<span class="keyword">this</span>.im) + <span class="string">'&lt;imaginaryi /&gt;&lt;/apply&gt;&lt;/apply&gt;'</span>
}</pre></div></div>
            
        </li>
        
        
        <li id="section-311">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-311">&#182;</a>
              </div>
              <h3 id="-complex-prototype-tolatex-http-mathlib-de-en-docs-complex-tolatex-"><a href="http://mathlib.de/en/docs/Complex/toLaTeX">Complex.prototype.toLaTeX()</a></h3>
<p>Returns the LaTeX representation of the complex number</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toLaTeX() : string {
	<span class="keyword">var</span> str = <span class="string">''</span>,
			reFlag = <span class="literal">false</span>;

	<span class="keyword">if</span> (!<span class="keyword">this</span>.isFinite()) {
		<span class="keyword">return</span> <span class="string">'\\text{Complex'</span> + <span class="keyword">this</span>.re + <span class="string">'}'</span>;
	}

	<span class="keyword">if</span> (!MathLib.isZero(<span class="keyword">this</span>.re)) {
		str = MathLib.toLaTeX(<span class="keyword">this</span>.re);
		reFlag = <span class="literal">true</span>;
	}
	<span class="keyword">if</span> (!MathLib.isZero(<span class="keyword">this</span>.im)) {
		str += MathLib.toLaTeX(<span class="keyword">this</span>.im, reFlag) + <span class="string">'i'</span>;
	}
	<span class="keyword">if</span> (str.length === <span class="number">0</span>) {
		str = <span class="string">'0'</span>;
	}
	<span class="keyword">return</span> str;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-312">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-312">&#182;</a>
              </div>
              <h3 id="-complex-prototype-tomathml-http-mathlib-de-en-docs-complex-tomathml-"><a href="http://mathlib.de/en/docs/Complex/toMathML">Complex.prototype.toMathML()</a></h3>
<p>Returns the (presentation) MathML representation of the number</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toMathML() : string {
	<span class="keyword">var</span> str = <span class="string">''</span>, reFlag = <span class="literal">false</span>;

	<span class="keyword">if</span> (!<span class="keyword">this</span>.isFinite()) {
		<span class="keyword">return</span> <span class="string">'&lt;mi&gt;Complex'</span> + <span class="keyword">this</span>.re + <span class="string">'&lt;/mi&gt;'</span>;
	}

	<span class="keyword">if</span> (!MathLib.isZero(<span class="keyword">this</span>.re)) {
		str = MathLib.toMathML(<span class="keyword">this</span>.re);
		reFlag = <span class="literal">true</span>;
	}
	<span class="keyword">if</span> (!MathLib.isZero(<span class="keyword">this</span>.im)) {
		str += MathLib.toMathML(<span class="keyword">this</span>.im, reFlag) + <span class="string">'&lt;mo&gt;&amp;#x2062;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;'</span>;
	}
	<span class="keyword">if</span> (str.length === <span class="number">0</span>) {
		str = <span class="string">'&lt;mn&gt;0&lt;/mn&gt;'</span>;
	}
	<span class="keyword">return</span> str;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-313">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-313">&#182;</a>
              </div>
              <h3 id="-complex-prototype-topoint-http-mathlib-de-en-docs-complex-topoint-"><a href="http://mathlib.de/en/docs/Complex/toPoint">Complex.prototype.toPoint()</a></h3>
<p>Interprets the complex number as point in the two dimensional plane</p>
<p><em>@return {Point}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toPoint() : Point {

	<span class="keyword">if</span> (<span class="keyword">this</span>.re == <span class="literal">Infinity</span> || MathLib.isNaN(<span class="keyword">this</span>.re)) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Point([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]);
	}

	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Point(<span class="keyword">this</span>.re, <span class="keyword">this</span>.im);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-314">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-314">&#182;</a>
              </div>
              <h3 id="-complex-prototype-tostring-http-mathlib-de-en-docs-complex-tostring-"><a href="http://mathlib.de/en/docs/Complex/toString">Complex.prototype.toString()</a></h3>
<p>Custom toString function</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toString() : string {
	<span class="keyword">var</span> str = <span class="string">''</span>;

	<span class="keyword">if</span> (!<span class="keyword">this</span>.isFinite()) {
		<span class="keyword">return</span> <span class="string">'Complex'</span> + <span class="keyword">this</span>.re;
	}

	<span class="keyword">if</span> (!MathLib.isZero(<span class="keyword">this</span>.re)) {
		str = MathLib.toString(<span class="keyword">this</span>.re);
	}
	<span class="keyword">if</span> (!MathLib.isZero(<span class="keyword">this</span>.im)) {
		str += (<span class="keyword">this</span>.im &gt; <span class="number">0</span> ? (str.length ? <span class="string">'+'</span> : <span class="string">''</span>) : <span class="string">'-'</span>) + MathLib.toString(Math.abs(<span class="keyword">this</span>.im)) + <span class="string">'i'</span>;
	}
	<span class="keyword">if</span> (str.length === <span class="number">0</span>) {
		str = <span class="string">'0'</span>;
	}
	<span class="keyword">return</span> str;
}


}<span class="comment">// ## &lt;a id="Line"&gt;&lt;/a&gt;Line</span></pre></div></div>
            
        </li>
        
        
        <li id="section-315">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-315">&#182;</a>
              </div>
              <p>The line implementation of MathLib makes calculations with lines in the 
real plane possible. (Higher dimensions will be supported later)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>export class Line extends Vector {
	type = <span class="string">'line'</span>;

	dimension: number;

	constructor (coords: number[]) {
		super(coords);
		<span class="keyword">this</span>.dimension = <span class="number">2</span>;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-316">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-316">&#182;</a>
              </div>
              <h3 id="line-prototype-draw-">Line.prototype.draw()</h3>
<p>Draws the line on one or more screens</p>
<p><em>@param {Screen}</em> The screen to draw onto.<br><em>@param {object}</em> [options] Drawing options<br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>draw(screen, options) {
	<span class="keyword">if</span> (Array.isArray(screen)) {
		<span class="keyword">var</span> line = <span class="keyword">this</span>;
		screen.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
			x.line(line, options);
		});
	}
	<span class="keyword">else</span> {
		screen.line(<span class="keyword">this</span>, options);
	}
	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-317">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-317">&#182;</a>
              </div>
              <h3 id="line-prototype-isequal-">Line.prototype.isEqual()</h3>
<p>Determines if two lines are equal.</p>
<p><em>@param {Line}</em><br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isEqual(q : Line) : boolean {
	<span class="keyword">var</span> p = <span class="keyword">this</span>.normalize();
			q = q.normalize();

	<span class="keyword">if</span> (<span class="keyword">this</span>.length !== q.length) {
		<span class="keyword">return</span> <span class="literal">false</span>;
	}

	<span class="keyword">return</span> p.every(<span class="function"><span class="keyword">function</span> <span class="params">(x, i)</span> {</span>
		<span class="keyword">return</span> MathLib.isEqual(x, q[i]);
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-318">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-318">&#182;</a>
              </div>
              <h3 id="line-prototype-isfinite-">Line.prototype.isFinite()</h3>
<p>Determines if the line is finite</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isFinite() : boolean {
	<span class="keyword">return</span> !MathLib.isZero(<span class="keyword">this</span>[<span class="number">0</span>]) || !MathLib.isZero(<span class="keyword">this</span>[<span class="number">1</span>]);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-319">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-319">&#182;</a>
              </div>
              <h3 id="line-prototype-isparallelto-">Line.prototype.isParallelTo()</h3>
<p>Determines if two lines are parallel.</p>
<p><em>@param {Line}</em><br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isParallelTo(l : Line) : boolean {
	<span class="keyword">return</span> MathLib.isZero(<span class="keyword">this</span>[<span class="number">0</span>]*l[<span class="number">1</span>] - <span class="keyword">this</span>[<span class="number">1</span>]*l[<span class="number">0</span>]);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-320">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-320">&#182;</a>
              </div>
              <h3 id="line-prototype-meet-">Line.prototype.meet()</h3>
<p>Calculates the meeting point of two lines</p>
<p><em>@param {Line}</em><br><em>@return {Point}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>meet(l : Line) : Point {
	<span class="keyword">var</span> point,
			k = <span class="keyword">this</span>;

	<span class="keyword">if</span> (<span class="keyword">this</span>.dimension === <span class="number">2</span> &amp;&amp; l.dimension === <span class="number">2</span>) {
		point = <span class="keyword">new</span> MathLib.Point(<span class="keyword">this</span>.vectorProduct(l));

		Object.defineProperties(point, {
			<span class="string">'0'</span>: {
				get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> k[<span class="number">1</span>] * l[<span class="number">2</span>] - k[<span class="number">2</span>] * l[<span class="number">1</span>]; },
				set: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> MathLib.warning({message: <span class="string">'Trying to change the coordinates of a completely dependent point.'</span>, method: <span class="string">'Line#meet'</span>});},
				enumerable: <span class="literal">true</span>
			},
			<span class="string">'1'</span>: {
				get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> k[<span class="number">2</span>] * l[<span class="number">0</span>] - k[<span class="number">0</span>] * l[<span class="number">2</span>]; },
				set: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> MathLib.warning({message: <span class="string">'Trying to change the coordinates of a completely dependent point.'</span>, method: <span class="string">'Line#meet'</span>});},
				enumerable: <span class="literal">true</span>
			},
			<span class="string">'2'</span>: {
				get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> k[<span class="number">0</span>] * l[<span class="number">1</span>] - k[<span class="number">1</span>] * l[<span class="number">0</span>]; },
				set: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> MathLib.warning({message: <span class="string">'Trying to change the coordinates of a completely dependent point.'</span>, method: <span class="string">'Line#meet'</span>});},
				enumerable: <span class="literal">true</span>
			}
		});
		
		<span class="keyword">return</span> point;
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-321">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-321">&#182;</a>
              </div>
              <h3 id="line-prototype-normalize-">Line.prototype.normalize()</h3>
<p>Normalizes the line.</p>
<p><em>@return {Line}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>normalize() : Line {
	<span class="keyword">var</span> h = MathLib.hypot(<span class="keyword">this</span>[<span class="number">0</span>], <span class="keyword">this</span>[<span class="number">1</span>]);

	<span class="keyword">if</span> (h !== <span class="number">0</span>){
		<span class="keyword">return</span> <span class="keyword">this</span>.map(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
			<span class="keyword">return</span> x / h;
		});
	}
	<span class="keyword">else</span> {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Line([<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>]);
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-322">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-322">&#182;</a>
              </div>
              <h3 id="line-prototype-parallelthrough-">Line.prototype.parallelThrough()</h3>
<p>Determines an parallel line through a given point.</p>
<p><em>@param {Point}</em><br><em>@return {Line}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>parallelThrough(p : Point) : Line {
	<span class="keyword">var</span> l = <span class="keyword">this</span>,
			parallel = <span class="keyword">new</span> MathLib.Line([<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]);

	Object.defineProperties(parallel, {
		<span class="string">'0'</span>: {
			get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> -l[<span class="number">0</span>] * p[<span class="number">2</span>]; },
			set: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>	MathLib.warning({message: <span class="string">'Trying to change the coordinates of a completely dependent line.'</span>, method: <span class="string">'Line#parallelThrough'</span>});},
			enumerable: <span class="literal">true</span>
		},
		<span class="string">'1'</span>: {
			get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> -l[<span class="number">1</span>] * p[<span class="number">2</span>]; },
			set: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>	MathLib.warning({message: <span class="string">'Trying to change the coordinates of a completely dependent line.'</span>, method: <span class="string">'Line#parallelThrough'</span>});},
			enumerable: <span class="literal">true</span>
		},
		<span class="string">'2'</span>: {
			get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> l[<span class="number">1</span>] * p[<span class="number">1</span>] + l[<span class="number">0</span>] * p[<span class="number">0</span>]; },
			set: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>	MathLib.warning({message: <span class="string">'Trying to change the coordinates of a completely dependent line.'</span>, method: <span class="string">'Line#parallelThrough'</span>});},
			enumerable: <span class="literal">true</span>
		}
	});

	<span class="keyword">return</span> parallel;
}


}<span class="comment">// ## &lt;a id="Matrix"&gt;&lt;/a&gt;Matrix</span></pre></div></div>
            
        </li>
        
        
        <li id="section-323">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-323">&#182;</a>
              </div>
              <p>The matrix implementation of MathLib makes calculations with matrices of
arbitrary size possible. The entries of a matrix can be numbers and complex
numbers.</p>
<p>It is as easy as</p>
<pre><code>new MathLib.Matrix([[1, 2, 3], [4, 5, 6], [7, 8, 9]])</code></pre>
<p>to create the following matrix:<br>   ⎛ 1 2 3 ⎞<br>   ⎜ 4 5 6 ⎟<br>   ⎝ 7 8 9 ⎠</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>export class Matrix {
	type = <span class="string">'matrix'</span>;

	length: number;
	cols: number;
	rows: number;
	LUpermutation: Permutation;

	constructor (matrix) {
		<span class="keyword">if</span> (<span class="keyword">typeof</span> matrix === <span class="string">'string'</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-324">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-324">&#182;</a>
              </div>
              <p>If there is a &lt; in the string we assume it&#39;s MathML</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">if</span> (matrix.indexOf(<span class="string">'&lt;'</span>) &gt; -<span class="number">1</span>) {
				<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression.parseMathML(matrix).evaluate();
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-325">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-325">&#182;</a>
              </div>
              <p>else we assume it&#39;s MatLab notation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">else</span> {
				matrix = matrix.trim().replace(<span class="regexp">/;?\n/g</span>, <span class="string">'],['</span>);
				matrix = JSON.parse(<span class="string">'[['</span> + matrix + <span class="string">']]'</span>);
			}
		}
		matrix.forEach((x, i) =&gt; {<span class="keyword">this</span>[i] = x;});
		<span class="keyword">this</span>.length = matrix.length;
		<span class="keyword">this</span>.cols = matrix[<span class="number">0</span>].length;
		<span class="keyword">this</span>.rows = matrix.length;

	}</pre></div></div>
            
        </li>
        
        
        <li id="section-326">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-326">&#182;</a>
              </div>
              <h3 id="matrix-prototype-lu-">Matrix.prototype.LU()</h3>
<p>Calculates the LU decomposition of a matrix
The result is cached.</p>
<p><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>LU() {
	<span class="keyword">var</span> i, j, k, t, p,
			LU = <span class="keyword">this</span>.toArray(),
			m = <span class="keyword">this</span>.rows,
			n = <span class="keyword">this</span>.cols,
			permutation = [];

	<span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; n; k++) {</pre></div></div>
            
        </li>
        
        
        <li id="section-327">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-327">&#182;</a>
              </div>
              <p>Find the pivot</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		p = k;
		<span class="keyword">for</span> (i = k + <span class="number">1</span>; i &lt; m; i++) {
			<span class="keyword">if</span> (Math.abs(LU[i][k]) &gt; Math.abs(LU[p][k])) {
				p = i;
			}
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-328">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-328">&#182;</a>
              </div>
              <p>Exchange if necessary</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (p !== k) {
			permutation.unshift([p, k]);
			t = LU[p]; LU[p] = LU[k]; LU[k] = t;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-329">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-329">&#182;</a>
              </div>
              <p>The elimination</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (LU[k][k] !== <span class="number">0</span>) {
			<span class="keyword">for</span> (i = k + <span class="number">1</span>; i &lt; m; i++) {
				LU[i][k] = MathLib.divide(LU[i][k], LU[k][k]);
				<span class="keyword">for</span> (j = k + <span class="number">1</span>; j &lt; n; j++) {
					LU[i][j] = MathLib.minus(LU[i][j], MathLib.times(LU[i][k], LU[k][j]));
				}
			}
		}
	}
	LU = <span class="keyword">new</span> MathLib.Matrix(LU);
	<span class="keyword">this</span>.LU = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
		<span class="keyword">return</span> LU;
	};
	<span class="keyword">this</span>.LUpermutation = <span class="keyword">new</span> MathLib.Permutation(permutation);
	<span class="keyword">return</span> LU;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-330">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-330">&#182;</a>
              </div>
              <h3 id="matrix-prototype-adjoint-">Matrix.prototype.adjoint()</h3>
<p>Calculates the adjoint matrix</p>
<p><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>adjoint() : Matrix {
	<span class="keyword">return</span> <span class="keyword">this</span>.map(MathLib.conjugate).transpose();
}</pre></div></div>
            
        </li>
        
        
        <li id="section-331">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-331">&#182;</a>
              </div>
              <h3 id="matrix-prototype-adjugate-">Matrix.prototype.adjugate()</h3>
<p>Calculates the adjugate matrix</p>
<p><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>adjugate() : Matrix {
	<span class="keyword">return</span> <span class="keyword">this</span>.map(<span class="function"><span class="keyword">function</span> <span class="params">(x, r, c, m)</span> {</span>
		<span class="keyword">return</span> MathLib.times(m.remove(c, r).determinant(), <span class="number">1</span> - ((r + c) % <span class="number">2</span>) * <span class="number">2</span>);
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-332">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-332">&#182;</a>
              </div>
              <h3 id="matrix-prototype-cholesky-">Matrix.prototype.cholesky()</h3>
<p>The cholesky decomposition of a matrix
using the Cholesky–Banachiewicz algorithm.
Does not change the current matrix, but returns a new one.
The result is cached.</p>
<p><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>cholesky() : Matrix {
	<span class="keyword">var</span> i, ii, j, jj, k, kk, sum, choleskyMatrix,
			cholesky = [];

	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.rows; i &lt; ii; i++) {
		cholesky.push([]);
	}

	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.rows; i &lt; ii; i++) {
		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; i; j++) {
			sum = <span class="number">0</span>;
			<span class="keyword">for</span> (k = <span class="number">0</span>, kk = j; k &lt; kk; k++) {
				sum = MathLib.plus(sum, MathLib.times(cholesky[i][k], cholesky[j][k]));
			}
			cholesky[i][j] = (<span class="keyword">this</span>[i][j] - sum) / cholesky[j][j];
		}

		sum = <span class="number">0</span>;
		<span class="keyword">for</span> (k = <span class="number">0</span>, kk = j; k &lt; kk; k++) {
			sum = MathLib.plus(sum, MathLib.times(cholesky[i][k], cholesky[i][k]));
		}
		cholesky[i][j] = Math.sqrt(<span class="keyword">this</span>[j][j] - sum);

		<span class="keyword">for</span> (j++, jj = <span class="keyword">this</span>.cols; j &lt; jj; j++) {
			cholesky[i][j] = <span class="number">0</span>;
		}

	}
	choleskyMatrix = <span class="keyword">new</span> MathLib.Matrix(cholesky);

	<span class="keyword">this</span>.cholesky = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
		<span class="keyword">return</span> choleskyMatrix;
	};
	<span class="keyword">return</span> choleskyMatrix;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-333">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-333">&#182;</a>
              </div>
              <h3 id="matrix-prototype-compare-">Matrix.prototype.compare()</h3>
<p>Compares the matrix to an other matrix.</p>
<p><em>@param {Matrix}</em> The matrix to compare.<br><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>compare(m : Matrix) : number {
	<span class="keyword">var</span> i, ii, j, jj; 

	<span class="keyword">if</span> (<span class="keyword">this</span>.rows !== m.rows) {
		<span class="keyword">return</span> MathLib.sign(<span class="keyword">this</span>.rows - m.rows);
	}

	<span class="keyword">if</span> (<span class="keyword">this</span>.cols !== m.cols) {
		<span class="keyword">return</span> MathLib.sign(<span class="keyword">this</span>.cols - m.cols);
	}

	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.rows; i &lt; ii; i++) {
		<span class="keyword">for</span> (j = <span class="number">0</span>, jj = <span class="keyword">this</span>.cols; j &lt; jj; j++) {
			<span class="keyword">if</span> (<span class="keyword">this</span>[i][j] - m[i][j]) {
				<span class="keyword">return</span> MathLib.sign(<span class="keyword">this</span>[i][j] - m[i][j]);
			}
		}
	}

	<span class="keyword">return</span> <span class="number">0</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-334">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-334">&#182;</a>
              </div>
              <h3 id="matrix-prototype-copy-">Matrix.prototype.copy()</h3>
<p>Copies the matrix</p>
<p><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>copy() : Matrix {
	<span class="keyword">return</span> <span class="keyword">this</span>.map(MathLib.copy);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-335">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-335">&#182;</a>
              </div>
              <h3 id="matrix-prototype-determinant-">Matrix.prototype.determinant()</h3>
<p>Calculates the determinant of the matrix via the LU decomposition.
The result is cached.</p>
<p><em>@return {number|Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>determinant() : any {
	<span class="keyword">var</span> LU, determinant;
	
	<span class="keyword">if</span> (!<span class="keyword">this</span>.isSquare()) {
		MathLib.error({message: <span class="string">'Determinant of non square matrix'</span>, method: <span class="string">'Matrix#determinant'</span>});
		<span class="keyword">return</span>;
	}

	<span class="keyword">if</span> (<span class="keyword">this</span>.rank() &lt; <span class="keyword">this</span>.rows) {
		determinant = <span class="number">0</span>;
	}
	<span class="keyword">else</span> {
		LU = <span class="keyword">this</span>.LU();
		determinant = MathLib.times(<span class="keyword">this</span>.LUpermutation.sgn(), MathLib.times.apply(<span class="literal">null</span>, LU.diag()));
	}

	<span class="keyword">this</span>.determinant = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
		<span class="keyword">return</span> determinant;
	};
	<span class="keyword">return</span> determinant;

}</pre></div></div>
            
        </li>
        
        
        <li id="section-336">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-336">&#182;</a>
              </div>
              <h3 id="matrix-prototype-diag-">Matrix.prototype.diag()</h3>
<p>Returns the entries on the diagonal in an array</p>
<p><em>@return {array}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>diag() : any[] {
	<span class="keyword">var</span> diagonal = [],
			i, ii;
	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = Math.min(<span class="keyword">this</span>.rows, <span class="keyword">this</span>.cols); i &lt; ii; i++) {
		diagonal.push(<span class="keyword">this</span>[i][i]);
	}
	<span class="keyword">return</span> diagonal;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-337">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-337">&#182;</a>
              </div>
              <h3 id="matrix-prototype-divide-">Matrix.prototype.divide()</h3>
<p>Multiplies the matrix by the inverse of a number or a matrix</p>
<p><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>divide(n : any) : Matrix {
	<span class="keyword">return</span> <span class="keyword">this</span>.times(MathLib.inverse(n));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-338">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-338">&#182;</a>
              </div>
              <h3 id="matrix-prototype-every-">Matrix.prototype.every()</h3>
<p>This function works like the Array.prototype.every function.
The matrix is processed row by row.
The function is called with the following arguments:
the entry at the current position, the number of the row,
the number of the column and the complete matrix</p>
<p><em>@param {function}</em> The function which is called on every argument<br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>every(f) : boolean {
	<span class="keyword">return</span> Array.prototype.every.call(<span class="keyword">this</span>, <span class="function"><span class="keyword">function</span> <span class="params">(x, i)</span> {</span>
		<span class="keyword">return</span> Array.prototype.every.call(x, <span class="function"><span class="keyword">function</span> <span class="params">(y, j)</span> {</span>
			<span class="keyword">return</span> f(y, i, j, <span class="keyword">this</span>);
		});
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-339">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-339">&#182;</a>
              </div>
              <h3 id="matrix-prototype-foreach-">Matrix.prototype.forEach()</h3>
<p>This function works like the Array.prototype.forEach function.
The matrix is processed row by row.
The function is called with the following arguments:
the entry at the current position, the number of the row,
the number of the column and the complete matrix</p>
<p><em>@param {function}</em> The function which is called on every argument</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>forEach(f) {
	Array.prototype.forEach.call(<span class="keyword">this</span>, <span class="function"><span class="keyword">function</span> <span class="params">(x, i)</span> {</span>
		<span class="keyword">return</span> Array.prototype.forEach.call(x, <span class="function"><span class="keyword">function</span> <span class="params">(y, j)</span> {</span>
			<span class="keyword">return</span> f(y, i, j, <span class="keyword">this</span>);
		});
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-340">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-340">&#182;</a>
              </div>
              <h3 id="matrix-prototype-gershgorin-">Matrix.prototype.gershgorin()</h3>
<p>Returns the Gershgorin circles of the matrix.</p>
<p><em>@return {array}</em> Returns an array of circles</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>gershgorin() {
	<span class="keyword">var</span> c = [],
			rc = [],
			rr = [],
			circles = [],
			i, ii;

	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.rows; i &lt; ii; i++) {
		rc.push(<span class="number">0</span>);
		rr.push(<span class="number">0</span>);
	}

	<span class="keyword">this</span>.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(x, i, j)</span> {</span>
		<span class="keyword">if</span> (i === j) {
			<span class="keyword">if</span> (MathLib.is(x, <span class="string">'complex'</span>)) {
				c.push(x.toPoint());
			}
			<span class="keyword">else</span> {
				c.push(<span class="keyword">new</span> MathLib.Point([x, <span class="number">0</span>, <span class="number">1</span>]));
			}
		}
		<span class="keyword">else</span> {
			rc[j] += MathLib.abs(x); 
			rr[i] += MathLib.abs(x); 
		}
	});

	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.rows; i &lt; ii; i++) {
		circles.push(<span class="keyword">new</span> MathLib.Circle(c[i], Math.min(rc[i], rr[i])));
	}

	<span class="keyword">return</span> circles;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-341">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-341">&#182;</a>
              </div>
              <h3 id="matrix-prototype-givens-">Matrix.prototype.givens()</h3>
<p>QR decomposition with the givens method.</p>
<p><em>@return {[Matrix, Matrix]}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>givens() {
	<span class="keyword">var</span> rows = <span class="keyword">this</span>.rows,
			cols = <span class="keyword">this</span>.cols,
			R = <span class="keyword">this</span>.copy(),
			Q = MathLib.Matrix.identity(rows),
			c, s, rho, i, j, k, ri, rj, qi, qj; 
			
	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; cols; i++) {
		<span class="keyword">for</span> (j = i + <span class="number">1</span>; j &lt; rows; j++) {

			<span class="keyword">if</span> (!MathLib.isZero(R[j][i])) {</pre></div></div>
            
        </li>
        
        
        <li id="section-342">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-342">&#182;</a>
              </div>
              <p>We can&#39;t use the sign function here, because we want the factor 
to be 1 if A[i][i] is zero.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				rho = (R[i][i] &lt; <span class="number">0</span> ? -<span class="number">1</span> : <span class="number">1</span>) * MathLib.hypot(R[i][i],  R[j][i]);
				c   = R[i][i] / rho;
				s   = R[j][i] / rho;</pre></div></div>
            
        </li>
        
        
        <li id="section-343">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-343">&#182;</a>
              </div>
              <p>Apply the rotation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				ri = [];
				rj = [];
				qi = [];
				qj = [];</pre></div></div>
            
        </li>
        
        
        <li id="section-344">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-344">&#182;</a>
              </div>
              <p>Multiply to R</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; cols; k++) {
					ri.push(R[i][k]);
					rj.push(R[j][k]);
				}
				<span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; cols; k++) {
					R[i][k] = rj[k] * s + ri[k] * c;
					R[j][k] = rj[k] * c - ri[k] * s;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-345">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-345">&#182;</a>
              </div>
              <p>Multiply to Q</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; rows; k++) {
					qi.push(Q[k][i]);
					qj.push(Q[k][j]);
				}
				<span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; rows; k++) {
					Q[k][i] =  qi[k] * c + qj[k] * s;
					Q[k][j] = -qi[k] * s + qj[k] * c;
				}
			}
		}
	}

	<span class="keyword">return</span> [Q, R];
}</pre></div></div>
            
        </li>
        
        
        <li id="section-346">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-346">&#182;</a>
              </div>
              <h3 id="matrix-givensmatrix-">Matrix.givensMatrix()</h3>
<p>This function returns a givens matrix</p>
<p><em>@param {number}</em> The size of the matrix.<br><em>@param {number}</em> The first row/column.<br><em>@param {number}</em> The second row/column.<br><em>@param {number}</em> The angle (in radians).<br><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static givensMatrix = <span class="function"><span class="keyword">function</span> <span class="params">(n, i, k, phi)</span> {</span>
	<span class="keyword">var</span> givens = MathLib.Matrix.identity(n);
	givens[k][k] = givens[i][i] = Math.cos(phi);
	givens[i][k] = Math.sin(phi);
	givens[k][i] = -givens[i][k];
	<span class="keyword">return</span> givens;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-347">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-347">&#182;</a>
              </div>
              <h3 id="matrix-identity">Matrix.identity</h3>
<p>Returns the identity matrix.</p>
<p><em>@param {number}</em> The number of rows and columns.<br><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static identity = <span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span>
	<span class="keyword">var</span> row = [],
			matrix = [],
			i, ii;
	n = n || <span class="number">1</span>;

	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = n - <span class="number">1</span>; i &lt; ii; i++) {
		row.push(<span class="number">0</span>);
	}
	row.push(<span class="number">1</span>);
	row = row.concat(row);
	row = row.slice(<span class="number">0</span>, -<span class="number">1</span>);

	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = n; i &lt; ii; i++) {
		matrix.push(row.slice(n - i - <span class="number">1</span>, <span class="number">2</span> * n - i - <span class="number">1</span>));
	}

	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Matrix(matrix);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-348">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-348">&#182;</a>
              </div>
              <h3 id="matrix-prototype-inverse-">Matrix.prototype.inverse()</h3>
<p>Calculates the inverse matrix.</p>
<p><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>inverse() {
	<span class="keyword">var</span> i, ii, res, inverse,
			col = [],
			matrix = [],
			n = <span class="keyword">this</span>.rows;

	<span class="keyword">if</span> (!<span class="keyword">this</span>.isSquare()) {
		MathLib.error({message: <span class="string">'Inverse of non square matrix'</span>, method: <span class="string">'Matrix#inverse'</span>});
		<span class="keyword">return</span>;
	}

	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = n - <span class="number">1</span>; i &lt; ii; i++) {
		matrix.push([]);
		col.push(<span class="number">0</span>);
	}

	matrix.push([]);

	col.push(<span class="number">1</span>);
	col = col.concat(col).slice(<span class="number">0</span>, -<span class="number">1</span>);

	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = n; i &lt; ii; i++) {
		res = <span class="keyword">this</span>.solve(col.slice(n - i - <span class="number">1</span>, <span class="number">2</span> * n - i - <span class="number">1</span>))

		<span class="keyword">if</span> (res === <span class="literal">undefined</span>) {
			<span class="keyword">return</span>;
		}
		
		res.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(x, i)</span> {</span>
			matrix[i].push(x);
		});
	}

	inverse = <span class="keyword">new</span> MathLib.Matrix(matrix);
	<span class="keyword">this</span>.inverse = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
		<span class="keyword">return</span> inverse;
	};
	<span class="keyword">return</span> inverse;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-349">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-349">&#182;</a>
              </div>
              <h3 id="matrix-prototype-isbandmatrix-">Matrix.prototype.isBandMatrix()</h3>
<p>Determines if the matrix is a band matrix.</p>
<p><em>@param {number}</em><br><em>@param {number}</em><br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isBandMatrix(l, u) : boolean {</pre></div></div>
            
        </li>
        
        
        <li id="section-350">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-350">&#182;</a>
              </div>
              <p>var i, j, ii, jj;</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	
	<span class="keyword">if</span> (arguments.length === <span class="number">1</span>) {
		u = l;
	}

	<span class="keyword">return</span> <span class="keyword">this</span>.every(<span class="function"><span class="keyword">function</span> <span class="params">(x, i, j)</span> {</span>
		<span class="keyword">return</span> (i - l &lt;= j &amp;&amp; i + u &gt;= j) || MathLib.isZero(x);
	});</pre></div></div>
            
        </li>
        
        
        <li id="section-351">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-351">&#182;</a>
              </div>
              <p>for (i = 0, ii = this.rows; i &lt; ii; i++) {
  for (j = 0, jj = this.cols; j &lt; jj; j++) {
    if (i - j &lt; l &amp;&amp; this[i][j] !== 0) {
      return false;
    }
  }
}
return true;</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>}</pre></div></div>
            
        </li>
        
        
        <li id="section-352">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-352">&#182;</a>
              </div>
              <h3 id="matrix-prototype-isdiag-">Matrix.prototype.isDiag()</h3>
<p>Determines if the matrix is a diagonal matrix.</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isDiag() : boolean {
	<span class="keyword">var</span> i, j, ii, jj;
	<span class="keyword">if</span> (Number(<span class="keyword">this</span>.hasOwnProperty(<span class="string">'isUpper'</span>) &amp;&amp; <span class="keyword">this</span>.isUpper()) + 
			Number(<span class="keyword">this</span>.hasOwnProperty(<span class="string">'isLower'</span>) &amp;&amp; <span class="keyword">this</span>.isLower()) + 
			Number(<span class="keyword">this</span>.hasOwnProperty(<span class="string">'isSymmetric'</span>) &amp;&amp; <span class="keyword">this</span>.isSymmetric()) &gt; <span class="number">1</span>) {
		<span class="keyword">return</span> <span class="literal">true</span>;
	}
	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.rows; i &lt; ii; i++) {
		<span class="keyword">for</span> (j = <span class="number">0</span>, jj = <span class="keyword">this</span>.cols; j &lt; jj; j++) {
			<span class="keyword">if</span> (i !== j &amp;&amp; !MathLib.isZero(<span class="keyword">this</span>[i][j])) {
				<span class="keyword">return</span> <span class="literal">false</span>;
			}
		}
	}
	<span class="keyword">return</span> <span class="literal">true</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-353">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-353">&#182;</a>
              </div>
              <h3 id="matrix-prototype-isequal-">Matrix.prototype.isEqual()</h3>
<p>Determines if the matrix is equal to an other matrix.</p>
<p><em>@param {Matrix}</em> the matrix to compare with<br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isEqual(x) : boolean {
	<span class="keyword">var</span> i, j, ii, jj;
	<span class="keyword">if</span> (<span class="keyword">this</span> === x) {
		<span class="keyword">return</span> <span class="literal">true</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.rows === x.rows &amp;&amp; <span class="keyword">this</span>.cols === x.cols) {
		<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.rows; i &lt; ii; i++) {
			<span class="keyword">for</span> (j = <span class="number">0</span>, jj = <span class="keyword">this</span>.cols; j &lt; jj; j++) {
				<span class="keyword">if</span> (!MathLib.isEqual(<span class="keyword">this</span>[i][j], x[i][j])) {
					<span class="keyword">return</span> <span class="literal">false</span>;
				}
			}
		}
		<span class="keyword">return</span> <span class="literal">true</span>;
	}
	<span class="keyword">return</span> <span class="literal">false</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-354">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-354">&#182;</a>
              </div>
              <h3 id="matrix-prototype-isidentity-">Matrix.prototype.isIdentity()</h3>
<p>Determines if the matrix is a identity matrix.</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isIdentity() : boolean {
	<span class="keyword">if</span> (!<span class="keyword">this</span>.isSquare()) {
		<span class="keyword">return</span> <span class="literal">false</span>;
	}

	<span class="keyword">var</span> isIdentity = <span class="keyword">this</span>.every(<span class="function"><span class="keyword">function</span> <span class="params">(x, r, c)</span> {</span>
		<span class="keyword">return</span> r === c ? MathLib.isOne(x) : MathLib.isZero(x);
	});

	<span class="keyword">this</span>.isIdentity = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
		<span class="keyword">return</span> isIdentity;
	};
	<span class="keyword">return</span> isIdentity;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-355">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-355">&#182;</a>
              </div>
              <h3 id="matrix-prototype-isinvertible-">Matrix.prototype.isInvertible()</h3>
<p>Determines if the matrix is invertible.</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isInvertible() : boolean {
	<span class="keyword">return</span> <span class="keyword">this</span>.isSquare() &amp;&amp; <span class="keyword">this</span>.rank() === <span class="keyword">this</span>.rows;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-356">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-356">&#182;</a>
              </div>
              <h3 id="matrix-prototype-islower-">Matrix.prototype.isLower()</h3>
<p>Determines if the matrix is a lower triangular matrix.</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isLower() : boolean {
	<span class="keyword">return</span> <span class="keyword">this</span>.slice(<span class="number">0</span>, -<span class="number">1</span>).every(<span class="function"><span class="keyword">function</span> <span class="params">(x, i)</span> {</span>
		<span class="keyword">return</span> x.slice(i + <span class="number">1</span>).every(MathLib.isZero);
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-357">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-357">&#182;</a>
              </div>
              <h3 id="matrix-prototype-isnegdefinite-">Matrix.prototype.isNegDefinite()</h3>
<p>Determines if the matrix is negative definite</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isNegDefinite() : boolean {
	<span class="keyword">if</span> (!<span class="keyword">this</span>.isSquare()) {
		<span class="keyword">return</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.rows === <span class="number">1</span>) {
		<span class="keyword">return</span> <span class="keyword">this</span>[<span class="number">0</span>][<span class="number">0</span>] &lt; <span class="number">0</span>;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-358">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-358">&#182;</a>
              </div>
              <p>Sylvester&#39;s criterion</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (<span class="keyword">this</span>.rows % <span class="number">2</span> === <span class="number">0</span>) {
		<span class="keyword">return</span> <span class="keyword">this</span>.determinant() &gt; <span class="number">0</span> &amp;&amp; <span class="keyword">this</span>.remove(<span class="keyword">this</span>.rows - <span class="number">1</span>, <span class="keyword">this</span>.cols - <span class="number">1</span>).isNegDefinite();
	}
	<span class="keyword">else</span> {
		<span class="keyword">return</span> <span class="keyword">this</span>.determinant() &lt; <span class="number">0</span> &amp;&amp; <span class="keyword">this</span>.remove(<span class="keyword">this</span>.rows - <span class="number">1</span>, <span class="keyword">this</span>.cols - <span class="number">1</span>).isNegDefinite();
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-359">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-359">&#182;</a>
              </div>
              <h3 id="matrix-prototype-isorthogonal-">Matrix.prototype.isOrthogonal()</h3>
<p>Determines if the matrix is a orthogonal.</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isOrthogonal() : boolean {
	<span class="keyword">return</span> <span class="keyword">this</span>.transpose().times(<span class="keyword">this</span>).isIdentity();
}</pre></div></div>
            
        </li>
        
        
        <li id="section-360">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-360">&#182;</a>
              </div>
              <h3 id="matrix-prototype-ispermutation-">Matrix.prototype.isPermutation()</h3>
<p>Determines if the matrix is a permutation matrix</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isPermutation() : boolean {
	<span class="keyword">var</span> rows = [],
			cols = [];

	<span class="keyword">return</span> <span class="keyword">this</span>.every(<span class="function"><span class="keyword">function</span> <span class="params">(x, r, c)</span> {</span>
		<span class="keyword">if</span> (MathLib.isOne(x)) {
			<span class="keyword">if</span> (rows[r] || cols[c]) {
				<span class="keyword">return</span> <span class="literal">false</span>;
			}
			<span class="keyword">else</span> {
				rows[r] = <span class="literal">true</span>;
				cols[c] = <span class="literal">true</span>;
				<span class="keyword">return</span> <span class="literal">true</span>;
			}
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (MathLib.isZero(x)) {
			<span class="keyword">return</span> <span class="literal">true</span>;
		}
		<span class="keyword">return</span> <span class="literal">false</span>;
	}) &amp;&amp; rows.length === <span class="keyword">this</span>.rows &amp;&amp; cols.length === <span class="keyword">this</span>.cols;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-361">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-361">&#182;</a>
              </div>
              <h3 id="matrix-prototype-isposdefinite-">Matrix.prototype.isPosDefinite()</h3>
<p>Determines if the matrix is positive definite</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isPosDefinite() : boolean {
	<span class="keyword">if</span> (!<span class="keyword">this</span>.isSquare()) {
		<span class="keyword">return</span>;
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.rows === <span class="number">1</span>) {
		<span class="keyword">return</span> <span class="keyword">this</span>[<span class="number">0</span>][<span class="number">0</span>] &gt; <span class="number">0</span>;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-362">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-362">&#182;</a>
              </div>
              <p>Sylvester&#39;s criterion</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">return</span> <span class="keyword">this</span>.determinant() &gt; <span class="number">0</span> &amp;&amp; <span class="keyword">this</span>.remove(<span class="keyword">this</span>.rows - <span class="number">1</span>, <span class="keyword">this</span>.cols - <span class="number">1</span>).isPosDefinite();
}</pre></div></div>
            
        </li>
        
        
        <li id="section-363">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-363">&#182;</a>
              </div>
              <h3 id="matrix-prototype-isreal-">Matrix.prototype.isReal()</h3>
<p>Determines if the matrix has only real entries</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isReal() : boolean {
	<span class="keyword">return</span> <span class="keyword">this</span>.every(MathLib.isReal);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-364">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-364">&#182;</a>
              </div>
              <h3 id="matrix-prototype-isscalar-">Matrix.prototype.isScalar()</h3>
<p>Determines if the matrix is a scalar matrix
(that is a multiple of the identity matrix)</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isScalar() : boolean {
	<span class="keyword">var</span> i, ii,
			diag = <span class="keyword">this</span>.diag;
	<span class="keyword">if</span> (<span class="keyword">this</span>.hasOwnProperty(<span class="string">'isIdentity'</span>) &amp;&amp; <span class="keyword">this</span>.hasOwnProperty(<span class="string">'isZero'</span>)) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.isIdentity() || <span class="keyword">this</span>.isZero()) {
			<span class="keyword">return</span> <span class="literal">true</span>;
		}
		<span class="keyword">else</span> {
			<span class="keyword">return</span> <span class="literal">false</span>;
		}
	}
	<span class="keyword">if</span> (<span class="keyword">this</span>.isDiag()) {
		<span class="keyword">for</span> (i = <span class="number">1</span>, ii = <span class="keyword">this</span>.rows; i &lt; ii; i++) {
			<span class="keyword">if</span> (!MathLib.isEqual(diag[<span class="number">0</span>], diag[i])) {
				<span class="keyword">return</span> <span class="literal">false</span>;
			}
		}
		<span class="keyword">return</span> <span class="literal">true</span>;
	}
	<span class="keyword">return</span> <span class="literal">false</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-365">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-365">&#182;</a>
              </div>
              <h3 id="matrix-prototype-issquare-">Matrix.prototype.isSquare()</h3>
<p>Determines if the matrix is a square matrix</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isSquare() : boolean {
	<span class="keyword">return</span> <span class="keyword">this</span>.cols === <span class="keyword">this</span>.rows;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-366">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-366">&#182;</a>
              </div>
              <h3 id="matrix-prototype-issymmetric-">Matrix.prototype.isSymmetric()</h3>
<p>Determines if the matrix is symmetric</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isSymmetric() : boolean {
	<span class="keyword">var</span> i, ii, j, jj,
			isSymmetric = <span class="literal">true</span>;

	<span class="keyword">if</span> (!<span class="keyword">this</span>.isSquare()) {
		isSymmetric = <span class="literal">false</span>;
	}
	<span class="keyword">else</span> {
lp: <span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.rows; i &lt; ii; i++) {
			<span class="keyword">for</span> (j = i + <span class="number">1</span>, jj = <span class="keyword">this</span>.cols; j &lt; jj; j++) {
				<span class="keyword">if</span> (!MathLib.isEqual(<span class="keyword">this</span>[i][j], <span class="keyword">this</span>[j][i])) {
					isSymmetric = <span class="literal">false</span>;
					<span class="keyword">break</span> lp;
				}
			}
		}
	}

	<span class="keyword">this</span>.isSymmetric = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
		<span class="keyword">return</span> isSymmetric;
	};
	<span class="keyword">return</span> isSymmetric;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-367">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-367">&#182;</a>
              </div>
              <h3 id="matrix-prototype-isupper-">Matrix.prototype.isUpper()</h3>
<p>Determines if the matrix is a upper triangular matrix</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isUpper() : boolean {
	<span class="keyword">return</span> <span class="keyword">this</span>.slice(<span class="number">1</span>).every(<span class="function"><span class="keyword">function</span> <span class="params">(x, i)</span> {</span>
		<span class="keyword">return</span> x.slice(<span class="number">0</span>, i + <span class="number">1</span>).every(MathLib.isZero);
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-368">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-368">&#182;</a>
              </div>
              <h3 id="matrix-prototype-isvector-">Matrix.prototype.isVector()</h3>
<p>Determines if the matrix is a vector
(only one row or one column)</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isVector() : boolean {
	<span class="keyword">return</span> (<span class="keyword">this</span>.rows === <span class="number">1</span>) || (<span class="keyword">this</span>.cols === <span class="number">1</span>);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-369">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-369">&#182;</a>
              </div>
              <h3 id="matrix-prototype-iszero-">Matrix.prototype.isZero()</h3>
<p>Determines if the matrix the zero matrix
The result is cached.</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isZero() : boolean {
	<span class="keyword">var</span> isZero = <span class="keyword">this</span>.every(MathLib.isZero);

	<span class="keyword">this</span>.isZero = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
		<span class="keyword">return</span> isZero;
	};
	<span class="keyword">return</span> isZero;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-370">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-370">&#182;</a>
              </div>
              <h3 id="matrix-prototype-map-">Matrix.prototype.map()</h3>
<p>This function works like the Array.prototype.map function.
The matrix is processed row by row.
The function is called with the following arguments:
the entry at the current position, the number of the row,
the number of the column and the complete matrix</p>
<p><em>@param {function}</em> The function which is called on every argument<br><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>map(f) {
	<span class="keyword">var</span> m = <span class="keyword">this</span>;
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Matrix(
		Array.prototype.map.call(<span class="keyword">this</span>, <span class="function"><span class="keyword">function</span> <span class="params">(x, i)</span> {</span>
			<span class="keyword">return</span> Array.prototype.map.call(x, <span class="function"><span class="keyword">function</span> <span class="params">(y, j)</span> {</span>
				<span class="keyword">return</span> f(y, i, j, m);
			});
		})
	);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-371">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-371">&#182;</a>
              </div>
              <h3 id="matrix-prototype-minor-">Matrix.prototype.minor()</h3>
<p>Calculates a minor</p>
<p><em>@param {number}</em> The row to be removed.<br><em>@param {number}</em> The column to be removed.<br><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>minor(r, c) {
	<span class="keyword">return</span> <span class="keyword">this</span>.remove(r, c).determinant();
}</pre></div></div>
            
        </li>
        
        
        <li id="section-372">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-372">&#182;</a>
              </div>
              <h3 id="matrix-prototype-minus-">Matrix.prototype.minus()</h3>
<p>Calculates the difference of two matrices</p>
<p><em>@param {Matrix}</em> The matrix to be subtracted.<br><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>minus(m) {
	<span class="keyword">if</span> (<span class="keyword">this</span>.rows === m.rows &amp;&amp; <span class="keyword">this</span>.cols === m.cols) {
		<span class="keyword">return</span> <span class="keyword">this</span>.plus(m.negative());
	}
	<span class="keyword">else</span> {
		MathLib.error({message: <span class="string">'Matrix sizes not matching'</span>, method: <span class="string">'Matrix#minus'</span>});
		<span class="keyword">return</span>;
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-373">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-373">&#182;</a>
              </div>
              <h3 id="matrix-prototype-negative-">Matrix.prototype.negative()</h3>
<p>Returns the negative matrix</p>
<p><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>negative() {
	<span class="keyword">var</span> i, ii,
			negative = [];
			
	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.rows; i &lt; ii; i++) {
		negative.push(<span class="keyword">this</span>[i].map(MathLib.negative));
	}
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Matrix(negative);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-374">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-374">&#182;</a>
              </div>
              <h3 id="matrix-numbers-">Matrix.numbers()</h3>
<p>Returns a matrix consisting completely of a given number</p>
<p><em>@param {number}</em> The number.<br><em>@param {number}</em> The number of rows.<br><em>@param {number}</em> The number of columns.<br><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static numbers = <span class="function"><span class="keyword">function</span> <span class="params">(n, r, c)</span> {</span>
	<span class="keyword">var</span> i, ii,
			row = [],
			matrix = [];
			
	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = c || r || <span class="number">1</span>; i &lt; ii; i++) {
		row.push(n);
	}
	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = r || <span class="number">1</span>; i &lt; ii ; i++) {
		matrix.push(row.slice(<span class="number">0</span>));
	}
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Matrix(matrix);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-375">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-375">&#182;</a>
              </div>
              <h3 id="matrix-one-">Matrix.one()</h3>
<p>Returns a matrix consisting completely of ones.</p>
<p><em>@param {number}</em> The number of rows.<br><em>@param {number}</em> The number of columns.<br><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static one = <span class="function"><span class="keyword">function</span> <span class="params">(r, c)</span> {</span>
	r = r || <span class="number">1</span>;
	c = c || <span class="number">1</span>;
	<span class="keyword">return</span> MathLib.Matrix.numbers(<span class="number">1</span>, r, c);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-376">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-376">&#182;</a>
              </div>
              <h3 id="matrix-prototype-plus-">Matrix.prototype.plus()</h3>
<p>This function adds a matrix to the current matrix
and returns the result as a new matrix.</p>
<p><em>@param {Matrix}</em> The matrix to be added.<br><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>plus(m) {
	<span class="keyword">var</span> i, ii, j, jj,
			sum = [];

	<span class="keyword">if</span> (<span class="keyword">this</span>.rows === m.rows &amp;&amp; <span class="keyword">this</span>.cols === m.cols) {
		<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.rows; i &lt; ii; i++) {
			sum[i] = [];
			<span class="keyword">for</span> (j = <span class="number">0</span>, jj = <span class="keyword">this</span>.cols ; j &lt; jj; j++) {
				sum[i][j] = MathLib.plus(<span class="keyword">this</span>[i][j], m[i][j]);
			}
		}
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Matrix(sum);
	}
	<span class="keyword">else</span> {
		MathLib.error({message: <span class="string">'Matrix sizes not matching'</span>, method: <span class="string">'Matrix#plus'</span>});
		<span class="keyword">return</span>;
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-377">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-377">&#182;</a>
              </div>
              <h3 id="matrix-random-">Matrix.random()</h3>
<p>Returns a matrix consisting completely of random numbers between 0 and 1</p>
<p><em>@param {number}</em> The number of rows.<br><em>@param {number}</em> The number of columns.<br><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static random = <span class="function"><span class="keyword">function</span> <span class="params">(r, c)</span> {</span>
	<span class="keyword">var</span> row,
			matrix = [],
			i, j, ii, jj;
	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = r || <span class="number">1</span>; i &lt; ii; i++) {
		row = [];
		<span class="keyword">for</span> (j = <span class="number">0</span>, jj = c || r || <span class="number">1</span>; j &lt; jj; j++) {
			row.push(Math.random());
		}
		matrix.push(row);
	}
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Matrix(matrix);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-378">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-378">&#182;</a>
              </div>
              <h3 id="matrix-prototype-rank-">Matrix.prototype.rank()</h3>
<p>Determines the rank of the matrix</p>
<p><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>rank() {
	<span class="keyword">var</span> i, j,
			rank = <span class="number">0</span>,
			mat = <span class="keyword">this</span>.rref();

	rankloop: <span class="keyword">for</span> (i = Math.min(<span class="keyword">this</span>.rows, <span class="keyword">this</span>.cols) - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) {
		<span class="keyword">for</span> (j = <span class="keyword">this</span>.cols - <span class="number">1</span>; j &gt;= i; j--) {
			<span class="keyword">if</span> (!MathLib.isZero(mat[i][j])) {
				rank = i + <span class="number">1</span>;
				<span class="keyword">break</span> rankloop;
			}
		}
	}

	<span class="keyword">this</span>.rank = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
		<span class="keyword">return</span> rank;
	};
	<span class="keyword">return</span> rank;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-379">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-379">&#182;</a>
              </div>
              <h3 id="matrix-prototype-reduce-">Matrix.prototype.reduce()</h3>
<p>This function works like the Array.prototype.reduce function.</p>
<p><em>@return {any}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>reduce(...args : any[]) {
	<span class="keyword">return</span> Array.prototype.reduce.apply(<span class="keyword">this</span>, args);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-380">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-380">&#182;</a>
              </div>
              <h3 id="matrix-prototype-remove-">Matrix.prototype.remove()</h3>
<p>This function removes the specified rows and/or columns for the matrix.</p>
<p><em>@param {number|array}</em> The row(s) to be removed.<br><em>@param {number|array}</em> The column(s) to be removed.<br><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>remove(row, col) {
	<span class="keyword">var</span> rest = <span class="keyword">this</span>.toArray();

	<span class="keyword">if</span> (row || row === <span class="number">0</span>) {
		<span class="keyword">if</span> (<span class="keyword">typeof</span> row === <span class="string">'number'</span>) {
			row = [row];
		}
		rest = rest.filter(<span class="function"><span class="keyword">function</span> <span class="params">(x, i)</span> {</span>
			<span class="keyword">return</span> row.indexOf(i) === -<span class="number">1</span>;
		});
	}

	<span class="keyword">if</span> (col || col === <span class="number">0</span>) {
		<span class="keyword">if</span> (<span class="keyword">typeof</span> col === <span class="string">'number'</span>) {
			col = [col];
		}
		col = col.sort().reverse();
		col.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span>
			rest = rest.map(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
				x.splice(n, <span class="number">1</span>);
				<span class="keyword">return</span> x;
			});
		});
	}

	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Matrix(rest);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-381">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-381">&#182;</a>
              </div>
              <h3 id="matrix-prototype-rref-">Matrix.prototype.rref()</h3>
<p>Calculate the reduced row echelon form (rref) of a matrix.</p>
<p><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>rref() {
	<span class="keyword">var</span> i, ii, j, jj, k, kk, pivot, factor, swap,
			lead = <span class="number">0</span>,
			rref = <span class="keyword">this</span>.toArray();

	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.rows; i &lt; ii; i++) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.cols &lt;= lead) {
			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Matrix(rref);
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-382">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-382">&#182;</a>
              </div>
              <p>Find the row with the biggest pivot element</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		j = i;
		<span class="keyword">while</span> (rref[j][lead] === <span class="number">0</span>) {
			j++;
			<span class="keyword">if</span> (<span class="keyword">this</span>.rows === j) {
				j = i;
				lead++;
				<span class="keyword">if</span> (<span class="keyword">this</span>.cols === lead) {
					<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Matrix(rref);
				}
			}
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-383">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-383">&#182;</a>
              </div>
              <p>Swap the pivot row to the top </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (i !== j) {
			swap = rref[j];
			rref[j] = rref[i];
			rref[i] = swap;
		}

		pivot = rref[i][lead];</pre></div></div>
            
        </li>
        
        
        <li id="section-384">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-384">&#182;</a>
              </div>
              <p>Divide the pivot row by the pivot element</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">for</span> (j = lead, jj = <span class="keyword">this</span>.cols; j &lt; jj; j++) {
			rref[i][j] /= pivot;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-385">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-385">&#182;</a>
              </div>
              <p>Reduce the other rows with the pivot row</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">for</span> (j = <span class="number">0</span>, jj = <span class="keyword">this</span>.rows; j &lt; jj; j++) {
			<span class="keyword">if</span> (j === i) {
				<span class="keyword">continue</span>;
			}
			factor = rref[j][lead];
			<span class="keyword">for</span> (k = <span class="number">0</span>, kk = <span class="keyword">this</span>.cols; k &lt; kk; k++) {
				rref[j][k] = MathLib.minus(rref[j][k], MathLib.times(factor, rref[i][k]));
			}
		}
		lead++;
	}
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Matrix(rref);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-386">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-386">&#182;</a>
              </div>
              <h3 id="matrix-prototype-slice-">Matrix.prototype.slice()</h3>
<p>This function works like the Array.prototype.slice function.</p>
<p><em>@return {array}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>slice(...args : any[]) {
	<span class="keyword">return</span> Array.prototype.slice.apply(<span class="keyword">this</span>, args);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-387">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-387">&#182;</a>
              </div>
              <h3 id="matrix-prototype-solve-">Matrix.prototype.solve()</h3>
<p>Solves the system of linear equations Ax = b
given by the matrix A and a vector or point b.</p>
<p><em>@param {Vector|Point}</em> The b in Ax = b<br><em>@return {Vector|Point}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>solve(b) {</pre></div></div>
            
        </li>
        
        
        <li id="section-388">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-388">&#182;</a>
              </div>
              <p>Ax = b -&gt; LUx = b. Then y is defined to be Ux</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">var</span> LU = <span class="keyword">this</span>.LU(),
			i, j,
			n = b.length,
			x = [],
			y = [];</pre></div></div>
            
        </li>
        
        
        <li id="section-389">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-389">&#182;</a>
              </div>
              <p>Permutate b according to the LU decomposition</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	b = <span class="keyword">this</span>.LUpermutation.applyTo(b);</pre></div></div>
            
        </li>
        
        
        <li id="section-390">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-390">&#182;</a>
              </div>
              <p>Forward solve Ly = b</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++) {
		y[i] = b[i];
		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; i; j++) {
			y[i] = MathLib.minus(y[i], MathLib.times(LU[i][j], y[j]));
		}
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-391">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-391">&#182;</a>
              </div>
              <p>Backward solve Ux = y</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">for</span> (i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) {
		x[i] = y[i];
		<span class="keyword">for</span> (j = i + <span class="number">1</span>; j &lt; n; j++) {
			x[i] = MathLib.minus(x[i], MathLib.times(LU[i][j], x[j]));
		}

		<span class="keyword">if</span> (LU[i][i] === <span class="number">0</span>) {
			<span class="keyword">if</span> (x[i] !== <span class="number">0</span>) {
				<span class="keyword">return</span> <span class="literal">undefined</span>;
			}
			<span class="keyword">else</span> {
				x[i] = x[i];
			}
		}
		<span class="keyword">else</span> {
			x[i] = MathLib.divide(x[i], LU[i][i]);
		}
	}

	<span class="keyword">if</span> (MathLib.type(b) === <span class="string">'array'</span>) {
		<span class="keyword">return</span> x;
	}
	<span class="keyword">else</span> {
		<span class="keyword">return</span> <span class="keyword">new</span> b.constructor(x);
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-392">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-392">&#182;</a>
              </div>
              <h3 id="matrix-prototype-some-">Matrix.prototype.some()</h3>
<p>This function works like the Array.prototype.some function.
The matrix is processed row by row.
The function is called with the following arguments:
the entry at the current position, the number of the row,
the number of the column and the complete matrix</p>
<p><em>@param {function}</em> The function which is called on every argument<br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>some(f) : boolean {
	<span class="keyword">return</span> Array.prototype.some.call(<span class="keyword">this</span>, <span class="function"><span class="keyword">function</span> <span class="params">(x, i)</span> {</span>
		<span class="keyword">return</span> Array.prototype.some.call(x, <span class="function"><span class="keyword">function</span> <span class="params">(y, j)</span> {</span>
			<span class="keyword">return</span> f(y, i, j, <span class="keyword">this</span>);
		});
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-393">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-393">&#182;</a>
              </div>
              <h3 id="matrix-prototype-times-">Matrix.prototype.times()</h3>
<p>Multiplies the current matrix with a number, a matrix, a point or a vector.</p>
<p><em>@param {number|Matrix|Point|Rational|Vector}</em><br><em>@return {Matrix|Point|Vector}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>times(a) {
	<span class="keyword">var</span> i, ii, j, jj, k, kk,
			product = [], entry;

	<span class="keyword">if</span> (a.type === <span class="string">'rational'</span>) {
		a = a.toNumber(); 
	}
	<span class="keyword">if</span> (<span class="keyword">typeof</span> a === <span class="string">'number'</span> || a.type === <span class="string">'complex'</span>) {
		<span class="keyword">return</span> <span class="keyword">this</span>.map(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
			<span class="keyword">return</span> MathLib.times(x, a);
		});
	}

	<span class="keyword">else</span> <span class="keyword">if</span> (a.type === <span class="string">'matrix'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.cols === a.rows) {
			<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.rows; i &lt; ii; i++) {
				product[i] = [];
				<span class="keyword">for</span> (j = <span class="number">0</span>, jj = a.cols; j &lt; jj; j++) {
					entry = <span class="number">0</span>;

					<span class="keyword">for</span> (k = <span class="number">0</span>, kk = <span class="keyword">this</span>.cols; k &lt; kk; k++) {
						entry = MathLib.plus(entry, MathLib.times(<span class="keyword">this</span>[i][k], a[k][j]));
					}
					product[i][j] = entry;
				}
			}
			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Matrix(product);
		}
		<span class="keyword">else</span> {
			MathLib.error({message: <span class="string">'Matrix sizes not matching'</span>, method: <span class="string">'Matrix#times'</span>});
			<span class="keyword">return</span>;
		}
	}

	<span class="keyword">else</span> <span class="keyword">if</span> (a.type === <span class="string">'point'</span> || a.type === <span class="string">'vector'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.cols === a.length) {
			<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.rows; i &lt; ii; i++) {
				entry = <span class="number">0</span>;
				<span class="keyword">for</span> (j = <span class="number">0</span>, jj = <span class="keyword">this</span>.cols; j &lt; jj; j++) {
					entry = MathLib.plus(entry, MathLib.times(<span class="keyword">this</span>[i][j], a[j]));
				}
				product.push(entry);
			}
			<span class="keyword">return</span> <span class="keyword">new</span> a.constructor(product);
		}
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-394">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-394">&#182;</a>
              </div>
              <h3 id="matrix-prototype-toarray-">Matrix.prototype.toArray()</h3>
<p>Converts the matrix to a two-dimensional array</p>
<p><em>@return {array}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toArray() {
	<span class="keyword">return</span> Array.prototype.map.call(<span class="keyword">this</span>, <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> Array.prototype.map.call(x, <span class="function"><span class="keyword">function</span> <span class="params">(y)</span> {</span>
			<span class="keyword">return</span> MathLib.copy(y);
		});
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-395">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-395">&#182;</a>
              </div>
              <h3 id="matrix-prototype-tocolvectors-">Matrix.prototype.toColVectors()</h3>
<p>Converts the columns of the matrix to vectors</p>
<p><em>@return {array}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toColVectors() {
	<span class="keyword">return</span> <span class="keyword">this</span>.transpose().toRowVectors();
}</pre></div></div>
            
        </li>
        
        
        <li id="section-396">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-396">&#182;</a>
              </div>
              <h3 id="matrix-prototype-tocontentmathml-">Matrix.prototype.toContentMathML()</h3>
<p>converting the matrix to content MathML</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toContentMathML() : string {
	<span class="keyword">return</span> <span class="keyword">this</span>.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(str, x)</span> {</span>
		<span class="keyword">return</span> str + x.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(prev, cur)</span> {</span>
			<span class="keyword">return</span> prev + MathLib.toContentMathML(cur);
		}, <span class="string">'&lt;matrixrow&gt;'</span>) + <span class="string">'&lt;/matrixrow&gt;'</span>;
	}, <span class="string">'&lt;matrix&gt;'</span>) + <span class="string">'&lt;/matrix&gt;'</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-397">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-397">&#182;</a>
              </div>
              <h3 id="matrix-prototype-tolatex-">Matrix.prototype.toLaTeX()</h3>
<p>Converting the matrix to LaTeX</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toLaTeX() : string {
	<span class="keyword">return</span> <span class="string">'\\begin{pmatrix}\n'</span> + <span class="keyword">this</span>.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(str, x)</span> {</span>
		<span class="keyword">return</span> str + x.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(prev, cur)</span> {</span>
			<span class="keyword">return</span> prev + <span class="string">' &amp; '</span> + MathLib.toLaTeX(cur);
		}) + <span class="string">'\\\n'</span>;
	}, <span class="string">''</span>).slice(<span class="number">0</span>, -<span class="number">2</span>) + <span class="string">'\n\\end{pmatrix}'</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-398">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-398">&#182;</a>
              </div>
              <h3 id="matrix-prototype-tomathml-">Matrix.prototype.toMathML()</h3>
<p>converting the matrix to (presentation) MathML</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toMathML() : string {
	<span class="keyword">return</span> <span class="keyword">this</span>.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(str, x)</span> {</span>
		<span class="keyword">return</span> str + x.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(prev, cur)</span> {</span>
			<span class="keyword">return</span> prev + <span class="string">'&lt;mtd&gt;'</span> + MathLib.toMathML(cur) + <span class="string">'&lt;/mtd&gt;'</span>;
		}, <span class="string">'&lt;mtr&gt;'</span>) + <span class="string">'&lt;/mtr&gt;'</span>;
	}, <span class="string">'&lt;mrow&gt;&lt;mo&gt; ( &lt;/mo&gt;&lt;mtable&gt;'</span>) + <span class="string">'&lt;/mtable&gt;&lt;mo&gt; ) &lt;/mo&gt;&lt;/mrow&gt;'</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-399">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-399">&#182;</a>
              </div>
              <h3 id="matrix-prototype-torowvectors-">Matrix.prototype.toRowVectors()</h3>
<p>Converts the rows of the matrix to vectors</p>
<p><em>@return {array}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toRowVectors() : string {
	<span class="keyword">return</span> <span class="keyword">this</span>.toArray().map(<span class="function"><span class="keyword">function</span> <span class="params">(v)</span> {</span><span class="keyword">return</span> <span class="keyword">new</span> MathLib.Vector(v);});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-400">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-400">&#182;</a>
              </div>
              <h3 id="matrix-prototype-tostring-">Matrix.prototype.toString()</h3>
<p>Creating a custom .toString() function</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toString() : string {
	<span class="keyword">return</span> <span class="keyword">this</span>.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(str, x)</span> {</span>
		<span class="keyword">return</span> str + x.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(prev, cur)</span> {</span>
			<span class="keyword">return</span> prev + <span class="string">'\t'</span> + MathLib.toString(cur);
		}) + <span class="string">'\n'</span>;
	}, <span class="string">''</span>).slice(<span class="number">0</span>, -<span class="number">1</span>);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-401">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-401">&#182;</a>
              </div>
              <h3 id="matrix-prototype-trace-">Matrix.prototype.trace()</h3>
<p>Calculating the trace of the matrix</p>
<p><em>@return {number|Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>trace() {
	<span class="keyword">var</span> trace = MathLib.plus.apply(<span class="literal">null</span>, <span class="keyword">this</span>.diag());

	<span class="keyword">this</span>.trace = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
		<span class="keyword">return</span> trace;
	};
	<span class="keyword">return</span> trace;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-402">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-402">&#182;</a>
              </div>
              <h3 id="matrix-prototype-transpose-">Matrix.prototype.transpose()</h3>
<p>Calculating the transpose of the matrix
The result is cached.</p>
<p><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>transpose() : Matrix {
	<span class="keyword">var</span> transposedMatrix, row, i, j, ii, jj,
			transpose = [];

	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.cols; i &lt; ii; i++) {
		row = [];
		<span class="keyword">for</span> (j = <span class="number">0</span>, jj = <span class="keyword">this</span>.rows; j &lt; jj; j++) {
			row.push(<span class="keyword">this</span>[j][i]);
		}
		transpose.push(row);
	}

	transposedMatrix = <span class="keyword">new</span> MathLib.Matrix(transpose);
	<span class="keyword">this</span>.transpose = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
		<span class="keyword">return</span> transposedMatrix;
	};
	<span class="keyword">return</span> transposedMatrix;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-403">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-403">&#182;</a>
              </div>
              <h3 id="matrix-zero-">Matrix.zero()</h3>
<p>Returns a matrix consisting completely of zeros.</p>
<p><em>@param {number}</em> The number of rows.<br><em>@param {number}</em> The number of columns.<br><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static zero = <span class="function"><span class="keyword">function</span> <span class="params">(r, c)</span> {</span>
	r = r || <span class="number">1</span>;
	c = c || <span class="number">1</span>;
	<span class="keyword">return</span> MathLib.Matrix.numbers(<span class="number">0</span>, r, c);
};


}<span class="comment">// ## &lt;a id="Permutation"&gt;&lt;/a&gt;Permutation</span>

export class Permutation {

	type = <span class="string">'permutation'</span>;

	length: number;
	cycle: any[];


	constructor (p) {
		<span class="keyword">var</span> cycle, permutation;
		
		<span class="keyword">if</span> (Array.isArray(p[<span class="number">0</span>])) {
			cycle = p;
			permutation = Permutation.cycleToList(cycle);
		}
		<span class="keyword">else</span> {
			permutation = p;
			cycle = Permutation.listToCycle(permutation);
		}

		permutation.forEach((x, i) =&gt; {<span class="keyword">this</span>[i] = x;});
		<span class="keyword">this</span>.length = permutation.length;
		<span class="keyword">this</span>.cycle = cycle;

	}</pre></div></div>
            
        </li>
        
        
        <li id="section-404">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-404">&#182;</a>
              </div>
              <h3 id="permutation-prototype-applyto-">Permutation.prototype.applyTo()</h3>
<p>Applies the permutation to a number or a array/matrix/point/vector</p>
<p><em>@param {number|array|Matrix|Point|Vector}</em><br><em>@return {number|array|Matrix|Point|Vector}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>applyTo(n : any) : any {
	<span class="keyword">var</span> p, permutatedObj;
	<span class="keyword">if</span> (<span class="keyword">typeof</span> n === <span class="string">'number'</span>) {
		<span class="keyword">if</span> (n &gt;= <span class="keyword">this</span>.length) {
			<span class="keyword">return</span> n;
		}
		<span class="keyword">return</span> <span class="keyword">this</span>[n];
	}
	<span class="keyword">else</span> {
		p = <span class="keyword">this</span>;
		permutatedObj = n.map(<span class="function"><span class="keyword">function</span> <span class="params">(x, i)</span> {</span>
			<span class="keyword">return</span> n[p.applyTo(i)];
		});

		<span class="keyword">return</span> (n.type === <span class="literal">undefined</span> ? permutatedObj : <span class="keyword">new</span> n.constructor(permutatedObj));
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-405">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-405">&#182;</a>
              </div>
              <h3 id="permutation-prototype-compare-">Permutation.prototype.compare()</h3>
<p>Compares two permutations.</p>
<p><em>@param {Permutation}</em> The permutation to compare<br><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>compare(p : Permutation) : number {
	<span class="keyword">var</span> i, ii;

	<span class="keyword">if</span> (<span class="keyword">this</span>.length !== p.length) {
		<span class="keyword">return</span> MathLib.sign(<span class="keyword">this</span>.length - p.length);
	}

	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.length; i &lt; ii; i++) {
		<span class="keyword">if</span> (p[i] - <span class="keyword">this</span>[i]) {
			<span class="keyword">return</span> MathLib.sign(<span class="keyword">this</span>[i] - p[i]);
		}
	}

	<span class="keyword">return</span> <span class="number">0</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-406">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-406">&#182;</a>
              </div>
              <h3 id="permutation-cycletolist-">Permutation.cycleToList()</h3>
<p>Converts a cycle representation to a list representation</p>
<p><em>@param {array}</em> cycle The cycle to be converted<br><em>@return {array}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static cycleToList(cycle : any) : number[] {
	<span class="keyword">var</span> index, list = [],
			cur, i, ii, j, jj, max;

	max = cycle.map(<span class="function"><span class="keyword">function</span> <span class="params">(b)</span> {</span>
		<span class="keyword">return</span> Math.max.apply(<span class="literal">null</span>, b);
	});
	max = Math.max.apply(<span class="literal">null</span>, max);

	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = max; i &lt;= ii; i++) {
		cur = i;
		<span class="keyword">for</span> (j = <span class="number">0</span>, jj = cycle.length; j &lt; jj; j++) {
			index = cycle[j].indexOf(cur);
			<span class="keyword">if</span> (++index) {
				cur = cycle[j][index % cycle[j].length];
			}
		}
		list.push(cur);
	}
	<span class="keyword">return</span> list;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-407">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-407">&#182;</a>
              </div>
              <h3 id="permutation-id-">Permutation.id()</h3>
<p>The id permutation</p>
<p><em>@return {Permutation}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static id = <span class="keyword">new</span> Permutation([[]]);</pre></div></div>
            
        </li>
        
        
        <li id="section-408">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-408">&#182;</a>
              </div>
              <h3 id="permutation-prototype-inverse-">Permutation.prototype.inverse()</h3>
<p>Calculates the inverse of the permutation</p>
<p><em>@return {Permutation}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>inverse() : Permutation {
	<span class="keyword">var</span> cycle = <span class="keyword">this</span>.cycle.slice(<span class="number">0</span>);
	cycle.reverse().forEach(<span class="function"><span class="keyword">function</span> <span class="params">(e)</span> {</span>
		e.reverse();
	});
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Permutation(cycle);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-409">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-409">&#182;</a>
              </div>
              <h3 id="permutation-listtocycle-">Permutation.listToCycle()</h3>
<p>Converts a list representation to a cycle representation</p>
<p><em>@param {array}</em> list The list to be converted<br><em>@return {array}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static listToCycle(list : number[]) : any {
	<span class="keyword">var</span> finished = [],
			cur, i, ii, cycle, cycles = [];

	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = list.length; i &lt; ii; i++) {
		cur = i;
		cycle = [];
		<span class="keyword">while</span> (!finished[cur]) {
			finished[cur] = <span class="literal">true</span>;
			cycle.push(cur);
			cur = list[cur];
		}
		<span class="keyword">if</span> (cycle.length) {
			cycles.push(cycle);
		}
	}
	<span class="keyword">return</span> cycles;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-410">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-410">&#182;</a>
              </div>
              <h3 id="permutation-prototype-map-">Permutation.prototype.map()</h3>
<p>Works like Array.prototype.map.</p>
<p><em>@return {Permutation}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>map(...args: any[]) : Permutation {
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Permutation(Array.prototype.map.apply(<span class="keyword">this</span>, args));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-411">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-411">&#182;</a>
              </div>
              <h3 id="permutation-prototype-sgn-">Permutation.prototype.sgn()</h3>
<p>Calculates the signum of the permutation</p>
<p><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>sgn() : number {
	<span class="keyword">var</span> i, ii,
			count = <span class="number">0</span>;
			
	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.cycle.length; i &lt; ii; i++) {
		count += <span class="keyword">this</span>.cycle[i].length;
	}
	count += <span class="keyword">this</span>.cycle.length;
	<span class="keyword">return</span> -<span class="number">2</span> * (count % <span class="number">2</span>) + <span class="number">1</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-412">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-412">&#182;</a>
              </div>
              <h3 id="permutation-prototype-times-">Permutation.prototype.times()</h3>
<p>Multiplies two permutations</p>
<p><em>@return {Permutation}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>times(p : Permutation) : Permutation {
	<span class="keyword">var</span> a = <span class="keyword">this</span>;
	<span class="keyword">return</span> p.map(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> a[x];
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-413">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-413">&#182;</a>
              </div>
              <h3 id="permutation-prototype-tomatrix-">Permutation.prototype.toMatrix()</h3>
<p>Converts the permuatation to a matrix.</p>
<p><em>@param {number}</em> [size] The size of the matrix<br><em>@return {Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toMatrix(n : number) : Matrix {
	<span class="keyword">var</span> row = [],
			matrix = [],
			index, i, ii;
			n = n || <span class="keyword">this</span>.length;

	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = n - <span class="number">1</span>; i &lt; ii; i++) {
		row.push(<span class="number">0</span>);
	}
	row = row.concat([<span class="number">1</span>]).concat(row);
	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = n; i &lt; ii; i++) {
		index = n - <span class="keyword">this</span>.applyTo(i) - <span class="number">1</span>;
		matrix.push(row.slice(index, index + n));
	}
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Matrix(matrix);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-414">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-414">&#182;</a>
              </div>
              <h3 id="permutation-prototype-tostring-">Permutation.prototype.toString()</h3>
<p>String representation of the permutation. </p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toString() : string {
	<span class="keyword">var</span> str = <span class="string">''</span>;
	<span class="keyword">this</span>.cycle.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(elem)</span> {</span>
		str += <span class="string">'('</span> + elem.toString() + <span class="string">')'</span>;
	});
	<span class="keyword">return</span> str;
}


}<span class="comment">// ## &lt;a id="Conic" href="http://mathlib.de/en/docs/Conic"&gt;Conic&lt;/a&gt;</span></pre></div></div>
            
        </li>
        
        
        <li id="section-415">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-415">&#182;</a>
              </div>
              <p>The conic implementation of MathLib makes calculations with conics possible.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>export class Conic {
	type = <span class="string">'conic'</span>;

	primal: Matrix;
	dual: Matrix;

	constructor (primal: Matrix, dual?: Matrix) {
		<span class="keyword">if</span> (primal.type !== <span class="string">'matrix'</span>) {
			primal = <span class="keyword">new</span> MathLib.Matrix(primal);
		}
		<span class="keyword">this</span>.primal = primal;</pre></div></div>
            
        </li>
        
        
        <li id="section-416">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-416">&#182;</a>
              </div>
              <pre><code>if (!dual) {
    dual = primal.adjugate();
}</code></pre>
<p>else if (!primal.times(dual).isScalar()) {
Throw error
}</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (primal.rank() &gt; <span class="number">1</span>) {
			Object.defineProperties(<span class="keyword">this</span>, {
				<span class="string">'dual'</span>: {
					get : <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> <span class="keyword">this</span>.primal.adjugate() },
					set : <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>},
					enumerable : <span class="literal">true</span>,
					configurable : <span class="literal">true</span>
				}
			});
		}
		<span class="keyword">else</span> {
			<span class="keyword">this</span>.dual = dual;
		}

	}</pre></div></div>
            
        </li>
        
        
        <li id="section-417">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-417">&#182;</a>
              </div>
              <h3 id="-conic-prototype-draw-http-mathlib-de-en-docs-conic-draw-"><a href="http://mathlib.de/en/docs/Conic/draw">Conic.prototype.draw()</a></h3>
<p>Draws the conic on one or more screens</p>
<p><em>@param {Screen}</em> The screen to draw onto.<br><em>@param {object}</em> [options] Drawing options<br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>draw(screen, options, redraw = <span class="literal">false</span>) {
	<span class="keyword">if</span> (Array.isArray(screen)) {
		<span class="keyword">var</span> conic = <span class="keyword">this</span>;
		screen.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
			conic.draw(x, options);
		});
	}
	<span class="keyword">else</span> {
		options.from = <span class="number">0</span>;
		options.to = <span class="number">2</span> * Math.PI;
		options.conic = <span class="keyword">this</span>;

		<span class="keyword">var</span> lines, alpha, cos, sin, sgn,
				a = <span class="keyword">this</span>.primal[<span class="number">0</span>][<span class="number">0</span>],
				b = <span class="keyword">this</span>.primal[<span class="number">0</span>][<span class="number">1</span>] * <span class="number">2</span>,
				c = <span class="keyword">this</span>.primal[<span class="number">1</span>][<span class="number">1</span>],
				d = <span class="keyword">this</span>.primal[<span class="number">0</span>][<span class="number">2</span>] * <span class="number">2</span>,
				e = <span class="keyword">this</span>.primal[<span class="number">1</span>][<span class="number">2</span>] * <span class="number">2</span>,
				disc = <span class="number">4</span>*a*c - b*b,
				rank = <span class="keyword">this</span>.primal.rank(),
				cx = (b*e - <span class="number">2</span>*c*d) / (<span class="number">4</span>*a*c - b*b),
				cy = (b*d - <span class="number">2</span>*a*e) / (<span class="number">4</span>*a*c - b*b),

				normalForm = <span class="keyword">this</span>.normalize(),
				A = Math.sqrt(Math.abs(normalForm.primal[<span class="number">2</span>][<span class="number">2</span>] / normalForm.primal[<span class="number">0</span>][<span class="number">0</span>])),
				C = Math.sqrt(Math.abs(normalForm.primal[<span class="number">2</span>][<span class="number">2</span>] / normalForm.primal[<span class="number">1</span>][<span class="number">1</span>]));




		<span class="keyword">if</span> (rank === <span class="number">3</span>) {
			alpha = Math.atan2(b, a - c) / <span class="number">2</span>;
			cos = Math.cos(alpha);
			sin = Math.sin(alpha);</pre></div></div>
            
        </li>
        
        
        <li id="section-418">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-418">&#182;</a>
              </div>
              <p>Parabola</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">if</span> (disc === <span class="number">0</span>) {

				options.from = -<span class="number">10</span>;
				options.to = <span class="number">10</span>;
				
				<span class="keyword">var</span> param = -<span class="keyword">this</span>.primal[<span class="number">1</span>][<span class="number">2</span>] / (<span class="number">2</span> * <span class="keyword">this</span>.primal[<span class="number">0</span>][<span class="number">0</span>]);
				cx = <span class="number">0</span>;
				cy = <span class="keyword">this</span>.primal[<span class="number">2</span>][<span class="number">2</span>] / <span class="keyword">this</span>.primal[<span class="number">0</span>][<span class="number">0</span>];


				screen.path([
					t =&gt; cx + cos * param * t * t - sin * <span class="number">2</span> * param * t,
					t =&gt; cy + sin * param * t * t + cos * <span class="number">2</span> * param * t
				], options, redraw);
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-419">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-419">&#182;</a>
              </div>
              <p>Ellipse</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">else</span> <span class="keyword">if</span> (disc &gt; <span class="number">0</span>) {
				options.from = <span class="number">0</span>;
				options.to = <span class="number">2</span> * Math.PI;

				screen.path([
					t =&gt; cx + cos * Math.cos(t) * A - sin * Math.sin(t) * C,
					t =&gt; cy + sin * Math.cos(t) * A + cos * Math.sin(t) * C
				], options, redraw);
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-420">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-420">&#182;</a>
              </div>
              <p>Hyperbola</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">else</span> <span class="keyword">if</span> (disc &lt; <span class="number">0</span>) {
				options.from = <span class="number">0</span>;
				options.to = <span class="number">2</span> * Math.PI;</pre></div></div>
            
        </li>
        
        
        <li id="section-421">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-421">&#182;</a>
              </div>
              <p>This function changes the direction of the path for the second branch.
Otherwise we get some lines which shouldn&#39;t be there.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				sgn = <span class="function"><span class="keyword">function</span> <span class="params">(t)</span> {</span>
					<span class="keyword">return</span> +((t + Math.PI / <span class="number">2</span>) % (<span class="number">2</span> * Math.PI) &lt; Math.PI) * <span class="number">2</span> - <span class="number">1</span>;
				};



				<span class="keyword">if</span> (normalForm.primal[<span class="number">2</span>][<span class="number">2</span>] * normalForm.primal[<span class="number">0</span>][<span class="number">0</span>] &gt; <span class="number">0</span>) {
					<span class="keyword">var</span> swap = A;
					A = C;
					C = swap;

					cos = Math.cos(alpha + Math.PI / <span class="number">2</span>);
					sin = Math.sin(alpha + Math.PI / <span class="number">2</span>);

				}
				<span class="keyword">else</span> {
					cos = Math.cos(alpha);
					sin = Math.sin(alpha);
				}

				screen.path([
					t =&gt; cx + cos * MathLib.sec(t) * A - sin * MathLib.tan(t) * C * sgn(t),
					t =&gt; cy + sin * MathLib.sec(t) * A + cos * MathLib.tan(t) * C * sgn(t)
				], options, redraw);
			}

			
		}

		<span class="keyword">else</span> <span class="keyword">if</span> (rank === <span class="number">2</span>) {
			lines = <span class="keyword">this</span>.splitDegenerated();

			screen.line(lines[<span class="number">0</span>], options);
			screen.line(lines[<span class="number">1</span>], options);
		}

		<span class="keyword">else</span> <span class="keyword">if</span> (rank === <span class="number">1</span>) {
			lines = <span class="keyword">this</span>.splitDegenerated();

			screen.line(lines[<span class="number">0</span>], options);
		}


	}
	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-422">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-422">&#182;</a>
              </div>
              <h3 id="-conic-prototype-eccentricity-http-mathlib-de-en-docs-conic-eccentricity-"><a href="http://mathlib.de/en/docs/Conic/eccentricity">Conic.prototype.eccentricity()</a></h3>
<p>Calculates the eccentricity of a conic.</p>
<p><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>eccentricity() : number {
	<span class="keyword">var</span> normalform = <span class="keyword">this</span>.normalize(),
			a = normalform.primal[<span class="number">0</span>][<span class="number">0</span>],
			c = normalform.primal[<span class="number">1</span>][<span class="number">1</span>];

	<span class="keyword">if</span> (!<span class="keyword">this</span>.isDegenerated()) {</pre></div></div>
            
        </li>
        
        
        <li id="section-423">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-423">&#182;</a>
              </div>
              <p>parabola</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (c === <span class="number">0</span>) {
			<span class="keyword">return</span> <span class="number">1</span>;
		}
		<span class="keyword">if</span> (c &gt; <span class="number">0</span>) {
			<span class="keyword">return</span> Math.sqrt(<span class="number">1</span> - c / a);
		}
		<span class="keyword">return</span> Math.sqrt(<span class="number">1</span> - a / c);
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-424">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-424">&#182;</a>
              </div>
              <h3 id="-conic-prototype-isdegenerated-http-mathlib-de-en-docs-conic-isdegenerated-"><a href="http://mathlib.de/en/docs/Conic/isDegenerated">Conic.prototype.isDegenerated()</a></h3>
<p>Determines if a conic is degenerated.</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isDegenerated() : boolean {
	<span class="keyword">return</span> <span class="keyword">this</span>.primal.rank() !== <span class="number">3</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-425">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-425">&#182;</a>
              </div>
              <h3 id="-conic-prototype-isequal-http-mathlib-de-en-docs-conic-isequal-"><a href="http://mathlib.de/en/docs/Conic/isEqual">Conic.prototype.isEqual()</a></h3>
<p>Determines if two conics are equal.</p>
<p><em>@param {Conic}</em><br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isEqual(c : Conic) : boolean {
	<span class="keyword">if</span> (<span class="keyword">this</span> === c) {
		<span class="keyword">return</span> <span class="literal">true</span>;
	}

	<span class="keyword">var</span> compare = <span class="function"><span class="keyword">function</span> <span class="params">(M, N)</span> {</span>
		<span class="keyword">var</span> i, j, m, n;

		<span class="keyword">if</span> (M === N) {
			<span class="keyword">return</span> <span class="literal">true</span>;
		}

		nonZeroSearch: <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) {
			<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">3</span>; j++) {
				<span class="keyword">if</span> (M[i][j] !== <span class="number">0</span>) {
					<span class="keyword">break</span> nonZeroSearch;
				}
			}
		}

		<span class="keyword">if</span> (N[i][j] === <span class="number">0</span>) {
			<span class="keyword">return</span> <span class="literal">false</span>;
		}

		m = M[i][j];
		n = N[i][j];

		<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) {
			<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">3</span>; j++) {
				<span class="keyword">if</span> (n / m * M[i][j] !== N[i][j]) {
					<span class="keyword">return</span> <span class="literal">false</span>;
				}
			}
		}

		<span class="keyword">return</span> <span class="literal">true</span>;
	}

	<span class="keyword">return</span> compare(<span class="keyword">this</span>.primal, c.primal) &amp;&amp; compare(<span class="keyword">this</span>.dual, c.dual);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-426">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-426">&#182;</a>
              </div>
              <h3 id="-conic-prototype-latusrectum-http-mathlib-de-en-docs-conic-latusrectum-"><a href="http://mathlib.de/en/docs/Conic/latusRectum">Conic.prototype.latusRectum()</a></h3>
<p>Calculates the latusRectum of a conic.</p>
<p><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>latusRectum() : number {
	<span class="keyword">var</span> normalForm = <span class="keyword">this</span>.normalize(),
			a = normalForm.primal[<span class="number">0</span>][<span class="number">0</span>],
			c = normalForm.primal[<span class="number">1</span>][<span class="number">1</span>],
			min = Math.min(Math.abs(a), Math.abs(c)),
			max = Math.max(Math.abs(a), Math.abs(c));

	<span class="keyword">if</span> (!<span class="keyword">this</span>.isDegenerated()) {</pre></div></div>
            
        </li>
        
        
        <li id="section-427">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-427">&#182;</a>
              </div>
              <p>Parabola</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (c === <span class="number">0</span>) {
			<span class="keyword">return</span> -<span class="number">2</span> * normalForm.primal[<span class="number">1</span>][<span class="number">2</span>] / a;
		}

		<span class="keyword">return</span> <span class="number">2</span> * Math.sqrt(max) / min;
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-428">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-428">&#182;</a>
              </div>
              <h3 id="-conic-prototype-lineareccentricity-http-mathlib-de-en-docs-conic-lineareccentricity-"><a href="http://mathlib.de/en/docs/Conic/linearEccentricity">Conic.prototype.linearEccentricity()</a></h3>
<p>Calculates the linear eccentricity of a conic.</p>
<p><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>linearEccentricity() : number {
	<span class="keyword">var</span> normalForm = <span class="keyword">this</span>.normalize(),
			a = normalForm.primal[<span class="number">0</span>][<span class="number">0</span>],
			c = normalForm.primal[<span class="number">1</span>][<span class="number">1</span>],
			max = Math.max(Math.abs(a), Math.abs(c)), 
			min = Math.min(Math.abs(a), Math.abs(c));

	<span class="keyword">if</span> (!<span class="keyword">this</span>.isDegenerated()) {</pre></div></div>
            
        </li>
        
        
        <li id="section-429">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-429">&#182;</a>
              </div>
              <p>parabola</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (c === <span class="number">0</span>) {
			<span class="keyword">return</span> normalForm.primal[<span class="number">1</span>][<span class="number">2</span>] / (-<span class="number">2</span> * a);
		}

		<span class="keyword">if</span> (c &gt; <span class="number">0</span>) {
			<span class="keyword">return</span> Math.sqrt(<span class="number">1</span> / min - <span class="number">1</span> / max);
		}
		<span class="keyword">return</span> Math.sqrt(<span class="number">1</span> / max + <span class="number">1</span> / min);
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-430">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-430">&#182;</a>
              </div>
              <h3 id="-conic-prototype-meet-http-mathlib-de-en-docs-conic-meet-"><a href="http://mathlib.de/en/docs/Conic/meet">Conic.prototype.meet()</a></h3>
<p>Calculates the meet of the conic with a line or a conic.</p>
<p><em>@return {Point[]}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>meet(x) {
	<span class="keyword">var</span> B, C, alpha, i, j, p1, p2, Ml,
			a, b, c, d, Delta0, Delta1, lambda, degenerated, lines,
			A = <span class="keyword">this</span>.primal;
			
	<span class="keyword">if</span> (x.type === <span class="string">'line'</span>) {

		<span class="keyword">var</span> setter = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
					MathLib.warning({message: <span class="string">'Trying to change the coordinates of a completely dependent point.'</span>, method: <span class="string">'Conic#meet'</span>});
				},
				recalculate = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
					Ml = <span class="keyword">new</span> MathLib.Matrix([[<span class="number">0</span>, x[<span class="number">2</span>], -x[<span class="number">1</span>]], [-x[<span class="number">2</span>], <span class="number">0</span>, x[<span class="number">0</span>]], [x[<span class="number">1</span>], -x[<span class="number">0</span>], <span class="number">0</span>]]);
					B = Ml.transpose().times(A).times(Ml);

					<span class="keyword">if</span> (!MathLib.isZero(x[<span class="number">0</span>])) {
						alpha = Math.sqrt(B[<span class="number">2</span>][<span class="number">1</span>] * B[<span class="number">1</span>][<span class="number">2</span>] - B[<span class="number">1</span>][<span class="number">1</span>] * B[<span class="number">2</span>][<span class="number">2</span>]) / x[<span class="number">0</span>];
					}
					<span class="keyword">else</span> <span class="keyword">if</span> (!MathLib.isZero(x[<span class="number">1</span>])) {
						alpha = Math.sqrt(B[<span class="number">0</span>][<span class="number">2</span>] * B[<span class="number">2</span>][<span class="number">0</span>] - B[<span class="number">2</span>][<span class="number">2</span>] * B[<span class="number">0</span>][<span class="number">0</span>]) / x[<span class="number">1</span>];
					}
					<span class="keyword">else</span> {
						alpha = Math.sqrt(B[<span class="number">1</span>][<span class="number">0</span>] * B[<span class="number">0</span>][<span class="number">1</span>] - B[<span class="number">0</span>][<span class="number">0</span>] * B[<span class="number">1</span>][<span class="number">1</span>]) / x[<span class="number">2</span>];
					}

					C = Ml.times(alpha).plus(B);


					nonZeroSearch: <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) {
						<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">3</span>; j++) {
							<span class="keyword">if</span> (C[i][j] !== <span class="number">0</span>) {
								<span class="keyword">break</span> nonZeroSearch;
							}
						}
					}
				};


		recalculate();


		p1 = <span class="keyword">new</span> MathLib.Point(C[i]);
		Object.defineProperties(p1, {
			<span class="string">'0'</span>: {
				get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
					recalculate();
					<span class="keyword">return</span> C[i][<span class="number">0</span>];
				},
				set: setter,
				enumerable: <span class="literal">true</span>
			},
			<span class="string">'1'</span>: {
				get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
					recalculate();
					<span class="keyword">return</span> C[i][<span class="number">1</span>];
				},
				set: setter,
				enumerable: <span class="literal">true</span>
			},
			<span class="string">'2'</span>: {
				get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
					recalculate();
					<span class="keyword">return</span> C[i][<span class="number">2</span>];
				},
				set: setter,
				enumerable: <span class="literal">true</span>
			}
		});



		p2 = <span class="keyword">new</span> MathLib.Point([C[<span class="number">0</span>][j], C[<span class="number">1</span>][j], C[<span class="number">2</span>][j]]);
		Object.defineProperties(p2, {
			<span class="string">'0'</span>: {
				get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
					recalculate();
					<span class="keyword">return</span> C[<span class="number">0</span>][j];
				},
				set: setter,
				enumerable: <span class="literal">true</span>
			},
			<span class="string">'1'</span>: {
				get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
					recalculate();
					<span class="keyword">return</span> C[<span class="number">1</span>][j];
				},
				set: setter,
				enumerable: <span class="literal">true</span>
			},
			<span class="string">'2'</span>: {
				get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
					recalculate();
					<span class="keyword">return</span> C[<span class="number">2</span>][j];
				},
				set: setter,
				enumerable: <span class="literal">true</span>
			}
		});


		<span class="keyword">return</span> [p1, p2];
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'conic'</span>) {
		B = x.primal;
		a = A.determinant();
		b = (<span class="keyword">new</span> MathLib.Matrix([A[<span class="number">0</span>], A[<span class="number">1</span>], B[<span class="number">2</span>]])).plus(<span class="keyword">new</span> MathLib.Matrix([A[<span class="number">0</span>], B[<span class="number">1</span>], A[<span class="number">2</span>]])).plus(<span class="keyword">new</span> MathLib.Matrix([B[<span class="number">0</span>], A[<span class="number">1</span>], A[<span class="number">2</span>]])).determinant();
		c = (<span class="keyword">new</span> MathLib.Matrix([A[<span class="number">0</span>], B[<span class="number">1</span>], B[<span class="number">2</span>]])).plus(<span class="keyword">new</span> MathLib.Matrix([B[<span class="number">0</span>], A[<span class="number">1</span>], B[<span class="number">2</span>]])).plus(<span class="keyword">new</span> MathLib.Matrix([B[<span class="number">0</span>], B[<span class="number">1</span>], A[<span class="number">2</span>]])).determinant();
		d = B.determinant();
		Delta0 = b * b - <span class="number">3</span> * a * c;
		Delta1 = <span class="number">2</span> * b * b - <span class="number">9</span> * a * b * c + <span class="number">27</span> * a * a * d;
		C = MathLib.cbrt((Delta1 + Math.sqrt(Math.pow(Delta1, <span class="number">2</span>) - <span class="number">4</span> * Math.pow(Delta0, <span class="number">3</span>))) / <span class="number">2</span>);
		lambda = - (b + C + Delta0 / C) / (<span class="number">3</span> * a);
		degenerated = <span class="keyword">new</span> MathLib.Conic(B.times(lambda).plus(A));
		lines = degenerated.splitDegenerated();

		<span class="keyword">return</span> <span class="keyword">this</span>.meet(lines[<span class="number">0</span>]).concat(<span class="keyword">this</span>.meet(lines[<span class="number">1</span>]));
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-431">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-431">&#182;</a>
              </div>
              <h3 id="-conic-prototype-normalize-http-mathlib-de-en-docs-conic-normalize-"><a href="http://mathlib.de/en/docs/Conic/normalize">Conic.prototype.normalize()</a></h3>
<p>Calculates the normal form of a conic.</p>
<p><em>@return {Conic}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>normalize() : Conic {
	<span class="keyword">var</span> A = <span class="keyword">this</span>.primal[<span class="number">0</span>][<span class="number">0</span>],
			B = <span class="keyword">this</span>.primal[<span class="number">0</span>][<span class="number">1</span>] * <span class="number">2</span>,
			C = <span class="keyword">this</span>.primal[<span class="number">1</span>][<span class="number">1</span>],
			D = <span class="keyword">this</span>.primal[<span class="number">0</span>][<span class="number">2</span>] * <span class="number">2</span>,
			E = <span class="keyword">this</span>.primal[<span class="number">1</span>][<span class="number">2</span>] * <span class="number">2</span>,
			F = <span class="keyword">this</span>.primal[<span class="number">2</span>][<span class="number">2</span>],

			r = Math.atan2(B, A - C) / <span class="number">2</span>,
			cos = Math.cos(r),
			sin = Math.sin(r),

			a = A * cos * cos + B * sin * cos + C * sin * sin,
			c = A * sin * sin - B * sin * cos + C * cos * cos,
			d = D * cos + E * sin,
			e = E * cos - D * sin,
			f = F;

	<span class="keyword">if</span> (a !== <span class="number">0</span>) {
		f += -d * d / (<span class="number">4</span> * a);
		d = <span class="number">0</span>;
	}
	
	<span class="keyword">if</span> (c !== <span class="number">0</span>) {
		f += -e * e / (<span class="number">4</span> * c);
		e = <span class="number">0</span>;
	}

	<span class="keyword">if</span> (f !== <span class="number">0</span>) {
		a = -a / f;
		c = -c / f;
		d = -d / f;
		e = -e / f;
		f = -<span class="number">1</span>;
	}

	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Conic([[a, <span class="number">0</span>, d/<span class="number">2</span>], [<span class="number">0</span>, c, e/<span class="number">2</span>], [d/<span class="number">2</span>, e/<span class="number">2</span>, f]]);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-432">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-432">&#182;</a>
              </div>
              <h3 id="-conic-prototype-polarity-http-mathlib-de-en-docs-conic-polarity-"><a href="http://mathlib.de/en/docs/Conic/polarity">Conic.prototype.polarity()</a></h3>
<p>Calculates the four polarity of a conic.</p>
<p><em>@return {Point[]}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>polarity(x) {
	<span class="keyword">var</span> object, m,
			c = <span class="keyword">this</span>


	<span class="keyword">if</span> (x.type === <span class="string">'line'</span>) {
		object = <span class="keyword">new</span> MathLib.Point([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]);
		m = <span class="string">'dual'</span>;
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (x.type === <span class="string">'point'</span>) {
		object = <span class="keyword">new</span> MathLib.Line([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]);
		m = <span class="string">'primal'</span>;
	}


	Object.defineProperties(object, {
		<span class="string">'0'</span>: {
			get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> c[m][<span class="number">0</span>][<span class="number">0</span>] * x[<span class="number">0</span>] + c[m][<span class="number">0</span>][<span class="number">1</span>] * x[<span class="number">1</span>] + c[m][<span class="number">0</span>][<span class="number">2</span>] * x[<span class="number">2</span>]; },
			set: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> MathLib.warning({message: <span class="string">'Trying to change the coordinates of a completely dependent '</span> + object.type + <span class="string">'.'</span>, method: <span class="string">'Conic#polarity'</span>});},
			enumerable: <span class="literal">true</span>
		},
		<span class="string">'1'</span>: {
			get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> c[m][<span class="number">1</span>][<span class="number">0</span>] * x[<span class="number">0</span>] + c[m][<span class="number">1</span>][<span class="number">1</span>] * x[<span class="number">1</span>] + c[m][<span class="number">1</span>][<span class="number">2</span>] * x[<span class="number">2</span>]; },
			set: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> MathLib.warning({message: <span class="string">'Trying to change the coordinates of a completely dependent '</span> + object.type + <span class="string">'.'</span>, method: <span class="string">'Conic#polarity'</span>});},
			enumerable: <span class="literal">true</span>
		},
		<span class="string">'2'</span>: {
			get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> c[m][<span class="number">2</span>][<span class="number">0</span>] * x[<span class="number">0</span>] + c[m][<span class="number">2</span>][<span class="number">1</span>] * x[<span class="number">1</span>] + c[m][<span class="number">2</span>][<span class="number">2</span>] * x[<span class="number">2</span>]; },
			set: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> MathLib.warning({message: <span class="string">'Trying to change the coordinates of a completely dependent '</span> + object.type + <span class="string">'.'</span>, method: <span class="string">'Conic#polarity'</span>});},
			enumerable: <span class="literal">true</span>
		}
	});

	<span class="keyword">return</span> object;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-433">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-433">&#182;</a>
              </div>
              <h3 id="-conic-prototype-splitdegenerated-http-mathlib-de-en-docs-conic-splitdegenerated-"><a href="http://mathlib.de/en/docs/Conic/splitDegenerated">Conic.prototype.splitDegenerated()</a></h3>
<p>Splits a conic into one or two lines if the conic is degenerated.</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>splitDegenerated() {
	<span class="keyword">var</span> n, i, j, B, C, p0, p1, p2,
			rank = <span class="keyword">this</span>.primal.rank(),
			nonZeroSearch = <span class="function"><span class="keyword">function</span> <span class="params">(C)</span> {</span>
				<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) {
					<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">3</span>; j++) {
						<span class="keyword">if</span> (C[i][j] !== <span class="number">0</span>) {
							<span class="keyword">return</span>;
						}
					}
				}
			};

	<span class="keyword">if</span> (rank === <span class="number">2</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.dual[<span class="number">0</span>][<span class="number">0</span>] !== <span class="number">0</span>) {
			n = <span class="number">0</span>;
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.dual[<span class="number">1</span>][<span class="number">1</span>] !== <span class="number">0</span>) {
			n = <span class="number">1</span>;
		}
		<span class="keyword">else</span> {
			n = <span class="number">2</span>;
		}

		<span class="keyword">if</span> (<span class="keyword">this</span>.dual[n][n] &lt; <span class="number">0</span>) {
			B = <span class="keyword">this</span>.dual.negative();
		}
		<span class="keyword">else</span> {
			B = <span class="keyword">this</span>.dual;
		}

		p0 = B[<span class="number">0</span>][n] / Math.sqrt(B[n][n]);
		p1 = B[<span class="number">1</span>][n] / Math.sqrt(B[n][n]);
		p2 = B[<span class="number">2</span>][n] / Math.sqrt(B[n][n]);
		C = <span class="keyword">this</span>.primal.plus(<span class="keyword">new</span> MathLib.Matrix([[<span class="number">0</span>, p2, -p1], [-p2, <span class="number">0</span>, p0], [p1, -p0, <span class="number">0</span>]]));

		nonZeroSearch(C);

		<span class="keyword">return</span> [<span class="keyword">new</span> MathLib.Line(C[i]), <span class="keyword">new</span> MathLib.Line([C[<span class="number">0</span>][j], C[<span class="number">1</span>][j], C[<span class="number">2</span>][j]])];
	}


	<span class="keyword">else</span> <span class="keyword">if</span> (rank === <span class="number">1</span>) {
		nonZeroSearch(<span class="keyword">this</span>.primal);
		<span class="keyword">return</span> [<span class="keyword">new</span> MathLib.Line(<span class="keyword">this</span>.primal[i]), <span class="keyword">new</span> MathLib.Line(<span class="keyword">this</span>.primal[i])];
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-434">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-434">&#182;</a>
              </div>
              <h3 id="-conic-prototype-throughfivepoints-http-mathlib-de-en-docs-conic-throughfivepoints-"><a href="http://mathlib.de/en/docs/Conic/throughFivePoints">Conic.prototype.throughFivePoints()</a></h3>
<p>Calculates the conic through five points.</p>
<p><em>@return {Conic}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static throughFivePoints(p, q, r, s, t) : Conic {

	<span class="keyword">var</span> conic = <span class="keyword">new</span> MathLib.Conic([[<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>], [<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>], [<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>]]);

	Object.defineProperties(conic, {
			<span class="string">'primal'</span>: {
				get : <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
					<span class="keyword">var</span> G = p.vectorProduct(r).outerProduct(q.vectorProduct(s)),
							H = p.vectorProduct(s).outerProduct(q.vectorProduct(r)),
							M = G.times(t.times(H).scalarProduct(t)).minus(H.times(t.times(G).scalarProduct(t)));
					<span class="keyword">return</span> M.transpose().plus(M);
				},
				set : <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>},
				enumerable : <span class="literal">true</span>,
				configurable : <span class="literal">true</span>
			}
		});

	<span class="keyword">return</span> conic;
}


}<span class="comment">// ## &lt;a id="Point"&gt;&lt;/a&gt;Point</span></pre></div></div>
            
        </li>
        
        
        <li id="section-435">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-435">&#182;</a>
              </div>
              <p>The point implementation of MathLib makes calculations with point in
arbitrary dimensions possible.</p>
<p>MathLib uses the homogeneous form of a point for calculations and storage.</p>
<p>To create the point (4, 2) on the two dimensional plane use
<code>new MathLib.Point([4, 2, 1])</code>
Alternatively you can use
<code>new MathLib.Point(4, 2)</code>
The 1 will be added for you.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>export class Point extends Vector {
	type = <span class="string">'point'</span>;

	dimension: number;

	constructor (coords: number[]) {
		super(arguments.length &gt; <span class="number">1</span> ? Array.prototype.slice.call(arguments).concat(<span class="number">1</span>) : coords);

		<span class="keyword">this</span>.dimension = <span class="number">2</span>;

	}</pre></div></div>
            
        </li>
        
        
        <li id="section-436">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-436">&#182;</a>
              </div>
              <h3 id="point-i">Point.I</h3>
<p>The Point I = (-i, 0, 1).
This is NOT the complex number i.</p>
<p><em>@return {Point}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static I = <span class="keyword">new</span> Point([<span class="keyword">new</span> MathLib.Complex(<span class="number">0</span>, -<span class="number">1</span>), <span class="number">0</span>, <span class="number">1</span>]);</pre></div></div>
            
        </li>
        
        
        <li id="section-437">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-437">&#182;</a>
              </div>
              <h3 id="point-j">Point.J</h3>
<p>The Point J = (i, 0, 1).</p>
<p><em>@return {Point}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static J = <span class="keyword">new</span> Point([<span class="keyword">new</span> MathLib.Complex(<span class="number">0</span>, <span class="number">1</span>), <span class="number">0</span>, <span class="number">1</span>]);</pre></div></div>
            
        </li>
        
        
        <li id="section-438">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-438">&#182;</a>
              </div>
              <h3 id="point-prototype-crossratio-">Point.prototype.crossRatio()</h3>
<p>Calculates the distance crossratio (A,B,C,D) of four points
as seen from the current point.</p>
<p><em>@param {Point}</em> a The point A<br><em>@param {Point}</em> b The point B<br><em>@param {Point}</em> c The point C<br><em>@param {Point}</em> d The point D<br><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>crossRatio(a : Point, b : Point, c : Point, d : Point) : number {
	<span class="keyword">var</span> xa = <span class="keyword">this</span>.vectorProduct(a),
			xb = <span class="keyword">this</span>.vectorProduct(b);

	<span class="keyword">return</span> xa.scalarProduct(c) * xb.scalarProduct(d) / (xa.scalarProduct(d) * xb.scalarProduct(c));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-439">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-439">&#182;</a>
              </div>
              <h3 id="point-prototype-distanceto-">Point.prototype.distanceTo()</h3>
<p>Calculates the distance to an other point.
If no other point is provided, it calculates the distance to the origin.</p>
<p><em>@param {Point}</em> [point] The point to calculate the distance to<br><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>distanceTo(p : Point <span class="comment">/*, geom = MathLib.Geometry.active*/</span>) : number {
	<span class="keyword">if</span> (arguments.length === <span class="number">0</span>) {
		<span class="keyword">return</span> MathLib.hypot.apply(<span class="literal">null</span>, <span class="keyword">this</span>.slice(<span class="number">0</span>, -<span class="number">1</span>)) / Math.abs(<span class="keyword">this</span>[<span class="keyword">this</span>.dimension]);
	}

	<span class="keyword">if</span> (p.type === <span class="string">'point'</span> &amp;&amp; <span class="keyword">this</span>.dimension === p.dimension) {
		<span class="keyword">return</span> MathLib.hypot.apply(<span class="literal">null</span>, <span class="keyword">this</span>.normalize().minus(p.normalize()).slice(<span class="number">0</span>, -<span class="number">1</span>));
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-440">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-440">&#182;</a>
              </div>
              <p>if (p.type === &#39;point&#39; &amp;&amp; this.dimension === p.dimension) {
    var Otp = this.times(geom.fundamentalConic.primal).times(p),
            Ott = this.times(geom.fundamentalConic.primal).times(this),
            Opp = p.times(geom.fundamentalConic.primal).times(p),
            Dtp = Math.sqrt(Otp <em> Otp - Ott </em> Opp);</p>
<pre><code>return MathLib.Geometry.active.cDist * Math.log((Otp + Dtp) / (Otp - Dtp));</code></pre>
<p>}</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>}</pre></div></div>
            
        </li>
        
        
        <li id="section-441">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-441">&#182;</a>
              </div>
              <h3 id="point-prototype-draw-">Point.prototype.draw()</h3>
<p>Draws the point on a canvas or svg element.</p>
<p><em>@param {Screen}</em> screen The screen to draw onto<br><em>@param {object}</em> [options] Drawing options<br><em>@return {Point}</em> The current point</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>draw(screen, options) {
	<span class="keyword">if</span> (Array.isArray(screen)) {
		<span class="keyword">var</span> point = <span class="keyword">this</span>;
		screen.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
			x.point(point, options);
		});
	}
	<span class="keyword">else</span> {
		screen.point(<span class="keyword">this</span>, options);
	}

	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-442">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-442">&#182;</a>
              </div>
              <h3 id="point-prototype-isequal-">Point.prototype.isEqual()</h3>
<p>Determines if the point has the same coordinates as an other point</p>
<p><em>@param {Point}</em> The point to compare<br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isEqual(q : Point) : boolean {
	<span class="keyword">var</span> p = <span class="keyword">this</span>.normalize();
	q = q.normalize();

	<span class="keyword">if</span> (<span class="keyword">this</span>.length !== q.length) {
		<span class="keyword">return</span> <span class="literal">false</span>;
	}

	<span class="keyword">return</span> p.every(<span class="function"><span class="keyword">function</span> <span class="params">(x, i)</span> {</span>
		<span class="keyword">return</span> MathLib.isEqual(x, q[i]);
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-443">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-443">&#182;</a>
              </div>
              <h3 id="point-prototype-isfinite-">Point.prototype.isFinite()</h3>
<p>Determines if the point is finite</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isFinite() : boolean {
	<span class="keyword">return</span> !MathLib.isZero(<span class="keyword">this</span>[<span class="keyword">this</span>.length - <span class="number">1</span>]);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-444">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-444">&#182;</a>
              </div>
              <h3 id="point-prototype-isinside-">Point.prototype.isInside()</h3>
<p>Determines wether a point is inside a circle</p>
<p><em>@param {Circle}</em><br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isInside(a : Circle) : boolean {
	<span class="keyword">if</span> (a.type === <span class="string">'circle'</span>) {
		<span class="keyword">return</span> <span class="keyword">this</span>.distanceTo(a.center) &lt; a.radius;
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-445">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-445">&#182;</a>
              </div>
              <h3 id="point-prototype-ison-">Point.prototype.isOn()</h3>
<p>Determines wether a point is on a line or circle</p>
<p><em>@param {Line|Point}</em><br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isOn(a : Circle) : boolean {
	<span class="keyword">if</span> (a.type === <span class="string">'line'</span>) {
		<span class="keyword">return</span> <span class="keyword">this</span>.distanceTo(a.center) === a.radius;
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (a.type === <span class="string">'circle'</span>) {
		<span class="keyword">return</span> <span class="keyword">this</span>.distanceTo(a.center) === a.radius;
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-446">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-446">&#182;</a>
              </div>
              <h3 id="point-prototype-isoutside-">Point.prototype.isOutside()</h3>
<p>Determines wether a point is outside a circle</p>
<p><em>@param {Circle}</em><br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isOutside(a : Circle) : boolean {
	<span class="keyword">if</span> (a.type === <span class="string">'circle'</span>) {
		<span class="keyword">return</span> <span class="keyword">this</span>.distanceTo(a.center) &gt; a.radius;
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-447">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-447">&#182;</a>
              </div>
              <h3 id="point-prototype-join-">Point.prototype.join()</h3>
<p>Calculates a line connecting two points</p>
<p><em>@param {Point}</em> The point to calculate the line to<br><em>@return {Line}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>join(q : Point) : Line {
	<span class="keyword">var</span> line,
			p = <span class="keyword">this</span>;

	<span class="keyword">if</span> (<span class="keyword">this</span>.dimension === <span class="number">2</span> &amp;&amp; q.dimension === <span class="number">2</span>) {
		line = <span class="keyword">new</span> MathLib.Line(<span class="keyword">this</span>.vectorProduct(q));

		Object.defineProperties(line, {
			<span class="string">'0'</span>: {
				get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> p[<span class="number">1</span>] * q[<span class="number">2</span>] - p[<span class="number">2</span>] * q[<span class="number">1</span>]; },
				set: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>	MathLib.warning({message: <span class="string">'Trying to change the coordinates of a completely dependent line.'</span>, method: <span class="string">'Point#join'</span>});},
				enumerable: <span class="literal">true</span>
			},
			<span class="string">'1'</span>: {
				get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> p[<span class="number">2</span>] * q[<span class="number">0</span>] - p[<span class="number">0</span>] * q[<span class="number">2</span>]; },
				set: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>	MathLib.warning({message: <span class="string">'Trying to change the coordinates of a completely dependent line.'</span>, method: <span class="string">'Point#join'</span>});},
				enumerable : <span class="literal">true</span>
			},
			<span class="string">'2'</span>: {
				get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> p[<span class="number">0</span>] * q[<span class="number">1</span>] - p[<span class="number">1</span>] * q[<span class="number">0</span>]; },
				set: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>	MathLib.warning({message: <span class="string">'Trying to change the coordinates of a completely dependent line.'</span>, method: <span class="string">'Point#join'</span>});},
				enumerable: <span class="literal">true</span>
			}
		});

		<span class="keyword">return</span> line;
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-448">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-448">&#182;</a>
              </div>
              <h3 id="point-prototype-normalize-">Point.prototype.normalize()</h3>
<p>Normalizes the point.</p>
<p><em>@return {Point}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>normalize() : Point {
	<span class="keyword">var</span> last = <span class="keyword">this</span>[<span class="keyword">this</span>.dimension] || <span class="number">1</span>;
	<span class="keyword">return</span> <span class="keyword">this</span>.map(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> x / last;
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-449">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-449">&#182;</a>
              </div>
              <h3 id="point-prototype-reflectat-">Point.prototype.reflectAt()</h3>
<p>Reflects the point at an other point</p>
<p><em>@return {Point}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>reflectAt(a : Point) : Point {
	<span class="keyword">var</span> i, ii,
			reflectedPoint = [],
			p = <span class="keyword">this</span>.normalize();

	<span class="keyword">if</span> (a.type === <span class="string">'point'</span>) {
		<span class="keyword">if</span> (<span class="keyword">this</span>.dimension === a.dimension) {
			a = a.normalize();
			<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.dimension; i &lt; ii; i++) {
				reflectedPoint.push(<span class="number">2</span> * a[i] - p[i]);
			}
			reflectedPoint.push(<span class="number">1</span>);
			<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Point(reflectedPoint);
		}
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-450">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-450">&#182;</a>
              </div>
              <h3 id="point-prototype-restrictto-">Point.prototype.restrictTo()</h3>
<p>Restricts the point to a line.</p>
<p><em>@param {Line}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>restrictTo(l : Line) {
	<span class="keyword">var</span> p = <span class="keyword">this</span>.slice();

	Object.defineProperties(<span class="keyword">this</span>, {
		<span class="string">'0'</span>: {
			get : <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> l[<span class="number">1</span>] * l[<span class="number">1</span>] * p[<span class="number">0</span>] - l[<span class="number">0</span>] * (l[<span class="number">1</span>] * p[<span class="number">1</span>] + l[<span class="number">2</span>] * p[<span class="number">2</span>]); },
			set : <span class="function"><span class="keyword">function</span> <span class="params">(point)</span> {</span>p[<span class="number">0</span>] = point},
			enumerable : <span class="literal">true</span>,
			configurable : <span class="literal">true</span>
		},
		<span class="string">'1'</span>: {
			get : <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> - l[<span class="number">1</span>] * l[<span class="number">2</span>] * p[<span class="number">2</span>] + l[<span class="number">0</span>] * (l[<span class="number">0</span>] * p[<span class="number">1</span>] - l[<span class="number">1</span>] * p[<span class="number">0</span>]); },
			set : <span class="function"><span class="keyword">function</span> <span class="params">(point)</span> {</span>p[<span class="number">1</span>] = point},
			enumerable : <span class="literal">true</span>,
			configurable : <span class="literal">true</span>
		},
		<span class="string">'2'</span>: {
			get : <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> l[<span class="number">1</span>] * l[<span class="number">1</span>] * p[<span class="number">2</span>] + l[<span class="number">0</span>] * l[<span class="number">0</span>] * p[<span class="number">2</span>]; },
			set : <span class="function"><span class="keyword">function</span> <span class="params">(point)</span> {</span>p[<span class="number">2</span>] = point},
			enumerable : <span class="literal">true</span>,
			configurable : <span class="literal">true</span>
		}
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-451">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-451">&#182;</a>
              </div>
              <h3 id="point-prototype-tocomplex-">Point.prototype.toComplex()</h3>
<p>Converts a two dimensional point to the corresponding complex number.</p>
<p><em>@return {Complex}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toComplex() : Complex {
	<span class="keyword">if</span> (<span class="keyword">this</span>.dimension === <span class="number">2</span>) {
		<span class="keyword">if</span> (MathLib.isZero(<span class="keyword">this</span>[<span class="number">2</span>])) {
			<span class="keyword">return</span> MathLib.Complex.infinity;
		}
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Complex(<span class="keyword">this</span>[<span class="number">0</span>] / <span class="keyword">this</span>[<span class="number">2</span>], <span class="keyword">this</span>[<span class="number">1</span>] / <span class="keyword">this</span>[<span class="number">2</span>]);
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-452">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-452">&#182;</a>
              </div>
              <h3 id="point-prototype-tocontentmathml-">Point.prototype.toContentMathML()</h3>
<p>Returns content MathML representation of the point</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="comment">/* toContentMathML(opt) { */</span>
<span class="comment">/* } */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-453">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-453">&#182;</a>
              </div>
              <h3 id="point-prototype-tolatex-">Point.prototype.toLaTeX()</h3>
<p>Returns LaTeX representation of the point</p>
<p><em>@param {boolean}</em> Optional parameter to indicate if the output should be projective.<br><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toLaTeX(opt = <span class="literal">false</span>) : string {
	<span class="keyword">var</span> p = opt ? <span class="keyword">this</span>.toArray() : <span class="keyword">this</span>.normalize().slice(<span class="number">0</span>, -<span class="number">1</span>);

	<span class="keyword">return</span> <span class="string">'\\begin{pmatrix}'</span> + p.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(old, cur)</span> {</span>
		<span class="keyword">return</span> old + <span class="string">'\\\\'</span> + MathLib.toLaTeX(cur);
	}) + <span class="string">'\\end{pmatrix}'</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-454">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-454">&#182;</a>
              </div>
              <h3 id="point-prototype-tomathml-">Point.prototype.toMathML()</h3>
<p>Returns (presentation) MathML representation of the point</p>
<p><em>@param {boolean}</em> Optional parameter to indicate if the output should be projective.<br><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toMathML(opt = <span class="literal">false</span>) : string {
	<span class="keyword">var</span> p = opt ? <span class="keyword">this</span>.toArray() : <span class="keyword">this</span>.normalize().slice(<span class="number">0</span>, -<span class="number">1</span>);

	<span class="keyword">return</span> p.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(old, cur)</span> {</span>
		<span class="keyword">return</span> old + <span class="string">'&lt;mtr&gt;&lt;mtd&gt;'</span> + MathLib.toMathML(cur) + <span class="string">'&lt;/mtd&gt;&lt;/mtr&gt;'</span>;
	}, <span class="string">'&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mtable&gt;'</span>) + <span class="string">'&lt;/mtable&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;'</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-455">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-455">&#182;</a>
              </div>
              <h3 id="point-prototype-tostring-">Point.prototype.toString()</h3>
<p>Returns string representation of the point</p>
<p><em>@param {boolean}</em> Optional parameter to indicate if the output should be projective.<br><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toString(opt = <span class="literal">false</span>) : string {
	<span class="keyword">var</span> p = opt ? <span class="keyword">this</span>.toArray() : <span class="keyword">this</span>.normalize().slice(<span class="number">0</span>, -<span class="number">1</span>);

	<span class="keyword">return</span> <span class="string">'('</span> + p.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(old, cur)</span> {</span>
		<span class="keyword">return</span> old + <span class="string">', '</span> + MathLib.toString(cur);
	}) + <span class="string">')'</span>;
}


}<span class="comment">// ## &lt;a id="Polynomial"&gt;&lt;/a&gt;Polynomial</span></pre></div></div>
            
        </li>
        
        
        <li id="section-456">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-456">&#182;</a>
              </div>
              <p>The polynomial implementation of MathLib makes calculations with polynomials.
Both the coefficients and the arguments of a polynomial can be numbers,
complex numbers and matrices.</p>
<p>It is as easy as</p>
<pre><code>new MathLib.Polynomial([1, 2, 3])</code></pre>
<p>to create the polynomial 1 + 2x + 3x²<br>The polynomial x¹⁰⁰ can be created with the following statement:</p>
<pre><code>new MathLib.Polynomial(100)</code></pre>
<p>declare var Polynomial : any;</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>export class Polynomial {

	type = <span class="string">'polynomial'</span>;

	deg: number;
	length: number;
	subdeg: number;

	constructor (polynomial) {
		<span class="keyword">var</span> coefficients = [];

		<span class="keyword">if</span> (polynomial === <span class="literal">undefined</span> || polynomial.length === <span class="number">0</span>) {
			polynomial = [<span class="number">0</span>];
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> polynomial === <span class="string">'number'</span>) {
			<span class="keyword">while</span> (polynomial--) {
				coefficients.push(<span class="number">0</span>);
			}
			coefficients.push(<span class="number">1</span>);
			polynomial = coefficients;
		}

		polynomial.forEach((x, i) =&gt; {<span class="keyword">this</span>[i] = x});
		<span class="keyword">this</span>.length = polynomial.length;
		<span class="keyword">this</span>.deg = polynomial.length - <span class="number">1</span>;
		<span class="keyword">this</span>.subdeg = (<span class="function"><span class="keyword">function</span> <span class="params">(a)</span> {</span>
				<span class="keyword">var</span> i = <span class="number">0</span>;
				<span class="keyword">if</span> (a.length &gt; <span class="number">1</span> || a[<span class="number">0</span>]) {
					<span class="keyword">while</span> (i &lt; a.length &amp;&amp; MathLib.isZero(a[i])) {
						i++;
					}
					<span class="keyword">return</span> i;
				}
				<span class="keyword">return</span> <span class="literal">Infinity</span>;
			}(polynomial));

	}</pre></div></div>
            
        </li>
        
        
        <li id="section-457">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-457">&#182;</a>
              </div>
              <h3 id="polynomial-prototype-compare-">Polynomial.prototype.compare()</h3>
<p>Compares two polynomials.</p>
<p><em>@param {Polynomial}</em> The polynomial to compare<br><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>compare(p : Polynomial) : number {
	<span class="keyword">var</span> i, ii;

	<span class="keyword">if</span> (<span class="keyword">this</span>.length !== p.length) {
		<span class="keyword">return</span> MathLib.sign(<span class="keyword">this</span>.length - p.length);
	}

	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.length; i &lt; ii; i++) {
		<span class="keyword">if</span> (p[i] - <span class="keyword">this</span>[i]) {
			<span class="keyword">return</span> MathLib.sign(<span class="keyword">this</span>[i] - p[i]);
		}
	}

	<span class="keyword">return</span> <span class="number">0</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-458">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-458">&#182;</a>
              </div>
              <h3 id="polynomial-prototype-differentiate-">Polynomial.prototype.differentiate()</h3>
<p>Differentiates the polynomial</p>
<p><em>@param {number}</em> [n] the number of times to differentiate the polynomial.<br><em>@return {Polynomial}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>differentiate(n = <span class="number">1</span>) : Polynomial {
	<span class="keyword">var</span> i, ii,
			derivative = [];

	<span class="keyword">if</span> (n === <span class="number">0</span>) {
		<span class="keyword">return</span> <span class="keyword">this</span>;
	}

	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.deg - n; i &lt;= ii; i++) {
		derivative[i] = MathLib.times(<span class="keyword">this</span>[i + n], MathLib.fallingFactorial(i + n, n));
	}
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Polynomial(derivative);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-459">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-459">&#182;</a>
              </div>
              <h3 id="polynomial-prototype-draw-">Polynomial.prototype.draw()</h3>
<p>Draws the polynomial on the screen</p>
<p><em>@param {Screen}</em> The screen to draw the polynomial onto.<br><em>@param {object}</em> [options] Optional drawing options.<br><em>@return {Polynomial}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>draw(screen, options) {
	<span class="keyword">var</span> path = [], i,
			line = <span class="keyword">this</span>;

	<span class="keyword">if</span> (<span class="keyword">this</span>.deg &lt; <span class="number">2</span>) {
		<span class="keyword">if</span> (Array.isArray(screen)) {
			screen.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
				x.line([[-<span class="number">50</span>, line.valueAt(-<span class="number">50</span>)], [<span class="number">50</span>, line.valueAt(<span class="number">50</span>)]], options);
			});
		}
		<span class="keyword">else</span> {
			screen.line([[-<span class="number">50</span>, <span class="keyword">this</span>.valueAt(-<span class="number">50</span>)], [<span class="number">50</span>, <span class="keyword">this</span>.valueAt(<span class="number">50</span>)]], options);
		}
	}

	<span class="keyword">else</span> {
		<span class="keyword">for</span> (i = -<span class="number">50</span>; i &lt;= <span class="number">50</span>; i = Math.round((i + <span class="number">0.01</span>) * <span class="number">100</span>) / <span class="number">100</span>) {
			path.push([i, <span class="keyword">this</span>.valueAt(i)]);
		}
		<span class="keyword">if</span> (Array.isArray(screen)) {
			screen.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
				x.path(path, options);
			});
		}
		<span class="keyword">else</span> {
			screen.path(path, options);
		}
	}

	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-460">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-460">&#182;</a>
              </div>
              <h3 id="polynomial-prototype-every-">Polynomial.prototype.every()</h3>
<p>Works like Array.prototype.every.</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>every(f : (value : any, index : number, vector : Vector ) =&gt; boolean) : boolean {
	<span class="keyword">return</span> Array.prototype.every.call(<span class="keyword">this</span>, f);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-461">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-461">&#182;</a>
              </div>
              <h3 id="polynomial-prototype-foreach-">Polynomial.prototype.forEach()</h3>
<p>Works like the Array.prototype.forEach function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>forEach(...args : any[]) : <span class="keyword">void</span> {
	Array.prototype.forEach.apply(<span class="keyword">this</span>, args);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-462">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-462">&#182;</a>
              </div>
              <h3 id="polynomial-prototype-integrate-">Polynomial.prototype.integrate()</h3>
<p>Integrates the polynomial</p>
<p><em>@param {number}</em> [n] the number of times to integrate the polynomial.<br><em>@return {Polynomial}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>integrate(n = <span class="number">1</span>) : Polynomial {
	<span class="keyword">var</span> i, ii, 
			antiderivative = [];

	<span class="keyword">if</span> (MathLib.isZero(n)) {
		<span class="keyword">return</span> <span class="keyword">this</span>;
	}

	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++) {
		antiderivative.push(<span class="number">0</span>);
	}

	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.deg; i &lt;= ii; i++) {
		antiderivative[i + n] = <span class="keyword">this</span>[i] / MathLib.fallingFactorial(i + n, n);
	}
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Polynomial(antiderivative);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-463">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-463">&#182;</a>
              </div>
              <h3 id="polynomial-interpolation">Polynomial.interpolation</h3>
<p>Interpolates points.</p>
<p><em>@return {Polynomial}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static interpolation(a, b) {
	<span class="keyword">var</span> basisPolynomial,
			interpolant = <span class="keyword">new</span> MathLib.Polynomial([<span class="number">0</span>]),
			n = a.length,
			i, j;

	<span class="keyword">if</span> (arguments.length === <span class="number">2</span>) {
		a = a.map(<span class="function"><span class="keyword">function</span> <span class="params">(x, i)</span> {</span>
			<span class="keyword">return</span> [x, b[i]];
		});
	}

	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++) {
		basisPolynomial = <span class="keyword">new</span> MathLib.Polynomial([<span class="number">1</span>]);
		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; n; j++) {
			<span class="keyword">if</span> (i !== j) {
				basisPolynomial = basisPolynomial.times(<span class="keyword">new</span> MathLib.Polynomial([-a[j][<span class="number">0</span>] / (a[i][<span class="number">0</span>] - a[j][<span class="number">0</span>]), <span class="number">1</span> / (a[i][<span class="number">0</span>] - a[j][<span class="number">0</span>])]));
			}
		}
		interpolant = interpolant.plus(basisPolynomial.times(a[i][<span class="number">1</span>]));
	}
	<span class="keyword">return</span> interpolant;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-464">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-464">&#182;</a>
              </div>
              <h3 id="polynomial-prototype-isequal-">Polynomial.prototype.isEqual()</h3>
<p>Decides if two polynomials are equal.</p>
<p><em>@param {Polynomial}</em><br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isEqual(p : Polynomial) : boolean {
	<span class="keyword">var</span> i, ii;
	<span class="keyword">if</span> (<span class="keyword">this</span>.deg !== p.deg || <span class="keyword">this</span>.subdeg !== p.subdeg) {
		<span class="keyword">return</span> <span class="literal">false</span>;
	}
	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.deg; i &lt;= ii; i++) {
		<span class="keyword">if</span> (!MathLib.isEqual(<span class="keyword">this</span>[i], p[i])) {
			<span class="keyword">return</span> <span class="literal">false</span>;
		}
	}
	<span class="keyword">return</span> <span class="literal">true</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-465">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-465">&#182;</a>
              </div>
              <h3 id="polynomial-prototype-map-">Polynomial.prototype.map()</h3>
<p>Works like the Array.prototype.map function</p>
<p><em>@return {Polynomial}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>map(f) : Polynomial {
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Polynomial(Array.prototype.map.call(<span class="keyword">this</span>, f));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-466">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-466">&#182;</a>
              </div>
              <h3 id="polynomial-prototype-negative-">Polynomial.prototype.negative()</h3>
<p>Returns the negative polynomial</p>
<p><em>@return {Polynomial}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>negative() : Polynomial {
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Polynomial(<span class="keyword">this</span>.map(MathLib.negative));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-467">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-467">&#182;</a>
              </div>
              <h3 id="polynomial-one">Polynomial.one</h3>
<p>Returns the one polynomial</p>
<p><em>@return {Polynomial}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static one = <span class="keyword">new</span> Polynomial([<span class="number">1</span>]);</pre></div></div>
            
        </li>
        
        
        <li id="section-468">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-468">&#182;</a>
              </div>
              <h3 id="polynomial-prototype-plus-">Polynomial.prototype.plus()</h3>
<p>Adds a number or a polynomial</p>
<p><em>@return {Polynomial}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>plus(a) : Polynomial {
	<span class="keyword">var</span> plus = [],
			i;
	<span class="keyword">if</span> (<span class="keyword">typeof</span> a === <span class="string">'number'</span>) {
		plus = <span class="keyword">this</span>.slice();
		plus[<span class="number">0</span>] = MathLib.plus(plus[<span class="number">0</span>], a);
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (a.type === <span class="string">'polynomial'</span>) {
		<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= Math.min(<span class="keyword">this</span>.deg, a.deg); i++) {
			plus[i] = MathLib.plus(<span class="keyword">this</span>[i], a[i]);
		}
		plus = plus.concat((<span class="keyword">this</span>.deg &gt; a.deg ? <span class="keyword">this</span> : a).slice(i));
	}
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Polynomial(plus);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-469">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-469">&#182;</a>
              </div>
              <h3 id="polynomial-regression">Polynomial.regression</h3>
<p>Calculates the regression line for some points</p>
<p><em>@return {Polynomial}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static regression(x, y) : Polynomial {
	<span class="keyword">var</span> length = x.length,
			xy = <span class="number">0</span>,
			xi = <span class="number">0</span>,
			yi = <span class="number">0</span>,
			x2 = <span class="number">0</span>,
			m, c, i;

	<span class="keyword">if</span> (arguments.length === <span class="number">2</span>) {
		<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; length; i++) {
			xy += x[i] * y[i];
			xi += x[i];
			yi += y[i];
			x2 += x[i] * x[i];
		}
	}
	<span class="keyword">else</span> {
		<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; length; i++) {
			xy += x[i][<span class="number">0</span>] * x[i][<span class="number">1</span>];
			xi += x[i][<span class="number">0</span>];
			yi += x[i][<span class="number">1</span>];
			x2 += x[i][<span class="number">0</span>] * x[i][<span class="number">0</span>];
		}
	}

	m = (length * xy - xi * yi) / (length * x2 - xi * xi);
	c = (yi * x2 - xy * xi) / (length * x2 - xi * xi);
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Polynomial([c, m]);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-470">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-470">&#182;</a>
              </div>
              <h3 id="polynomial-roots">Polynomial.roots</h3>
<p>Returns a polynomial with the specified roots</p>
<p><em>@return {Polynomial}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static roots(zeros) : Polynomial {
	<span class="keyword">var</span> elemSymPoly, i, ii,
			coef = [];

	<span class="keyword">if</span> (MathLib.type(zeros) === <span class="string">'array'</span>) {
		zeros = <span class="keyword">new</span> MathLib.Set(zeros);
	}

	elemSymPoly = zeros.powerset();
	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = zeros.card; i &lt; ii; i++) {
		coef[i] = <span class="number">0</span>;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-471">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-471">&#182;</a>
              </div>
              <p>Vieta&#39;s theorem</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	elemSymPoly.slice(<span class="number">1</span>).forEach(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		coef[ii - x.card] = MathLib.plus(coef[ii - x.card], x.times());
	});

	coef = coef.map(<span class="function"><span class="keyword">function</span> <span class="params">(x, i)</span> {</span>
		<span class="keyword">if</span> ((ii - i) % <span class="number">2</span>) {
			<span class="keyword">return</span> MathLib.negative(x);
		}
		<span class="keyword">return</span> x;
	});

	coef.push(<span class="number">1</span>);
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Polynomial(coef);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-472">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-472">&#182;</a>
              </div>
              <h3 id="polynomial-prototype-slice-">Polynomial.prototype.slice()</h3>
<p>Works like the Array.prototype.slice function</p>
<p><em>@return {array}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>slice(...args : any[]) : any[] {
	<span class="keyword">return</span> Array.prototype.slice.apply(<span class="keyword">this</span>, args);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-473">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-473">&#182;</a>
              </div>
              <h3 id="polynomial-prototype-times-">Polynomial.prototype.times()</h3>
<p>Multiplies the polynomial by a number or an other polynomial  </p>
<p><em>@param {number|Polynomial}</em> The multiplicator<br><em>@return {Polynomial}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>times(a) : Polynomial {
	<span class="keyword">var</span> i, ii, j, jj,
			product = [];
			
	<span class="keyword">if</span> (a.type === <span class="string">'polynomial'</span>) {
		<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.deg; i &lt;= ii; i++) {
			<span class="keyword">for</span> (j = <span class="number">0</span>, jj = a.deg; j &lt;= jj; j++) {
				product[i + j] = MathLib.plus((product[i + j] ? product[i + j] : <span class="number">0</span>), MathLib.times(<span class="keyword">this</span>[i], a[j]));
			}
		}
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Polynomial(product);
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (a.type === <span class="string">'rational'</span>) {
		a = a.toNumber(); 
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-474">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-474">&#182;</a>
              </div>
              <p>we we multiply it to every coefficient</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">return</span> <span class="keyword">this</span>.map(<span class="function"><span class="keyword">function</span> <span class="params">(b)</span> {</span>
											<span class="keyword">return</span> MathLib.times(a, b);
										});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-475">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-475">&#182;</a>
              </div>
              <h3 id="polynomial-prototype-tocontentmathml-">Polynomial.prototype.toContentMathML()</h3>
<p>Returns a content MathML representation of the polynomial</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toContentMathML(math) : string {
	<span class="keyword">var</span> str = <span class="string">'&lt;apply&gt;&lt;csymbol cd="arith1"&gt;plus&lt;/csymbol&gt;'</span>, i;
	<span class="keyword">for</span> (i = <span class="keyword">this</span>.deg; i &gt;= <span class="number">0</span>; i--) {
		<span class="keyword">if</span> (!MathLib.isZero(<span class="keyword">this</span>[i])) {
			<span class="keyword">if</span> (i === <span class="number">0</span>) {
				str += MathLib.toContentMathML(<span class="keyword">this</span>[i]);
			}
			<span class="keyword">else</span> {
				str += <span class="string">'&lt;apply&gt;&lt;csymbol cd="arith1"&gt;times&lt;/csymbol&gt;'</span> + MathLib.toContentMathML(<span class="keyword">this</span>[i], <span class="literal">true</span>);
			}

			<span class="keyword">if</span> (i &gt; <span class="number">1</span>) {
				str += <span class="string">'&lt;apply&gt;&lt;csymbol cd="arith1"&gt;power&lt;/csymbol&gt;&lt;ci&gt;x&lt;/ci&gt;'</span> + MathLib.toContentMathML(i) + <span class="string">'&lt;/apply&gt;&lt;/apply&gt;'</span>;
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (i === <span class="number">1</span>) {
				str += <span class="string">'&lt;ci&gt;x&lt;/ci&gt;&lt;/apply&gt;'</span>;
			}
		}
	}

	str += <span class="string">'&lt;/apply&gt;'</span>;

	<span class="keyword">if</span> (math) {
		str = <span class="string">'&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;lambda&gt;&lt;bvar&gt;&lt;ci&gt;x&lt;/ci&gt;&lt;/bvar&gt;&lt;domainofapplication&gt;&lt;complexes/&gt;&lt;/domainofapplication&gt;'</span> + str + <span class="string">'&lt;/lambda&gt;&lt;/math&gt;'</span>;
	}

	<span class="keyword">return</span> str;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-476">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-476">&#182;</a>
              </div>
              <h3 id="polynomial-prototype-toexpression-">Polynomial.prototype.toExpression()</h3>
<p>Custom toExpression function</p>
<p><em>@return {Expression}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toExpression() : Expression {
	<span class="keyword">var</span> content = [],
			sum, i;

	<span class="keyword">for</span> (i = <span class="keyword">this</span>.deg; i &gt;= <span class="number">0</span>; i--) {
		<span class="keyword">if</span> (!MathLib.isZero(<span class="keyword">this</span>[i])) {


			<span class="keyword">if</span> (i &gt; <span class="number">1</span>) {
				content.push(<span class="keyword">new</span> MathLib.Expression({
						subtype: <span class="string">'naryOperator'</span>,
						value: <span class="string">'^'</span>,
						name: <span class="string">'pow'</span>,
						content: [<span class="keyword">new</span> MathLib.Expression({
								subtype: <span class="string">'naryOperator'</span>,
								content: [
									<span class="keyword">new</span> MathLib.Expression({
										subtype: <span class="string">'number'</span>,
										value: <span class="keyword">this</span>[i].toString()
									}),
									<span class="keyword">new</span> MathLib.Expression({
										subtype: <span class="string">'variable'</span>,
										value: <span class="string">'x'</span>
									})
								],
								value: <span class="string">'*'</span>,
								name: <span class="string">'times'</span>
							}),
							<span class="keyword">new</span> MathLib.Expression({
								subtype: <span class="string">'number'</span>,
								value: i.toString()
							}),
						]
					})
				);
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (i === <span class="number">1</span>) {
				content.push(<span class="keyword">new</span> MathLib.Expression({
						subtype: <span class="string">'naryOperator'</span>,
						content: [
							<span class="keyword">new</span> MathLib.Expression({
								subtype: <span class="string">'number'</span>,
								value: <span class="keyword">this</span>[i].toString()
							}),
							<span class="keyword">new</span> MathLib.Expression({
								subtype: <span class="string">'variable'</span>,
								value: <span class="string">'x'</span>
							})
						],
						value: <span class="string">'*'</span>,
						name: <span class="string">'times'</span>
					})
				);
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (i === <span class="number">0</span>) {
				content.push(<span class="keyword">new</span> MathLib.Expression({
						subtype: <span class="string">'number'</span>,
						value: <span class="keyword">this</span>[i].toString()
					})
				);
			}
		}
	}	

	sum = <span class="keyword">new</span> MathLib.Expression({
		content: content,
		subtype: <span class="string">'naryOperator'</span>,
		value: <span class="string">'+'</span>,
		name: <span class="string">'plus'</span>
	});


	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Expression({
		subtype: <span class="string">'functionDefinition'</span>,
		arguments: [<span class="string">'x'</span>],
		content: [sum]
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-477">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-477">&#182;</a>
              </div>
              <h3 id="polynomial-prototype-tofunctn-">Polynomial.prototype.toFunctn()</h3>
<p>Converts the polynomial to a functn</p>
<p><em>@return {Functn}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toFunctn() {
	<span class="keyword">var</span> str = <span class="string">''</span>, i, ii;
	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.deg; i &lt;= ii; i++) {
		<span class="keyword">if</span> (!MathLib.isZero(<span class="keyword">this</span>[i])) {
			<span class="keyword">if</span> (i === <span class="number">0</span>) {
				str += MathLib.toString(<span class="keyword">this</span>[i]);
			}
			<span class="keyword">else</span> {
				str += MathLib.toString(<span class="keyword">this</span>[i], <span class="literal">true</span>);
			}

			<span class="keyword">if</span> (i &gt; <span class="number">1</span>) {
				str += <span class="string">' * Math.pow(x, '</span> + MathLib.toString(i) + <span class="string">')'</span>;
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (i === <span class="number">1</span>) {
				str += <span class="string">' * x'</span>;
			}
		}
	}

	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Functn(<span class="keyword">new</span> Function(<span class="string">'x'</span>, <span class="string">'return '</span> + str), {
		expression: <span class="keyword">this</span>.toExpression()
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-478">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-478">&#182;</a>
              </div>
              <h3 id="polynomial-prototype-tolatex-">Polynomial.prototype.toLaTeX()</h3>
<p>Returns a LaTeX representation of the polynomial</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toLaTeX() : string {
	<span class="keyword">var</span> str = MathLib.toString(<span class="keyword">this</span>[<span class="keyword">this</span>.deg]) + <span class="string">'x^{'</span> + <span class="keyword">this</span>.deg + <span class="string">'}'</span>,
			i;

	<span class="keyword">for</span> (i = <span class="keyword">this</span>.deg - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) {
		<span class="keyword">if</span> (!MathLib.isZero(<span class="keyword">this</span>[i])) {</pre></div></div>
            
        </li>
        
        
        <li id="section-479">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-479">&#182;</a>
              </div>
              <p>if (i === 0) {
  str += MathLib.toLaTeX(this[i]);
}
else {</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				str += MathLib.toLaTeX(<span class="keyword">this</span>[i], <span class="literal">true</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-480">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-480">&#182;</a>
              </div>
              <p>}</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">if</span> (i &gt; <span class="number">1</span>) {
				str += <span class="string">'x^{'</span> + MathLib.toLaTeX(i) + <span class="string">'}'</span>;
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (i === <span class="number">1</span>) {
				str += <span class="string">'x'</span>;
			}
		}
	}
	<span class="keyword">return</span> str;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-481">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-481">&#182;</a>
              </div>
              <h3 id="polynomial-prototype-tomathml-">Polynomial.prototype.toMathML()</h3>
<p>Returns a MathML representation of the polynomial</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toMathML() : string {
	<span class="keyword">var</span> str = <span class="string">'&lt;mrow&gt;'</span> + MathLib.toMathML(<span class="keyword">this</span>[<span class="keyword">this</span>.deg]) + <span class="string">'&lt;mo&gt;&amp;#x2062;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;'</span> + MathLib.toMathML(<span class="keyword">this</span>.deg) + <span class="string">'&lt;/msup&gt;'</span>,
			i;
	<span class="keyword">for</span> (i = <span class="keyword">this</span>.deg - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) {
		<span class="keyword">if</span> (!MathLib.isZero(<span class="keyword">this</span>[i])) {</pre></div></div>
            
        </li>
        
        
        <li id="section-482">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-482">&#182;</a>
              </div>
              <p>if (i === 0) {
  str += MathLib.toMathML(this[i]);
}
else {</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				str += MathLib.toMathML(<span class="keyword">this</span>[i], <span class="literal">true</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-483">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-483">&#182;</a>
              </div>
              <p>}</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">if</span> (i &gt; <span class="number">1</span>) {
				str += <span class="string">'&lt;mo&gt;&amp;#x2062;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;'</span> + MathLib.toMathML(i) + <span class="string">'&lt;/msup&gt;'</span>;
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (i === <span class="number">1</span>) {
				str += <span class="string">'&lt;mo&gt;&amp;#x2062;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;'</span>;
			}
		}
	}

	str += <span class="string">'&lt;/mrow&gt;'</span>;

	<span class="keyword">return</span> str;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-484">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-484">&#182;</a>
              </div>
              <h3 id="polynomial-prototype-tostring-">Polynomial.prototype.toString()</h3>
<p>Custom toString function</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toString() : string {
	<span class="keyword">var</span> str = MathLib.toString(<span class="keyword">this</span>[<span class="keyword">this</span>.deg]) + <span class="string">'*x^'</span> + <span class="keyword">this</span>.deg,
			i;
	<span class="keyword">for</span> (i = <span class="keyword">this</span>.deg - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) {
		<span class="keyword">if</span> (!MathLib.isZero(<span class="keyword">this</span>[i])) {

			str += MathLib.toString(<span class="keyword">this</span>[i], <span class="literal">true</span>);

			<span class="keyword">if</span> (i &gt; <span class="number">1</span>) {
				str += <span class="string">'*x^'</span> + MathLib.toString(i);
			}
			<span class="keyword">else</span> <span class="keyword">if</span> (i === <span class="number">1</span>) {
				str += <span class="string">'*x'</span>;
			}
		}
	}
	<span class="keyword">return</span> str;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-485">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-485">&#182;</a>
              </div>
              <h3 id="polynomial-prototype-valueat-">Polynomial.prototype.valueAt()</h3>
<p>Evaluates the polynomial at a given point</p>
<p><em>@param {number|Complex|Matrix}</em><br><em>@return {number|Complex|Matrix}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>valueAt(x) {
	<span class="keyword">var</span> pot = MathLib.is(x, <span class="string">'matrix'</span>) ? MathLib.Matrix.identity(x.rows, x.cols) : <span class="number">1</span>,
			value = MathLib.is(x, <span class="string">'matrix'</span>) ? MathLib.Matrix.zero(x.rows, x.cols) : <span class="number">0</span>,
			i, ii;
	
	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.deg; i &lt;= ii; i++) {
		value = MathLib.plus(value, MathLib.times(<span class="keyword">this</span>[i], pot));
		pot = MathLib.times(pot, x);
	}
	<span class="keyword">return</span> value;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-486">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-486">&#182;</a>
              </div>
              <h3 id="polynomial-zero">Polynomial.zero</h3>
<p>Returns the zero polynomial</p>
<p><em>@return {Polynomial}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static zero = <span class="keyword">new</span> Polynomial([<span class="number">0</span>]);


}<span class="comment">// ## &lt;a id="Rational" href="http://mathlib.de/en/docs/Rational"&gt;Rational&lt;/a&gt;</span></pre></div></div>
            
        </li>
        
        
        <li id="section-487">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-487">&#182;</a>
              </div>
              <p>MathLib.Rational is the MathLib implementation of rational numbers.</p>
<h4 id="simple-use-case-">Simple use case:</h4>
<pre><code>// Create the rational number 2/3  
var r = new MathLib.Rational(2, 3);</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>export class Rational {

	type = <span class="string">'rational'</span>;

	numerator: number;
	denominator: number;

	constructor (numerator: number, denominator = <span class="number">1</span>) {
		<span class="keyword">if</span> (MathLib.isZero(denominator)) {
			MathLib.error({message: <span class="string">'The denominator cannot be zero.'</span>, method: <span class="string">'Rational.constructor'</span>});
			<span class="keyword">throw</span> <span class="string">'The denominator cannot be zero.'</span>;
		}
		<span class="keyword">this</span>.numerator = numerator;
		<span class="keyword">this</span>.denominator = denominator;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-488">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-488">&#182;</a>
              </div>
              <h3 id="-rational-prototype-compare-http-mathlib-de-en-docs-rational-compare-"><a href="http://mathlib.de/en/docs/Rational/compare">Rational.prototype.compare()</a></h3>
<p>Compares two rational numbers</p>
<p><em>@param {Rational}</em> The number to compare<br><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>compare(r : Rational) : number {
	<span class="keyword">return</span> MathLib.sign(<span class="keyword">this</span>.numerator * r.denominator - <span class="keyword">this</span>.denominator * r.numerator);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-489">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-489">&#182;</a>
              </div>
              <h3 id="-rational-prototype-divide-http-mathlib-de-en-docs-rational-divide-"><a href="http://mathlib.de/en/docs/Rational/divide">Rational.prototype.divide()</a></h3>
<p>Divides rational numbers</p>
<p><em>@param {Rational|number}</em> The divisor<br><em>@return {Rational}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>divide(r) {
	<span class="keyword">if</span> (r.type === <span class="string">'rational'</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Rational(MathLib.times(<span class="keyword">this</span>.numerator, r.denominator), MathLib.times(<span class="keyword">this</span>.denominator, r.numerator));
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> r === <span class="string">'number'</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Rational(<span class="keyword">this</span>.numerator, MathLib.times(<span class="keyword">this</span>.denominator, r));
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-490">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-490">&#182;</a>
              </div>
              <p>For complex numbers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">else</span> {
		<span class="keyword">return</span> r.inverse().times(<span class="keyword">this</span>);
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-491">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-491">&#182;</a>
              </div>
              <h3 id="-rational-prototype-inverse-http-mathlib-de-en-docs-rational-inverse-"><a href="http://mathlib.de/en/docs/Rational/inverse">Rational.prototype.inverse()</a></h3>
<p>Calculates the inverse of a rational number</p>
<p><em>@return {Rational}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>inverse() : Rational {
	<span class="keyword">if</span> (!MathLib.isZero(<span class="keyword">this</span>.numerator)) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Rational(<span class="keyword">this</span>.denominator, <span class="keyword">this</span>.numerator);
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-492">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-492">&#182;</a>
              </div>
              <h3 id="-rational-prototype-isequal-http-mathlib-de-en-docs-rational-isequal-"><a href="http://mathlib.de/en/docs/Rational/isEqual">Rational.prototype.isEqual()</a></h3>
<p>Checks if the rational number is equal to an other number</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isEqual(r) : boolean {
	<span class="keyword">return</span> MathLib.isEqual(MathLib.times(<span class="keyword">this</span>.numerator, r.denominator), MathLib.times(<span class="keyword">this</span>.denominator, r.numerator));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-493">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-493">&#182;</a>
              </div>
              <h3 id="-rational-prototype-iszero-http-mathlib-de-en-docs-rational-iszero-"><a href="http://mathlib.de/en/docs/Rational/isZero">Rational.prototype.isZero()</a></h3>
<p>Checks if the rational number is zero</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isZero() : boolean {
	<span class="keyword">return</span> MathLib.isZero(<span class="keyword">this</span>.numerator);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-494">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-494">&#182;</a>
              </div>
              <h3 id="-rational-prototype-minus-http-mathlib-de-en-docs-rational-minus-"><a href="http://mathlib.de/en/docs/Rational/minus">Rational.prototype.minus()</a></h3>
<p>Subtracts rational numbers</p>
<p><em>@param {Rational|number}</em> The number to be subtracted<br><em>@return {Rational}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>minus(r) {
	<span class="keyword">var</span> n = <span class="keyword">this</span>.numerator,
			d = <span class="keyword">this</span>.denominator;

	<span class="keyword">if</span> (r.type === <span class="string">'rational'</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Rational(MathLib.minus(MathLib.times(n, r.denominator), MathLib.times(d, r.numerator)),
			MathLib.times(d, r.denominator));
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> r === <span class="string">'number'</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Rational(MathLib.minus(n, MathLib.times(r, d)), d);
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-495">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-495">&#182;</a>
              </div>
              <p>For complex numbers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">else</span> {
		<span class="keyword">return</span> r.minus(<span class="keyword">this</span>).negative();
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-496">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-496">&#182;</a>
              </div>
              <h3 id="-rational-prototype-negative-http-mathlib-de-en-docs-rational-negative-"><a href="http://mathlib.de/en/docs/Rational/negative">Rational.prototype.negative()</a></h3>
<p>Calculates the negative of a rational number</p>
<p><em>@return {Rational}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>negative() : Rational {
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Rational(-<span class="keyword">this</span>.numerator, <span class="keyword">this</span>.denominator);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-497">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-497">&#182;</a>
              </div>
              <h3 id="-rational-prototype-plus-http-mathlib-de-en-docs-rational-plus-"><a href="http://mathlib.de/en/docs/Rational/plus">Rational.prototype.plus()</a></h3>
<p>Adds rational numbers</p>
<p><em>@param {Rational|number}</em> The number to be added<br><em>@return {Rational}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>plus(r) {
	<span class="keyword">var</span> n = <span class="keyword">this</span>.numerator,
			d = <span class="keyword">this</span>.denominator;

	<span class="keyword">if</span> (r.type === <span class="string">'rational'</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Rational(MathLib.plus(MathLib.times(d, r.numerator), MathLib.times(n, r.denominator)),
			MathLib.times(d, r.denominator));
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> r === <span class="string">'number'</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Rational(MathLib.plus(n, MathLib.times(r, d)), d);
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-498">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-498">&#182;</a>
              </div>
              <p>For complex numbers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">else</span> {
		<span class="keyword">return</span> r.plus(<span class="keyword">this</span>);
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-499">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-499">&#182;</a>
              </div>
              <h3 id="-rational-prototype-reduce-http-mathlib-de-en-docs-rational-reduce-"><a href="http://mathlib.de/en/docs/Rational/reduce">Rational.prototype.reduce()</a></h3>
<p>Reduces the rational number</p>
<p><em>@return {Rational}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>reduce() : Rational {
	<span class="keyword">var</span> gcd = MathLib.sign(<span class="keyword">this</span>.denominator) * MathLib.gcd([<span class="keyword">this</span>.numerator, <span class="keyword">this</span>.denominator]);
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Rational(<span class="keyword">this</span>.numerator / gcd, <span class="keyword">this</span>.denominator / gcd);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-500">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-500">&#182;</a>
              </div>
              <h3 id="-rational-prototype-times-http-mathlib-de-en-docs-rational-times-"><a href="http://mathlib.de/en/docs/Rational/times">Rational.prototype.times()</a></h3>
<p>Multiplies rational numbers</p>
<p><em>@param {Rational|number}</em> The number to be multiplied<br><em>@return {Rational}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>times(r) {
	<span class="keyword">if</span> (r.type === <span class="string">'rational'</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Rational(MathLib.times(<span class="keyword">this</span>.numerator, r.numerator), MathLib.times(<span class="keyword">this</span>.denominator, r.denominator));
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> r === <span class="string">'number'</span>) {
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Rational(MathLib.times(<span class="keyword">this</span>.numerator, r), <span class="keyword">this</span>.denominator);
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-501">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-501">&#182;</a>
              </div>
              <p>For complex numbers, matrices, vectors, polynomials</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">else</span> {
		<span class="keyword">return</span> r.times(<span class="keyword">this</span>);
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-502">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-502">&#182;</a>
              </div>
              <h3 id="-rational-prototype-tocontentmathml-http-mathlib-de-en-docs-rational-tocontentmathml-"><a href="http://mathlib.de/en/docs/Rational/toContentMathML">Rational.prototype.toContentMathML()</a></h3>
<p>Returns the Content MathML representation of the rational number</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toContentMathML() : string {
	<span class="keyword">return</span> <span class="string">'&lt;cn type="rational"&gt;'</span> + <span class="keyword">this</span>.numerator + <span class="string">'&lt;sep/&gt;'</span> + <span class="keyword">this</span>.denominator + <span class="string">'&lt;/cn&gt;'</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-503">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-503">&#182;</a>
              </div>
              <h3 id="-rational-prototype-tolatex-http-mathlib-de-en-docs-rational-tolatex-"><a href="http://mathlib.de/en/docs/Rational/toLaTeX">Rational.prototype.toLaTeX()</a></h3>
<p>Returns the LaTeX representation of the rational number</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toLaTeX() : string {
	<span class="keyword">return</span> <span class="string">'\\frac{'</span> + MathLib.toLaTeX(<span class="keyword">this</span>.numerator) + <span class="string">'}{'</span> + MathLib.toLaTeX(<span class="keyword">this</span>.denominator) + <span class="string">'}'</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-504">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-504">&#182;</a>
              </div>
              <h3 id="-rational-prototype-tomathml-http-mathlib-de-en-docs-rational-tomathml-"><a href="http://mathlib.de/en/docs/Rational/toMathML">Rational.prototype.toMathML()</a></h3>
<p>Returns the MathML representation of the rational number</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toMathML() : string {
	<span class="keyword">return</span> <span class="string">'&lt;mfrac&gt;'</span> + MathLib.toMathML(<span class="keyword">this</span>.numerator) + MathLib.toMathML(<span class="keyword">this</span>.denominator) + <span class="string">'&lt;/mfrac&gt;'</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-505">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-505">&#182;</a>
              </div>
              <h3 id="-rational-prototype-tonumber-http-mathlib-de-en-docs-rational-tonumber-"><a href="http://mathlib.de/en/docs/Rational/toNumber">Rational.prototype.toNumber()</a></h3>
<p>Returns the number represented by the rational number</p>
<p><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toNumber() : number {
	<span class="keyword">return</span> <span class="keyword">this</span>.numerator / <span class="keyword">this</span>.denominator;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-506">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-506">&#182;</a>
              </div>
              <h3 id="-rational-prototype-tostring-http-mathlib-de-en-docs-rational-tostring-"><a href="http://mathlib.de/en/docs/Rational/toString">Rational.prototype.toString()</a></h3>
<p>Custom toString function</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toString() : string {
	<span class="keyword">return</span> MathLib.toString(<span class="keyword">this</span>.numerator) + <span class="string">'/'</span> + MathLib.toString(<span class="keyword">this</span>.denominator);
}


}<span class="comment">// ## &lt;a id="Set"&gt;&lt;/a&gt;Set</span></pre></div></div>
            
        </li>
        
        
        <li id="section-507">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-507">&#182;</a>
              </div>
              <p>To generate the set {1, 2, 3, 4, 5} you simply need to type</p>
<pre><code>new MathLib.Set([1, 2, 3, 4, 5])</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>export class Set {

	type = <span class="string">'set'</span>;

	length: number;
	card: number;

	constructor (elements) {
		<span class="keyword">if</span> (!elements) {
			elements = [];
		}

		elements = elements.sort(MathLib.compare)
		.filter(<span class="function"><span class="keyword">function</span> <span class="params">(x, i, a)</span> {</span>
			<span class="keyword">return</span> (a.length === i + <span class="number">1</span>) || !MathLib.isEqual(x, a[i + <span class="number">1</span>]);
		});

		elements.forEach((x, i) =&gt; {<span class="keyword">this</span>[i] = x;});
		<span class="keyword">this</span>.length = elements.length;
		<span class="keyword">this</span>.card = elements.length;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-508">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-508">&#182;</a>
              </div>
              <h3 id="set-prototype-compare-">Set.prototype.compare()</h3>
<p>Compare function for sets</p>
<p><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>compare(x : any) : number {
	<span class="keyword">var</span> a, i, ii;

	<span class="keyword">if</span> (<span class="keyword">this</span>.card !== x.card) {
		<span class="keyword">return</span> MathLib.sign(<span class="keyword">this</span>.card - x.card);
	}
	<span class="keyword">else</span> {
		<span class="keyword">for</span> (i = <span class="number">0</span>, ii = <span class="keyword">this</span>.card; i &lt; ii; i++) {
			a = MathLib.compare(<span class="keyword">this</span>[i], x[i])
			<span class="keyword">if</span> (a !== <span class="number">0</span>) {
				<span class="keyword">return</span> a;
			}
		}
		<span class="keyword">return</span> <span class="number">0</span>;
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-509">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-509">&#182;</a>
              </div>
              <h3 id="set-prototype-every-">Set.prototype.every()</h3>
<p>Works like the Array.prototype.every function</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>every(...args : any[]) : boolean {
	<span class="keyword">return</span> Array.prototype.every.apply(<span class="keyword">this</span>, args);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-510">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-510">&#182;</a>
              </div>
              <h3 id="set-prototype-filter-">Set.prototype.filter()</h3>
<p>Works like the Array.prototype.filter function</p>
<p><em>@return {Set}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>filter(...args : any[]) : Set {
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Set(Array.prototype.filter.apply(<span class="keyword">this</span>, args));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-511">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-511">&#182;</a>
              </div>
              <h3 id="set-prototype-foreach-">Set.prototype.forEach()</h3>
<p>Works like the Array.prototype.forEach function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>forEach(...args : any[]) : <span class="keyword">void</span> {
	Array.prototype.forEach.apply(<span class="keyword">this</span>, args);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-512">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-512">&#182;</a>
              </div>
              <h3 id="set-prototype-fromto-">Set.prototype.fromTo()</h3>
<p>Creates a set containing the numbers from a start value to a end value.</p>
<p><em>@param {number}</em> The number to start from<br><em>@param {number}</em> The number to end with<br><em>@param {number}</em> The stepsize (default = 1)<br><em>@return {Set}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>static fromTo = <span class="function"><span class="keyword">function</span> <span class="params">(f : number, t : number, s : number = 1)</span> : <span class="title">Set</span> {</span>
	<span class="keyword">var</span> i, set = [];
	<span class="keyword">if</span> (f &lt;= t) {
		<span class="keyword">for</span> (i = f; i &lt;= t; i += s) {
			set.push(i);
		}
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Set(set);
	}
};</pre></div></div>
            
        </li>
        
        
        <li id="section-513">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-513">&#182;</a>
              </div>
              <h3 id="set-prototype-indexof-">Set.prototype.indexOf()</h3>
<p>Works like the Array.prototype.indexOf function</p>
<p><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>indexOf(...args : any[]) : number {
	<span class="keyword">return</span> Array.prototype.indexOf.apply(<span class="keyword">this</span>, args);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-514">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-514">&#182;</a>
              </div>
              <h3 id="set-prototype-insert-">Set.prototype.insert()</h3>
<p>Inserts an element into the set.</p>
<p><em>@return {Set}</em> Returns the current set</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>insert(x : any) : Set {
	<span class="keyword">var</span> i = <span class="keyword">this</span>.locate(x);
	<span class="keyword">if</span> (<span class="keyword">this</span>[i] !== x) {
		<span class="keyword">this</span>.splice(i, <span class="number">0</span>, x);
		<span class="keyword">this</span>.card++;
	}
	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-515">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-515">&#182;</a>
              </div>
              <h3 id="set-prototype-intersect-">Set.prototype.intersect()</h3>
<p>Returns the intersection of two sets.</p>
<p><em>@param {Set}</em><br><em>@return {Set}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>intersect = Set.createSetOperation(<span class="literal">false</span>, <span class="literal">true</span>, <span class="literal">false</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-516">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-516">&#182;</a>
              </div>
              <h3 id="set-prototype-isempty-">Set.prototype.isEmpty()</h3>
<p>Determines if the set is empty.</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isEmpty() : boolean {
	<span class="keyword">return</span> <span class="keyword">this</span>.card === <span class="number">0</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-517">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-517">&#182;</a>
              </div>
              <h3 id="set-prototype-isequal-">Set.prototype.isEqual()</h3>
<p>Determines if the set is equal to an other set.</p>
<p><em>@param {Set}</em> The set to compare<br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isEqual(x : Set) : boolean {
	<span class="keyword">if</span> (<span class="keyword">this</span>.card !== x.card) {
		<span class="keyword">return</span> <span class="literal">false</span>;
	}
	<span class="keyword">else</span> {
		<span class="keyword">return</span> <span class="keyword">this</span>.every(<span class="function"><span class="keyword">function</span> <span class="params">(y, i)</span> {</span>
			<span class="keyword">return</span> MathLib.isEqual(y, x[i]);
		});
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-518">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-518">&#182;</a>
              </div>
              <h3 id="set-prototype-issubsetof-">Set.prototype.isSubsetOf()</h3>
<p>Determines if the set is a subset of an other set.</p>
<p><em>@param {Set}</em> The potential superset<br><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>isSubsetOf(a : Set) : boolean {
	<span class="keyword">return</span> <span class="keyword">this</span>.every(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
		<span class="keyword">return</span> a.indexOf(x) !== -<span class="number">1</span>;
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-519">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-519">&#182;</a>
              </div>
              <h3 id="set-prototype-locate-">Set.prototype.locate()</h3>
<p>Array.prototype.indexOf() returns only the position of an element in the
array and not the position where one should be inserted.</p>
<p><em>@param {Set}</em> The element to locate<br><em>@return {number}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>locate(x : any) : number {
	<span class="keyword">var</span> left = <span class="number">0</span>,
			right = <span class="keyword">this</span>.card - <span class="number">1</span>,
			middle,
			i = <span class="keyword">this</span>.indexOf(x);

	<span class="keyword">if</span> (i !== -<span class="number">1</span>) {
		<span class="keyword">return</span> i;
	}

	<span class="keyword">while</span> (left &lt;= right) {
		middle = left + Math.floor((right - left) / <span class="number">2</span>);
		<span class="keyword">if</span> (<span class="keyword">this</span>[middle] &lt; x) {
				left = middle + <span class="number">1</span>;
		} <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>[middle] &gt; x) {
				right = middle - <span class="number">1</span>;
		} <span class="keyword">else</span> {
				<span class="keyword">return</span> middle;
		}
	}
	<span class="keyword">return</span> left;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-520">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-520">&#182;</a>
              </div>
              <h3 id="set-prototype-map-">Set.prototype.map()</h3>
<p>Works like the Array.prototype.map function</p>
<p><em>@param {function}</em> The mapping function<br><em>@return {Set}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>map(...args : any[]) : any {
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Set(Array.prototype.map.apply(<span class="keyword">this</span>, args));
}</pre></div></div>
            
        </li>
        
        
        <li id="section-521">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-521">&#182;</a>
              </div>
              <h3 id="set-prototype-plus-">Set.prototype.plus()</h3>
<p>Adds the argument to all elements in the set,<br>or if no argument is provided adds up all the elements in the set.</p>
<p><em>@param {number|MathLib object}</em><br><em>@return {Set|any}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>plus(n : any) : any {
	<span class="keyword">var</span> sum = [];
	<span class="keyword">if</span> (!arguments.length) {
		<span class="keyword">return</span> MathLib.plus.apply(<span class="literal">null</span>, <span class="keyword">this</span>.toArray());
	}
	<span class="keyword">else</span> <span class="keyword">if</span> (n.type === <span class="string">'set'</span>) {
		<span class="keyword">this</span>.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
				n.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(y)</span> {</span>
					sum.push(MathLib.plus(x, y));
				});
			});

		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Set(sum);
	}
	<span class="keyword">else</span> {
		<span class="keyword">return</span> <span class="keyword">this</span>.map(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
			<span class="keyword">return</span> MathLib.plus(x, n);
		});
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-522">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-522">&#182;</a>
              </div>
              <h3 id="set-prototype-powerset-">Set.prototype.powerset()</h3>
<p>Returns the powerset</p>
<p><em>@return {Set}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>powerset() : Set {
	<span class="keyword">var</span> flag, subset, i, ii, j, jj,
			powerset = [];

	<span class="keyword">for</span> (i = <span class="number">0</span>, ii = Math.pow(<span class="number">2</span>, <span class="keyword">this</span>.card); i &lt; ii; i++) {
		flag = i.toString(<span class="number">2</span>).split(<span class="string">''</span>).reverse();
		subset = [];
		<span class="keyword">for</span> (j = <span class="number">0</span>, jj = <span class="keyword">this</span>.card; j &lt; jj; j++) {
			<span class="keyword">if</span> (flag[j] === <span class="string">'1'</span>) {
				subset.push(<span class="keyword">this</span>[j]);
			}
		}
		powerset.push(<span class="keyword">new</span> MathLib.Set(subset));
	}
	<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Set(powerset);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-523">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-523">&#182;</a>
              </div>
              <h3 id="set-prototype-reduce-">Set.prototype.reduce()</h3>
<p>Works like the Array.prototype.reduce function</p>
<p><em>@return {any}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>reduce(...args : any[]) : any {
	<span class="keyword">return</span> Array.prototype.reduce.apply(<span class="keyword">this</span>, arguments);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-524">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-524">&#182;</a>
              </div>
              <h3 id="set-prototype-remove-">Set.prototype.remove()</h3>
<p>Removes a element from a set</p>
<p><em>@return {Set}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>remove(a : any) : Set {
	<span class="keyword">var</span> i = <span class="keyword">this</span>.indexOf(a);
	<span class="keyword">if</span> (i !== -<span class="number">1</span>) {
		<span class="keyword">this</span>.splice(i, <span class="number">1</span>);
		<span class="keyword">this</span>.card--;
	}
	<span class="keyword">return</span> <span class="keyword">this</span>;
}


static createSetOperation = <span class="function"><span class="keyword">function</span> <span class="params">(left, both, right)</span> {</span>
	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">(a)</span> {</span>
		<span class="keyword">var</span> set = [],
				i = <span class="number">0</span>,
				j = <span class="number">0</span>,
				tl = <span class="keyword">this</span>.card,
				al = a.card;

		<span class="keyword">while</span> (i &lt; tl &amp;&amp; j &lt; al) {
			<span class="keyword">if</span> (MathLib.compare(<span class="keyword">this</span>[i], a[j]) &lt; <span class="number">0</span>) {
				<span class="keyword">if</span> (left) {
					set.push(<span class="keyword">this</span>[i]);
				}
				i++;
				<span class="keyword">continue</span>;
			}
			<span class="keyword">if</span> (MathLib.compare(<span class="keyword">this</span>[i], a[j]) &gt; <span class="number">0</span>) {
				<span class="keyword">if</span> (right) {
					set.push(a[j]);
				}
				j++;
				<span class="keyword">continue</span>;
			}
			<span class="keyword">if</span> (MathLib.isEqual(<span class="keyword">this</span>[i], a[j])) {
				<span class="keyword">if</span> (both) {
					set.push(<span class="keyword">this</span>[i]);
				}
				i++;
				j++;
				<span class="keyword">continue</span>;
			}
		}
		<span class="keyword">if</span> (left &amp;&amp; j === al) {
			set = set.concat(<span class="keyword">this</span>.slice(i));
		}
		<span class="keyword">else</span> <span class="keyword">if</span> (right &amp;&amp; i === tl) {
			set = set.concat(a.slice(j));
		}
		<span class="keyword">return</span> <span class="keyword">new</span> MathLib.Set(set);
	};
};</pre></div></div>
            
        </li>
        
        
        <li id="section-525">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-525">&#182;</a>
              </div>
              <h3 id="set-prototype-slice-">Set.prototype.slice()</h3>
<p>Works like the Array.prototype.slice function</p>
<p><em>@return {array}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>slice(...args : any[]) : any {
	<span class="keyword">return</span> Array.prototype.slice.apply(<span class="keyword">this</span>, args);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-526">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-526">&#182;</a>
              </div>
              <h3 id="set-prototype-some-">Set.prototype.some()</h3>
<p>Works like the Array.prototype.some function</p>
<p><em>@return {boolean}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>some(...args : any[]) : boolean {
	<span class="keyword">return</span> Array.prototype.some.apply(<span class="keyword">this</span>, args);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-527">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-527">&#182;</a>
              </div>
              <h3 id="set-prototype-splice-">Set.prototype.splice()</h3>
<p>Works like the Array.prototype.splice function</p>
<p><em>@return {Set}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>splice(...args : any[]) : any {
	<span class="keyword">return</span> Array.prototype.splice.apply(<span class="keyword">this</span>, args);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-528">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-528">&#182;</a>
              </div>
              <h3 id="set-prototype-times-">Set.prototype.times()</h3>
<p>Multiplies all elements in the set if no argument is passed.
Multiplies all elements by a argument if one is passed.</p>
<p><em>@param {number|MathLib object}</em><br><em>@return {Set}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>times(n : any) : any {
	<span class="keyword">if</span> (!arguments.length) {
		<span class="keyword">return</span> MathLib.times.apply(<span class="literal">null</span>, <span class="keyword">this</span>.toArray());
	}
	<span class="keyword">else</span> {
		<span class="keyword">return</span> <span class="keyword">this</span>.map(<span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
			<span class="keyword">return</span> MathLib.times(x, n);
		});
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-529">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-529">&#182;</a>
              </div>
              <h3 id="set-prototype-toarray-">Set.prototype.toArray()</h3>
<p>Converts the set to an array</p>
<p><em>@return {array}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toArray() : any[] {
	<span class="keyword">return</span> Array.prototype.slice.call(<span class="keyword">this</span>);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-530">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-530">&#182;</a>
              </div>
              <h3 id="set-prototype-tocontentmathml-">Set.prototype.toContentMathML()</h3>
<p>Returns the content MathML representation of the set</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toContentMathML() : string {
	<span class="keyword">if</span> (<span class="keyword">this</span>.isEmpty()) {
		<span class="keyword">return</span> <span class="string">'&lt;emptyset/&gt;'</span>;
	}
	<span class="keyword">else</span> {
		<span class="keyword">return</span> <span class="keyword">this</span>.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(old, cur)</span> {</span>
			<span class="keyword">return</span> old + MathLib.toContentMathML(cur);
		}, <span class="string">'&lt;set&gt;'</span>) + <span class="string">'&lt;/set&gt;'</span>;
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-531">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-531">&#182;</a>
              </div>
              <h3 id="set-prototype-tolatex-">Set.prototype.toLaTeX()</h3>
<p>Returns the LaTeX representation of the set</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toLaTeX() : string {
	<span class="keyword">if</span> (<span class="keyword">this</span>.isEmpty()) {
		<span class="keyword">return</span> <span class="string">'\\emptyset'</span>;
	}
	<span class="keyword">else</span> {
		<span class="keyword">return</span> <span class="keyword">this</span>.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(old, cur)</span> {</span>
			<span class="keyword">return</span> old + MathLib.toLaTeX(cur) + <span class="string">', '</span>;
		}, <span class="string">'\\{'</span>).slice(<span class="number">0</span>, -<span class="number">2</span>) + <span class="string">'\\}'</span>;
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-532">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-532">&#182;</a>
              </div>
              <h3 id="set-prototype-tomathml-">Set.prototype.toMathML()</h3>
<p>Returns the (presentation) MathML representation of the set</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toMathML() : string {
	<span class="keyword">if</span> (<span class="keyword">this</span>.isEmpty()) {
		<span class="keyword">return</span> <span class="string">'&lt;mi&gt;&amp;#x2205;&lt;/mi&gt;'</span>;
	}
	<span class="keyword">else</span> {
		<span class="keyword">return</span> <span class="keyword">this</span>.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(old, cur)</span> {</span>
			<span class="keyword">return</span> old + MathLib.toMathML(cur) + <span class="string">'&lt;mo&gt;,&lt;/mo&gt;'</span>;
		}, <span class="string">'&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;'</span>).slice(<span class="number">0</span>, -<span class="number">10</span>) + <span class="string">'&lt;mo&gt;}&lt;/mo&gt;&lt;/mrow&gt;'</span>;
	}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-533">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-533">&#182;</a>
              </div>
              <h3 id="set-prototype-tostring-">Set.prototype.toString()</h3>
<p>Returns a string representation of the set</p>
<p><em>@return {string}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>toString() : string {
	<span class="keyword">if</span> (<span class="keyword">this</span>.isEmpty()) {
		<span class="keyword">return</span> <span class="string">'∅'</span>;
	}
	<span class="keyword">return</span> <span class="string">'{'</span> + Array.prototype.join.call(<span class="keyword">this</span>, <span class="string">', '</span>) + <span class="string">'}'</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-534">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-534">&#182;</a>
              </div>
              <h3 id="set-prototype-union-">Set.prototype.union()</h3>
<p>Returns the union of two sets.</p>
<p><em>@param {Set}</em><br><em>@return {Set}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>union = Set.createSetOperation(<span class="literal">true</span>, <span class="literal">true</span>, <span class="literal">true</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-535">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-535">&#182;</a>
              </div>
              <h3 id="set-prototype-without-">Set.prototype.without()</h3>
<p>Returns all elements, which are in the first set, but not in the second.</p>
<p><em>@param {Set}</em><br><em>@return {Set}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>without = Set.createSetOperation(<span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-536">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-536">&#182;</a>
              </div>
              <h3 id="set-prototype-xor-">Set.prototype.xor()</h3>
<p>Returns all elements which are in either the first or the second set.</p>
<p><em>@param {Set}</em><br><em>@return {Set}</em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>xor = Set.createSetOperation(<span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">true</span>);


}
}</pre></div></div>
            
        </li>
        
        
        <li id="section-537">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-537">&#182;</a>
              </div>
              <p><a href="https://dvcs.w3.org/hg/fullscreen/raw-file/tip/Overview.html">Specification</a><br>Chrome: ~<br>Firefox: ~ <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=743198">Unprefix the DOM fullscreen API</a><br>Safari: ✗<br>Internet Explorer: ✗<br>Opera: ✗  </p>
<p>@fileoverview game-shim - Shims to normalize gaming-related APIs to their respective specs
@author Brandon Jones
@version 1.2</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="comment">/* Copyright (c) 2012, Brandon Jones. All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

  * Redistributions of source code must retain the above copyright notice, this
	list of conditions and the following disclaimer.
  * Redistributions in binary form must reproduce the above copyright notice,
	this list of conditions and the following disclaimer in the documentation 
	and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE 
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */</span>

(<span class="function"><span class="keyword">function</span> <span class="params">(global)</span> {</span>
	<span class="string">'use strict'</span>;

	<span class="keyword">var</span> elementPrototype = (global.HTMLElement || global.Element)[<span class="string">'prototype'</span>];
	<span class="keyword">var</span> getter;</pre></div></div>
            
        </li>
        
        
        <li id="section-538">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-538">&#182;</a>
              </div>
              <p>document.fullscreenEnabled</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (!document.hasOwnProperty(<span class="string">'fullscreenEnabled'</span>)) {
		getter = (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-539">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-539">&#182;</a>
              </div>
              <p>These are the functions that match the spec, and should be preferred</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">if</span> (<span class="string">'webkitIsFullScreen'</span> <span class="keyword">in</span> document) {
				<span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>document).webkitFullscreenEnabled; };
			}
			if ('mozFullScreenEnabled' in document) {
				return function () { return (<span class="tag">&lt;<span class="title">any</span>&gt;</span>document).mozFullScreenEnabled; };
			}

			return function () { return false; }; // not supported, never fullscreen
		})();


	}

	if (!document.hasOwnProperty('fullscreenElement')) {
		getter = (function () {
</span></pre></div></div>
            
        </li>
        
        
        <li id="section-540">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-540">&#182;</a>
              </div>
              <p>These are the functions that match the spec, and should be preferred</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">var</span> i, ii,
					name = [<span class="string">'webkitCurrentFullScreenElement'</span>, <span class="string">'webkitFullscreenElement'</span>, <span class="string">'mozFullScreenElement'</span>];
			<span class="keyword">for</span> (i = <span class="number">0</span>, ii = name.length; i &lt; ii; i++)
			{
				<span class="keyword">if</span> (name[i] <span class="keyword">in</span> document)
				{
					<span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> document[name[i]]; };
				}
			}
			<span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> <span class="literal">null</span>; }; <span class="comment">// not supported</span>
		})();

		Object.defineProperty(document, <span class="string">'fullscreenElement'</span>, {
			enumerable: <span class="literal">true</span>, configurable: <span class="literal">false</span>, writeable: <span class="literal">false</span>,
			get: getter
		});
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-541">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-541">&#182;</a>
              </div>
              <p>Document event: fullscreenchange</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="function"><span class="keyword">function</span> <span class="title">fullscreenchange</span><span class="params">()</span> {</span>
		<span class="keyword">var</span> newEvent = document.createEvent(<span class="string">'CustomEvent'</span>);
		(<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>newEvent).initCustomEvent('fullscreenchange', true, false, null);
</span></pre></div></div>
            
        </li>
        
        
        <li id="section-542">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-542">&#182;</a>
              </div>
              <p>TODO: Any need for variable copy?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		document.dispatchEvent(newEvent);
	}
	document.addEventListener(<span class="string">'webkitfullscreenchange'</span>, fullscreenchange, <span class="literal">false</span>);
	document.addEventListener(<span class="string">'mozfullscreenchange'</span>, fullscreenchange, <span class="literal">false</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-543">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-543">&#182;</a>
              </div>
              <p>Document event: fullscreenerror</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="function"><span class="keyword">function</span> <span class="title">fullscreenerror</span><span class="params">()</span> {</span>
		<span class="keyword">var</span> newEvent = document.createEvent(<span class="string">'CustomEvent'</span>);
		(<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>newEvent).initCustomEvent('fullscreenerror', true, false, null);
</span></pre></div></div>
            
        </li>
        
        
        <li id="section-544">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-544">&#182;</a>
              </div>
              <p>TODO: Any need for variable copy?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		document.dispatchEvent(newEvent);
	}
	document.addEventListener(<span class="string">'webkitfullscreenerror'</span>, fullscreenerror, <span class="literal">false</span>);
	document.addEventListener(<span class="string">'mozfullscreenerror'</span>, fullscreenerror, <span class="literal">false</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-545">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-545">&#182;</a>
              </div>
              <p>element.requestFullScreen</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (!elementPrototype.requestFullScreen) {
		elementPrototype.requestFullScreen = (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
			<span class="keyword">if</span> (elementPrototype.webkitRequestFullScreen) {
				<span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
					<span class="keyword">this</span>.webkitRequestFullScreen((<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>Element).ALLOW_KEYBOARD_INPUT);
				};
			}

			if (elementPrototype.mozRequestFullScreen) {
				return function () {
					this.mozRequestFullScreen();
				};
			}

			return function () {};
		})();
	}

</span></pre></div></div>
            
        </li>
        
        
        <li id="section-546">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-546">&#182;</a>
              </div>
              <p>document.exitFullScreen</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (!(<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>document).exitFullScreen) {
		(<span class="tag">&lt;<span class="title">any</span>&gt;</span>document).exitFullScreen = (function () {
			return  (<span class="tag">&lt;<span class="title">any</span>&gt;</span>document).webkitCancelFullScreen ||
					(<span class="tag">&lt;<span class="title">any</span>&gt;</span>document).mozCancelFullScreen ||
					function () {};
		})();
	}

})(window);


</span></pre></div></div>
            
        </li>
        
        
        <li id="section-547">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-547">&#182;</a>
              </div>
              <p><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#line-styles">Specification</a><br>Chrome: ✓ <a href="http://trac.webkit.org/changeset/128116">Implement canvas v5 line dash feature</a><br>Firefox: ~ <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=768067">Implement canvasRenderingContext2D.get/setLineDash</a><br>Safari: ✗<br>Internet Explorer: ✗<br>Opera: ✗  </p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">if</span> (!(<span class="string">'setLineDash'</span> <span class="keyword">in</span> CanvasRenderingContext2D.prototype)) {
	<span class="keyword">var</span> setLineDash, getLineDash, setLineDashOffset, getLineDashOffset, prototype;

	<span class="keyword">if</span> (<span class="string">'mozDash'</span> <span class="keyword">in</span> CanvasRenderingContext2D.prototype) {
		prototype = CanvasRenderingContext2D.prototype;
		setLineDash = <span class="function"><span class="keyword">function</span> <span class="params">(dash)</span> {</span>
			<span class="keyword">this</span>.mozDash = dash;
		};
		getLineDash = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
			<span class="keyword">return</span> <span class="keyword">this</span>.mozDash;
		};

		setLineDashOffset = <span class="function"><span class="keyword">function</span> <span class="params">(dashOffset)</span> {</span>
			<span class="keyword">this</span>.mozDashOffset = dashOffset;
		};
		getLineDashOffset = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
			<span class="keyword">return</span> <span class="keyword">this</span>.mozDashOffset;
		};

	}</pre></div></div>
            
        </li>
        
        
        <li id="section-548">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-548">&#182;</a>
              </div>
              <p>Safari isn&#39;t supporting webkitLineDash any longer, but it also has no support for setLineDash.
Additionally extending the CanvasRenderingContext2D.prototype is only possible with a weird hack.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="comment">/*
	else if ('webkitLineDash' in CanvasRenderingContext2D.prototype) {
		prototype = document.createElement('canvas').getContext('2d').__proto__;
		setLineDash = function (dash) {
			this.webkitLineDash = dash;
		};
		getLineDash = function () {
			return this.webkitLineDash;
		};

		setLineDashOffset = function (dashOffset) {
			this.webkitLineDashOffset = dashOffset;
		};
		getLineDashOffset = function () {
			return this.webkitLineDashOffset;
		};
	}
	*/</span>
	<span class="keyword">else</span> {
		prototype = CanvasRenderingContext2D.prototype;
		setLineDash = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>};
		getLineDash = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>};
		setLineDashOffset = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>};
		getLineDashOffset = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>};
	}


	Object.defineProperty(prototype, <span class="string">'setLineDash'</span>, {
		value: setLineDash,
		enumerable: <span class="literal">true</span>,
		configurable: <span class="literal">false</span>,
		writeable: <span class="literal">false</span>
	});

	Object.defineProperty(prototype, <span class="string">'getLineDash'</span>, {
		value: getLineDash,
		enumerable: <span class="literal">true</span>,
		configurable: <span class="literal">false</span>,
		writeable: <span class="literal">false</span>
	});

	Object.defineProperty(prototype, <span class="string">'lineDashOffset'</span>, {
		set: setLineDashOffset,
		get: getLineDashOffset,
		enumerable: <span class="literal">true</span>,
		configurable: <span class="literal">false</span>,
		writeable: <span class="literal">false</span>
	});
		
}</pre></div></div>
            
        </li>
        
        
        <li id="section-549">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-549">&#182;</a>
              </div>
              <p>Copyright 2012 Kap IT (<a href="http://www.kapit.fr/">http://www.kapit.fr/</a>)</p>
<p>Licensed under the Apache License, Version 2.0 (the &#39;License&#39;);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p>
<p><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an &#39;AS IS&#39; BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
Author : François de Campredon (<a href="http://francois.de-campredon.fr/">http://francois.de-campredon.fr/</a>),</p>
<h1 id="object-observe-polyfill">Object.observe PolyFill</h1>

            </div>
            
        </li>
        
        
        <li id="section-550">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-550">&#182;</a>
              </div>
              <p><em>See <a href="http://wiki.ecmascript.org/doku.php?id=harmony:observe">The harmony proposal page</a></em></p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">if</span> ((<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>Object).observe === undefined) {
	
	(function (global) {
		'use strict';


</span></pre></div></div>
            
        </li>
        
        
        <li id="section-551">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-551">&#182;</a>
              </div>
              <h2 id="utilities">Utilities</h2>

            </div>
            
        </li>
        
        
        <li id="section-552">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-552">&#182;</a>
              </div>
              <p>setImmediate shim used to deliver changes records asynchronously</p>
<p>use setImmediate if available</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">var</span> setImmediate = global.setImmediate || global.msSetImmediate;
		<span class="keyword">var</span> clearImmediate = global.clearImmediate || global.msClearImmediate;
		<span class="keyword">if</span> (!setImmediate) {</pre></div></div>
            
        </li>
        
        
        <li id="section-553">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-553">&#182;</a>
              </div>
              <p>fallback on setTimeout if not</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			setImmediate = <span class="function"><span class="keyword">function</span> <span class="params">(func, args)</span> {</span>
				<span class="keyword">return</span> setTimeout(func, <span class="number">0</span>, args);
			};
			clearImmediate = <span class="function"><span class="keyword">function</span> <span class="params">(id)</span> {</span>
				clearTimeout(id);
			};
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-554">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-554">&#182;</a>
              </div>
              <h2 id="internal-properties">Internal Properties</h2>

            </div>
            
        </li>
        
        
        <li id="section-555">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-555">&#182;</a>
              </div>
              <p>An ordered list used to provide a deterministic ordering in which callbacks are called.
<a href="http://wiki.ecmascript.org/doku.php?id=harmony:observe#observercallbacks">Corresponding Section in ecma script wiki</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">var</span> observerCallbacks = [];</pre></div></div>
            
        </li>
        
        
        <li id="section-556">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-556">&#182;</a>
              </div>
              <p>This object is used as the prototype of all the notifiers that are returned by Object.getNotifier(O).
<a href="http://wiki.ecmascript.org/doku.php?id=harmony:observe#notifierprototype">Corresponding Section in ecma script wiki</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">var</span> NotifierPrototype = Object.create(Object.prototype);
		Object.defineProperty(NotifierPrototype, <span class="string">'notify'</span>, {
			value: <span class="function"><span class="keyword">function</span> <span class="params">(changeRecord)</span> {</span>
				<span class="keyword">var</span> notifier = <span class="keyword">this</span>;
				<span class="keyword">if</span> (Object(notifier) !== notifier) {
					<span class="keyword">throw</span> <span class="keyword">new</span> TypeError(<span class="string">'this must be an Object, given '</span> + notifier);
				}
				<span class="keyword">if</span> (Object(notifier) !== notifier) {
					<span class="keyword">throw</span> <span class="keyword">new</span> TypeError(<span class="string">'changeRecord must be an Object, given '</span> + changeRecord);
				}
				<span class="keyword">if</span> (!<span class="keyword">this</span>.target) {
					<span class="keyword">return</span>;
				}

				<span class="keyword">var</span> type = changeRecord.type;
				<span class="keyword">if</span> (<span class="keyword">typeof</span> type !== <span class="string">'string'</span>) {
					<span class="keyword">throw</span> <span class="keyword">new</span> TypeError(<span class="string">'changeRecord.type must be a string, given '</span> + type);
				}

				<span class="keyword">var</span> changeObservers = notifier.changeObservers;
				<span class="keyword">if</span> (!changeObservers || changeObservers.length === <span class="number">0</span>) {
					<span class="keyword">return</span>;
				}
				<span class="keyword">var</span> target = notifier.target,
					newRecord = Object.create(Object.prototype);
				Object.defineProperty(newRecord, <span class="string">'object'</span>, {
					value: target,
					writable : <span class="literal">false</span>,
					enumerable : <span class="literal">true</span>,
					configurable: <span class="literal">false</span>
				});
				<span class="keyword">for</span> (<span class="keyword">var</span> prop <span class="keyword">in</span> changeRecord) {
					<span class="keyword">if</span> (prop !== <span class="string">'object'</span>) {
						<span class="keyword">var</span> value = changeRecord[prop];
						Object.defineProperty(newRecord, prop, {
							value: value,
							writable : <span class="literal">false</span>,
							enumerable : <span class="literal">true</span>,
							configurable: <span class="literal">false</span>
						});
					}
				}
				Object.preventExtensions(newRecord);
				enqueueChangeRecord(newRecord, changeObservers);
				setUpChangesDelivery();
			},
			writable: <span class="literal">true</span>,
			enumerable: <span class="literal">false</span>,
			configurable : <span class="literal">true</span>
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-557">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-557">&#182;</a>
              </div>
              <p>Used to store immediate uid reference</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">var</span> changeDeliveryImmediateUid;</pre></div></div>
            
        </li>
        
        
        <li id="section-558">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-558">&#182;</a>
              </div>
              <p>Used to schedule a call to deliverAllChangeRecords</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="function"><span class="keyword">function</span> <span class="title">setUpChangesDelivery</span><span class="params">()</span> {</span>
			clearImmediate(changeDeliveryImmediateUid);
			changeDeliveryImmediateUid = setImmediate(deliverAllChangeRecords, <span class="number">0</span>);
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-559">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-559">&#182;</a>
              </div>
              <p>Key used to store reference to notifier in objects</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">var</span> notifierProperty = <span class="string">'__notifier__'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-560">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-560">&#182;</a>
              </div>
              <p>Implementation of the internal algorithm &#39;GetNotifier&#39;
described in the proposal.
<a href="http://wiki.ecmascript.org/doku.php?id=harmony:observe#getnotifier">Corresponding Section in ecma script wiki</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="function"><span class="keyword">function</span> <span class="title">getNotifier</span><span class="params">(target)</span> {</span>
			<span class="keyword">if</span> (!target.hasOwnProperty(notifierProperty)) {
				<span class="keyword">var</span> notifier = Object.create(NotifierPrototype);
				notifier.target = target;
				notifier.changeObservers = [];

				Object.defineProperty(target, notifierProperty, {
					value : notifier,
					enumerable: <span class="literal">false</span>,
					configurable: <span class="literal">true</span>,
					writable: <span class="literal">true</span>
				});
			}
			<span class="keyword">return</span> target[notifierProperty];
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-561">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-561">&#182;</a>
              </div>
              <p>Key used to store reference to a list of pending changeRecords
in observer callback.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">var</span> pendingChangesProperty = <span class="string">'__pendingChangeRecords__'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-562">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-562">&#182;</a>
              </div>
              <p>Implementation of the internal algorithm &#39;EnqueueChangeRecord&#39;
described in the proposal.
<a href="http://wiki.ecmascript.org/doku.php?id=harmony:observe#enqueuechangerecord">Corresponding Section in ecma script wiki</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="function"><span class="keyword">function</span> <span class="title">enqueueChangeRecord</span><span class="params">(newRecord, observers)</span> {</span>
			<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = observers.length; i &lt; l; i++) {
				<span class="keyword">var</span> observer = observers[i];
				<span class="keyword">if</span> (!observer.hasOwnProperty(pendingChangesProperty)) {
					Object.defineProperty(observer, pendingChangesProperty, {
						value : <span class="literal">null</span>,
						enumerable: <span class="literal">false</span>,
						configurable: <span class="literal">true</span>,
						writable: <span class="literal">true</span>
					});
				}
				<span class="keyword">var</span> pendingChangeRecords = observer[pendingChangesProperty] || (observer[pendingChangesProperty] = []);
				pendingChangeRecords.push(newRecord);
			}
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-563">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-563">&#182;</a>
              </div>
              <p>key used to store a count of associated notifier to a function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">var</span> attachedNotifierCountProperty = <span class="string">'___attachedNotifierCount__'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-564">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-564">&#182;</a>
              </div>
              <p>Remove reference all reference to an observer callback,
if this one is not used anymore.
In the proposal the ObserverCallBack has a weak reference over observers,
Without this possibility we need to clean this list to avoid memory leak</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="function"><span class="keyword">function</span> <span class="title">cleanObserver</span><span class="params">(observer)</span> {</span>
			<span class="keyword">if</span> (!observer[attachedNotifierCountProperty] &amp;&amp; !observer[pendingChangesProperty]) {
				<span class="keyword">var</span> index = observerCallbacks.indexOf(observer);
				<span class="keyword">if</span> (index !== -<span class="number">1</span>) {
					observerCallbacks.splice(index, <span class="number">1</span>);
				}
			}
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-565">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-565">&#182;</a>
              </div>
              <p>Implementation of the internal algorithm &#39;DeliverChangeRecords&#39;
described in the proposal.
<a href="http://wiki.ecmascript.org/doku.php?id=harmony:observe#deliverchangerecords">Corresponding Section in ecma script wiki</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="function"><span class="keyword">function</span> <span class="title">deliverChangeRecords</span><span class="params">(observer)</span> {</span>
			<span class="keyword">var</span> pendingChangeRecords = observer[pendingChangesProperty];
			observer[pendingChangesProperty] = <span class="literal">null</span>;
			<span class="keyword">if</span> (!pendingChangeRecords || pendingChangeRecords.length === <span class="number">0</span>) {
				<span class="keyword">return</span> <span class="literal">false</span>;
			}
			<span class="keyword">try</span> {
				observer.call(<span class="literal">undefined</span>, pendingChangeRecords);
			}
			<span class="keyword">catch</span> (e) {</pre></div></div>
            
        </li>
        
        
        <li id="section-566">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-566">&#182;</a>
              </div>
              <p>TODO examine this</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				console.log(e);
			}

			cleanObserver(observer);
			<span class="keyword">return</span> <span class="literal">true</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-567">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-567">&#182;</a>
              </div>
              <p>Implementation of the internal algorithm &#39;DeliverAllChangeRecords&#39;
described in the proposal.
<a href="http://wiki.ecmascript.org/doku.php?id=harmony:observe#deliverallchangerecords">Corresponding Section in ecma script wiki</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="function"><span class="keyword">function</span> <span class="title">deliverAllChangeRecords</span><span class="params">()</span> {</span>
			<span class="keyword">var</span> observers = observerCallbacks.slice(<span class="number">0</span>);
			<span class="keyword">var</span> anyWorkDone = <span class="literal">false</span>;
			<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = observers.length; i &lt; l; i++) {
				<span class="keyword">var</span> observer = observers[i];
				<span class="keyword">if</span> (deliverChangeRecords(observer)) {
					anyWorkDone = <span class="literal">true</span>;
				}
			}
			<span class="keyword">return</span> anyWorkDone;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-568">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-568">&#182;</a>
              </div>
              <p>Implementation of the public api &#39;Object.observe&#39;
described in the proposal.
<a href="http://wiki.ecmascript.org/doku.php?id=harmony:observe#object.observe">Corresponding Section in ecma script wiki</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		(<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>Object).observe = function (target, observer) {
			if (Object(target) !== target) {
				throw new TypeError('target must be an Object, given ' + target);
			}
			if (typeof observer !== 'function') {
				throw new TypeError('observerCallBack must be a function, given ' + observer);
			}

			if (Object.isFrozen(observer)) {
				throw new TypeError('observer cannot be frozen');
			}

			var notifier = getNotifier(target),
				changeObservers = notifier.changeObservers;

			if (changeObservers.indexOf(observer) === -1) {
				changeObservers.push(observer);
				if (observerCallbacks.indexOf(observer) === -1) {
					observerCallbacks.push(observer);
				}
				if (!observer.hasOwnProperty(attachedNotifierCountProperty)) {
					Object.defineProperty(observer, attachedNotifierCountProperty, {
						value : 0,
						enumerable: false,
						configurable: true,
						writable: true
					});
				}
				observer[attachedNotifierCountProperty]++;
			}
			return target;
		};

</span></pre></div></div>
            
        </li>
        
        
        <li id="section-569">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-569">&#182;</a>
              </div>
              <p>Implementation of the public api &#39;Object.unobseve&#39;
described in the proposal.
<a href="http://wiki.ecmascript.org/doku.php?id=harmony:observe#object.unobseve">Corresponding Section in ecma script wiki</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		(<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>Object).unobserve = function (target, observer) {
			if (Object(target) !== target) {
				throw new TypeError('target must be an Object, given ' + target);
			}
			if (typeof observer !== 'function') {
				throw new TypeError('observerCallBack must be a function, given ' + observer);
			}
			var notifier = getNotifier(target);
			var changeObservers = notifier.changeObservers;
			var index = notifier.changeObservers.indexOf(observer);
			if (index !== -1) {
				changeObservers.splice(index, 1);
				observer[attachedNotifierCountProperty]--;
				cleanObserver(observer);
			}
			return target;
		};

</span></pre></div></div>
            
        </li>
        
        
        <li id="section-570">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-570">&#182;</a>
              </div>
              <p>Implementation of the public api &#39;Object.deliverChangeRecords&#39;
described in the proposal.
<a href="http://wiki.ecmascript.org/doku.php?id=harmony:observe#object.deliverchangerecords">Corresponding Section in ecma script wiki</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		(<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>Object).deliverChangeRecords = function (observer) {
			if (typeof observer !== 'function') {
				throw new TypeError('callback must be a function, given ' + observer);
			}
			while (deliverChangeRecords(observer)) {}
		};

</span></pre></div></div>
            
        </li>
        
        
        <li id="section-571">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-571">&#182;</a>
              </div>
              <p>Implementation of the public api &#39;Object.getNotifier&#39;
described in the proposal.
<a href="http://wiki.ecmascript.org/doku.php?id=harmony:observe#object.getnotifier">Corresponding Section in ecma script wiki</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		(<span class="xml"><span class="tag">&lt;<span class="title">any</span>&gt;</span>Object).getNotifier = function (target) {
			if (Object(target) !== target) {
				throw new TypeError('target must be an Object, given ' + target);
			}
			return getNotifier(target);
		};


	})(this);

}

</span></pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
