/*! MathLib v0.1 MathLib.de | MathLib.de/en/license */
Array.prototype.every||(Array.prototype.every=function(a){"use strict";if(this==null)throw new TypeError;var b=Object(this),c=b.length>>>0;if(typeof a!="function")throw new TypeError;var d=arguments[1];for(var e=0;e<c;e++)if(e in b&&!a.call(d,b[e],e,b))return!1;return!0}),Array.prototype.filter||(Array.prototype.filter=function(a){"use strict";if(this==null)throw new TypeError;var b=Object(this),c=b.length>>>0;if(typeof a!="function")throw new TypeError;var d=[],e=arguments[1];for(var f=0;f<c;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d;if(this==null)throw new TypeError(" this is null or not defined");var e=Object(this),f=e.length>>>0;if({}.toString.call(a)!="[object Function]")throw new TypeError(a+" is not a function");b&&(c=b),d=0;while(d<f){var g;d in e&&(g=e[d],a.call(c,g,d,e)),d++}}),Array.prototype.map||(Array.prototype.map=function(a,b){var c,d,e;if(this==null)throw new TypeError(" this is null or not defined");var f=Object(this),g=f.length>>>0;if({}.toString.call(a)!="[object Function]")throw new TypeError(a+" is not a function");b&&(c=b),d=Array(g),e=0;while(e<g){var h,i;e in f&&(h=f[e],i=a.call(c,h,e,f),d[e]=i),e++}return d}),Array.prototype.reduce||(Array.prototype.reduce=function(b){var c=0,d=this.length>>0,e;if(typeof b!="function")throw new TypeError("First argument is not callable");if(arguments.length<2){if(d===0)throw new TypeError("Array length is 0 and no second argument");e=this[0],c=1}else e=arguments[1];while(c<d)c in this&&(e=b.call(undefined,e,this[c],c,this)),++c;return e}),Array.prototype.some||(Array.prototype.some=function(a){"use strict";if(this==null)throw new TypeError;var b=Object(this),c=b.length>>>0;if(typeof a!="function")throw new TypeError;var d=arguments[1];for(var e=0;e<c;e++)if(e in b&&a.call(d,b[e],e,b))return!0;return!1}),function(a){var b="MathLib",c=this,d=c.MathLib,e=c[b],f,g="__proto__",h,i=function(a){var b=[];return a.forEach(function(a){Array.isArray(a)?b=b.concat(i(a)):b.push(a)}),b},j=Array.prototype.slice;f={version:.1,apery:1.2020569031595942,e:Math.E,epsilon:Number.EPSILON||function(){var a,b;for(a=1;1+a!==1;a/=2)b=a;return b}(),eulerMascheroni:.5772156649015329,goldenRatio:1.618033988749895,pi:Math.PI},h={func:Object.getPrototypeOf(function(){}),array:Object.getPrototypeOf([]),object:Object.getPrototypeOf({})},f.prototypes=h,f.extend=function(a,b,c,d){d=d||{enumerable:!0};var e=f[a]||f;Object.defineProperty(e,b,{value:c,writable:d.writable,enumerable:d.enumerable,configurable:d.configurable})},f.extendPrototype=function(a,b,c,d){d=d||{enumerable:!0},Object.defineProperty(h[a],b,{value:c,writable:d.writable,enumerable:d.enumerable,configurable:d.configurable})},h.MathML={};var k={toMathML:function(){var a={apply:function(a){var b=a.childNodes[0],c=a.childNodes.slice(1).map(function(a){return a.toMathML()}),d="";return b.nodeName==="plus"?d="<mrow>"+c.join("<mo>+</mo>")+"</mrow>":b.nodeName==="times"?d="<mrow>"+c.join("<mo>*</mo>")+"</mrow>":b.nodeName==="power"?d="<msup>"+c[0]+c[1]+"</msup>":d="<mrow><mi>"+b.nodeName+"</mi><mo>&af;</mo><mfenced>"+c.join("")+"</mfenced></mrow>",d},bvar:function(){return""},ci:function(a){return"<mi>"+a.innerMathML+"</mi>"},cn:function(a){return"<mn>"+a.innerMathML+"</mn>"},cs:function(a){return"<ms>"+a.innerMathML+"</ms>"},domainofapplication:function(){return""},lambda:function(a){return a.childNodes.reduce(function(a,b){return a+b.toMathML()})},"#text":function(a){return a.innerMathML}};return a[this.nodeName](this)},toString:function(){var a={apply:function(a){var b=a.childNodes[0],c=a.childNodes.slice(1).map(function(a){return a+""}),d="";return b.nodeName==="plus"?d=c.join("+"):b.nodeName==="times"?d=c.join("*"):b.nodeName==="power"?d=c[0]+"^"+c[1]:d=b.nodeName+"("+c.join(", ")+")",d},bvar:function(){return""},ci:function(a){return a.innerMathML},cn:function(a){return a.innerMathML},cs:function(a){return a.innerMathML},domainofapplication:function(){return""},lambda:function(a){return a.childNodes.reduce(function(a,b){return a+(b+"")})},"#text":function(a){return a.innerMathML}};return a[this.nodeName](this)}};f.MathML=function(a){var b=new DOMParser,c,d;typeof a!="string"&&(a=a.toContentMathML()),a=a.replace(/\n/g,""),a=a.replace(/((?!cs)[^>]{2})>(\s)*</g,"$1><"),c=b.parseFromString(a,"application/xml");var e,f=null,i=[];e=function(a){var b={},c,d;if(a.attributes)for(c=0,d=a.attributes.length;c<d;c++)b[a.attributes[c].name]=a.attributes[c].value;var g=Object.create(k,{attributes:{value:b},nodeName:{value:a.nodeName},parentNode:{value:i[i.length-1]},prevNode:{value:f}});f&&(f.nextNode=g),f=g,i.push(g),g.childNodes=Array.prototype.slice.call(a.childNodes).map(e),i.pop();var h=function(a){var b="",c;for(c in a.attributes)a.attributes.hasOwnProperty(c)&&(b+=" "+c+'="'+a.attributes[c]+'"');return b};g.childNodes.length!==0?g.innerMathML=g.childNodes.reduce(function(a,b,c,d){return a+b.outerMathML},""):g.innerMathML="",g.childNodes.length===0?g.nodeName==="#text"?g.outerMathML=a.textContent:g.outerMathML="<"+g.nodeName+h(g)+"/>":g.outerMathML="<"+g.nodeName+h(g)+">"+g.innerMathML+"</"+g.nodeName+">";if(g.nodeName==="lambda"){g.bvars=[];for(c=0,d=g.childNodes.length;c<d;c++)g.childNodes[c].nodeName==="bvar"?g.bvars.push(g.childNodes[c].childNodes[0].innerMathML):g.childNodes[c].nodeName==="domainofapplication"?g.domainofapplication=g.childNodes[c]:g.childNodes[c].nodeName==="apply"&&(g.apply=g.childNodes[c])}return g},d=e(c.childNodes[0]),d[g]=h.MathML;var j=Object.create(h.MathML,{attributes:{value:d.attributes},childNodes:{value:d.childNodes},innerMathML:{value:d.innerMathML},outerMathML:{value:d.outerMathML},nodeName:{value:d.nodeName},nextNode:{value:d.nextNode},parentNode:{value:null},prevNode:{value:null}});return j},f.extendPrototype("MathML","constructor",f.MathML),f.extendPrototype("MathML","type","MathML"),f.extendPrototype("MathML","parse",function(){var a,b,c,d,e,g,h,i,j,k,l=!1,m=[];return a={apply:function(a){var b=a.childNodes,c=b.shift(),d=c.nodeName,e={ident:"identity",power:"pow",rem:"mod",setdifference:"without"};d in e&&(d=e[d]);if(l){var g;return g=i(b[0]),g===undefined?f.functn(function(a){return f[d](a)},{MathMLString:'<math xmlns="http://www.w3.org/1998/Math/MathML"><lambda><bvar><ci>x</ci></bvar><domainofapplication><complexes/></domainofapplication>'+a.outerMathML+"</lambda></math>"}):f.functn(function(a){return f[d](g(a))},{MathMLString:a.outerMathML})}if(d in f)return b.length===1?f[d](i(b[0])):f[d].apply(null,b.map(i));var h=i(b.shift());return b.length===1?h[d](i(b[0])):h[d](b.map(i))},ci:function(a){return m.indexOf(a.innerMathML)===-1?f.MathML.variables[a.innerMathML]:f.functn(function(a){return a},{MathMLString:'<math xmlns="http://www.w3.org/1998/Math/MathML"><lambda><bvar><ci>x</ci></bvar><domainofapplication><complexes/></domainofapplication><apply><ident/><ci>x</ci></apply></lambda></math>'})},cn:function(a){var b=a.attributes.type?a.attributes.type:"number";if(b==="number")return+a.innerMathML;if(b==="complex-cartesian")return f.complex([+a.childNodes[0].outerMathML,+a.childNodes[2].outerMathML]);if(b==="complex-polar")return f.complex(+a.childNodes[0].outerMathML,+a.childNodes[2].outerMathML)},cs:function(a){return a.innerMathML},lambda:function(a){var c,d,e,g,h;return m=m.concat(a.bvars),c=a.domainofapplication,b=a.apply,e=b.childNodes[0].nodeName,l=!0,h={ident:"identity",power:"pow",rem:"mod",setdifference:"without"},e in h&&(e=h[e]),g=i(b.childNodes.slice(1)),g[0]===undefined?f.functn(function(a){return f[e](a)},{MathMLString:a.outerMathML,domain:c}):f.functn(function(a){return f[e].apply(null,g.map(function(b){return typeof b=="function"?b(a):b}))},{MathMLString:a.outerMathML,domain:c})},math:function(a){return i(a.childNodes[0])},matrix:function(b){return f.matrix(b.childNodes.map(a.matrixrow))},matrixrow:function(a){return a.childNodes.map(i)},set:function(a){var b=a.attributes.type&&a.attributes.type==="multiset"?!0:!1;return f.set(a.childNodes.map(i),b)},"false":function(){return!1},"true":function(){return!0},exponentiale:function(){return f.e},imaginaryi:function(){return f.complex([0,1])},notanumber:function(){return NaN},pi:function(){return f.pi},eulergamma:function(){return f.eulerMascheroni},infinity:function(){return Infinity},vector:function(a){return f.vector(a.childNodes.map(i))}},i=function(b){return Array.isArray(b)?b.map(i):a[b.nodeName](b)},i(this)}),f.extendPrototype("MathML","toContentMathML",function(){return'<math xmlns="http://www.w3.org/1998/Math/MathML">'+this.childNodes[0].toMathML()+"</math>"}),f.extendPrototype("MathML","toMathML",function(){return'<math xmlns="http://www.w3.org/1998/Math/MathML">'+this.childNodes[0].toMathML()+"</math>"}),f.extendPrototype("MathML","toString",function(){return this.childNodes[0]+""}),f.extend("MathML","isSupported",function(){var b=!1,c,d,e;return a.createElementNS&&(c="http://www.w3.org/1998/Math/MathML",d=a.createElement("div"),d.style.position="absolute",e=d.appendChild(a.createElementNS(c,"math")).appendChild(a.createElementNS(c,"mfrac")),e.appendChild(a.createElementNS(c,"mi")).appendChild(a.createTextNode("xx")),e.appendChild(a.createElementNS(c,"mi")).appendChild(a.createTextNode("yy")),a.body.appendChild(d),b=d.offsetHeight>d.offsetWidth,a.body.removeChild(d)),b}),f.extend("MathML","loadMathJax",function(b){var c=a.createElement("script");c.type="text/javascript",c.src="http://cdn.mathjax.org/mathjax/latest/MathJax.js",b=b||'MathJax.Hub.Config({config: ["MMLorHTML.js"],jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML"],extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js"],TeX: {extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]}});',window.opera?c.innerHTML=b:c.text=b,a.getElementsByTagName("head")[0].appendChild(c)}),f.extend("MathML","variables",{}),f.extend("MathML","write",function(b,c){var d;a.getElementById(b).innerHTML="<math>"+c+"</math>",typeof MathJax!="undefined"&&(d=MathJax.Hub.getAllJax(b)[0],MathJax.Hub.Queue(["Typeset",MathJax.Hub,b]))}),h.functn=function(){},f.functn=function(a,c){var d=function(c){if(typeof c=="number")return a.apply("",arguments);if(c.type==="functn"){var e=d.MathML.childNodes[0].childNodes[0].childNodes[0].outerMathML,g=c.MathML.childNodes[0].childNodes[0].childNodes[0].outerMathML,h=c.MathML.childNodes[0].childNodes[2].outerMathML.replace("<bvar>"+g+"</bvar>",""),i=d.MathML.childNodes[0].childNodes[2].outerMathML.replace(e,h),j='<math xmlns="http://www.w3.org/1998/Math/MathML"><lambda><bvar>'+g+"</bvar><domainofapplication><complexes/></domainofapplication>"+i+"</lambda></math>";return f.functn(function(b){return a(c(b))},{MathMLString:j})}return typeof c=="function"?function(b){return a(c(b))}:c.type==="set"?f.set(c.map(a)):c.type==="complex"?c[a.name].apply(c,Array.prototype.slice.call(arguments,1)):Array.isArray(c)?c.map(a):c[b]()};d[g]=h.functn,c=c||{};var e=c.MathMLString||"";return Object.defineProperties(d,{id:{value:a.name},MathML:{value:f.MathML(e)}}),d},f.extendPrototype("functn","constructor",f.functn),f.extendPrototype("functn","type","functn"),f.extendPrototype("functn","draw",function(a,b){var c=[],d;for(d=-50;d<=50;d=Math.round((d+.01)*100)/100)c.push([d,this(d)]);return Array.isArray(a)?a.forEach(function(a){a.path(c,b)}):a.path(c,b),this}),f.extendPrototype("functn","toContentMathML",function(){return this.MathML.outerMathML}),f.extendPrototype("functn","toMathML",function(){return this.MathML.toMathML()}),f.extendPrototype("functn","toString",function(){return this.MathML+""});var l='<math xmlns="http://www.w3.org/1998/Math/MathML"><lambda><bvar><ci>x</ci></bvar><domainofapplication><complexes/></domainofapplication><apply><',m="/><ci>x</ci></apply></lambda></math>",n={abs:function(b){return Math.abs(b)},arccos:function(b){return Math.acos(b)},arccot:function(b){return f.pi/2-Math.atan(b)},arccsc:function(b){return Math.asin(1/b)},arcosh:function(b){return Math.log(b+Math.sqrt(b*b-1))},arcoth:function(b){return.5*Math.log((b+1)/(b-1))},arcsch:function(b){return Math.log((1+Math.sqrt(1+b*b))/b)},arcsec:function(b){return Math.acos(1/b)},arcsin:function(b){return Math.asin(b)},arctan:function(b){return Math.atan(b)},arsech:function(b){return Math.log((1+Math.sqrt(1-b*b))/b)},arsinh:function(b){return Math.log(b+Math.sqrt(b*b+1))},artanh:function(b){return.5*Math.log((1+b)/(1-b))},ceil:function(b){return Math.ceil(b)},floor:function(b){return Math.floor(b)},cos:function(b){return Math.cos(b)},cosh:function(b){return(Math.exp(b)+Math.exp(-b))/2},cot:function(b){return 1/Math.tan(b)},coth:function(b){return(Math.exp(b)+Math.exp(-b))/(Math.exp(b)-Math.exp(-b))},csc:function(b){return 1/Math.sin(b)},csch:function(b){return 2/(Math.exp(b)-Math.exp(-b))},exp:function(b){return Math.exp(b)},inverse:function(b){return 1/b},sec:function(a){return 1/Math.cos(a)},sech:function(a){return 2/(Math.exp(a)+Math.exp(-a))},sin:function(b){return Math.sin(b)},sinh:function(b){return(Math.exp(b)-Math.exp(-b))/2},tan:function(a){return Math.tan(a)},tanh:Math.tanh||function(a){return(Math.exp(a)-Math.exp(-a))/(Math.exp(a)+Math.exp(-a))}};for(var o in n)n.hasOwnProperty(o)&&f.extend("",o,f.functn(n[o],{MathMLString:l+o+m}));f.identity=f.functn(function(b){return b},{MathMLString:l+"ident"+m});var p={binomial:function(a,b){var c=1,d;if(b<0||a>0&&b>a)return 0;a<0&&(c=Math.pow(-1,b),a=b-a-1),b>a/2&&(b=a-b);for(d=1;d<=b;d++)c*=(a+1-d)/d;return c},cbrt:function(a){var b,c,d,e;if(a===0||a!==a||a===Infinity||a===-Infinity)return a;e=f.sgn(a)*Math.pow(Math.abs(a),1/3);for(;;){b=Math.pow(e,3),c=b+a,d=e*(c+a)/(c+b);if(f.isZero(d-e))break;e=d}return d},conjugate:function(a){return a},copy:function(a){return a},degToRad:function(a){return a/180*f.pi},digitproduct:function(a){var b=1;while(a>9)b*=a%10,a=Math.floor(a/10);return b*a},digitsum:function(a){var b=0;while(a>9)b+=a%10,a=Math.floor(a/10);return b+a},divide:function(a,b){return f.times(a,f.inverse(b))},divisors:function(a){var b=a===1?[]:[1],c,d;for(c=2,d=a/2;c<=d;c++)a%c===0&&b.push(c);return b.push(a),f.set(b)},factor:function(a){var b=[],c;a=Math.abs(a);while(a%2===0)a/=2,b.push(2);c=3;while(a!==1){while(a%c===0)a/=c,b.push(c);c+=2}return f.set(b,!0)},factorial:function(a){var b=1,c;for(c=1;c<=a;c+=1)b*=c;return b},fallingFactorial:function(a,b,c){var d=1,e;c=c||1;for(e=0;e<b;e++)d*=a-e*c;return d},fibonacci:function(a){return Math.floor(Math.pow(f.goldenRatio,a)/Math.sqrt(5))},hypot:function(a,b){var c,d,e;return arguments.length===1?Math.abs(a):(arguments.length>2&&(c=Array.prototype.slice.call(arguments),c.shift(),b=f.hypot.apply(null,c)),a=f.abs(a),b=f.abs(b),a===Infinity||b===Infinity?Infinity:(d=Math.max(a,b),e=Math.min(a,b),d*Math.sqrt(1+Math.pow(e/d,2))))},hypot2:function(){var a=Array.prototype.slice.call(arguments);return a.some(function(a){return a===Infinity||a===-Infinity})?Infinity:a.reduce(function(a,b){return a+b*b},0)},isFinite:function(a){return Math.abs(a)<Infinity},isInt:function(a){return a%1===0},isNaN:function(a){return a!==a},isNegZero:function(a){return 1/a===-Infinity},isOne:function(a){return Math.abs(a-1)<f.epsilon},isPosZero:function(a){return 1/a===Infinity},isPrime:function(a){var b=Math.sqrt(a),c;if(a%1===0&&a>1){if(a===2)return!0;if(a%2===0)return!1;for(c=3;c<=b;c+=2)if(a%c===0)return!1;return!0}return!1},isReal:function(a){return!0},isZero:function(a){return Math.abs(a)<f.epsilon},lg:function(a){return Math.log(a)/Math.ln10},ln:Math.log,log:function(a,b){return arguments.length===1&&(b=a,a=10),Math.log(b)/Math.log(a)},minus:function(a,b){return f.plus(a,f.negative(b))},mod:function(a,b){var c=a%b;return c<0?c+b:c},negative:function(a){return-a},pow:function(a,b){return a===1||a===-1&&(b===Infinity||b===-Infinity)?1:Math.pow(a,b)},radToDeg:function(a){return a*180/Math.PI},random:Math.random,risingFactorial:function(a,b,c){var d=1,e;c=c||1;for(e=0;e<b;e++)d*=a+e*c;return d},round:function(a,b){return arguments.length===1?Math.round(a):Math.round(a*Math.pow(10,b))/Math.pow(10,b)},root:function(a,b){return arguments.length===1?Math.sqrt(a):Math.pow(a,1/b)},sgn:function(a){return a>0?1:a<0?-1:0},sqrt:function(a){return a===0?0:Math.sqrt(a)},trunc:function(a,b){return a.toFixed(b||0)},toLaTeX:function(a,b){return b?(a<0?"-":"+")+Math.abs(a):(a<0?"-":"")+Math.abs(a)},toMathML:function(a,b){return b?"<mo>"+(a<0?"-":"+")+"</mo><mn>"+Math.abs(a)+"</mn>":(a<0?"<mo>-</mo>":"")+"<mn>"+Math.abs(a)+"</mn>"},toString:function(a,b){return b?(a<0?"-":"+")+Math.abs(a):(a<0?"-":"")+Math.abs(a)}};f.toContentMathML=function(a){return typeof a=="number"?"<cn>"+a+"</cn>":a.toContentMathML()},f.and=function(){return Array.prototype.slice.call(arguments).every(function(a){return!!a})},f.or=function(){return Array.prototype.slice.call(arguments).some(function(a){return!!a})},f.xor=function(){return Array.prototype.slice.call(arguments).reduce(function(a,b){return a+b})%2!==0},f.not=function(a){return!a},f.compare=function(a,b){return f.type(a)!==f.type(b)?f.sgn(f.type(a).localeCompare(f.type(b))):typeof a=="number"?f.sgn(a-b):typeof a=="string"?a.localeCompare(b):a.compare(b)},f.type=function(a){return a.type?a.type:Object.prototype.toString.call(a).slice(8,-1).toLowerCase()},f.is=function(a,b){return h[b]?h[b].isPrototypeOf(a):typeof a===b};var q={arithMean:function(){return f.plus.apply(null,this)/this.length},gcd:function(){var a,b=this,c=function(b){return b!==a?b%a:b},d=function(a){return a!==0};b=b.filter(function(a){return a<0?(b.push(-a),!1):a!==0});while(b.length>1)a=f.min(b),b=b.map(c).filter(d);return b[0]||a},geoMean:function(){return f.root(f.times.apply(null,this),this.length)},harmonicMean:function(){return this.length/f.plus.apply(null,Array.prototype.map.call(this,f.inverse))},lcm:function(){return f.times(this)/f.gcd(this)},max:function(a){return a?this.sort(f.compare)[this.length-a]:Math.max.apply("Array",this)},min:function(a){return a?this.sort(f.compare)[a-1]:Math.min.apply("Array",this)}};f.plus=function(){return Array.prototype.slice.apply(arguments).reduce(function(a,b){var c,d,e,g;if(typeof a=="number"&&typeof b=="number")return a+b;if(a.type==="functn"||b.type==="functn"){e=a.type==="functn"?a.MathML.childNodes[0].apply.outerMathML:f.toContentMathML(a),g=b.type==="functn"?b.MathML.childNodes[0].apply.outerMathML:f.toContentMathML(b),c=a,d=b,a.type!=="functn"?c=function(){return a}:b.type!=="functn"&&(d=function(){return b});var h='<math xmlns="http://www.w3.org/1998/Math/MathML"><lambda><bvar><ci>x</ci></bvar><domainofapplication><complexes/></domainofapplication><apply><plus/>'+e+g+"</apply></lambda></math>";return f.functn(function(a){return f.plus(c(a),d(a))},{MathMLString:h})}if(typeof a=="object")return a.plus(b);if(typeof b=="object")return b.plus(a)})},f.isEqual=function(){return i(j.apply(arguments)).every(function(a,b,c){return a===c[0]?!0:typeof a=="number"&&typeof c[0]=="number"?Math.abs(a-c[0])<=3e-15:typeof a=="object"?a.isEqual(c[0]):typeof c[0]=="object"?c[0].isEqual(a):!1})},f.times=function(){return Array.prototype.slice.apply(arguments).reduce(function(a,b){var c,d,e,g;if(typeof a=="number"&&typeof b=="number")return a*b;if(a.type==="functn"||b.type==="functn"){e=a.type==="functn"?a.MathML.childNodes[0].apply.outerMathML:f.toContentMathML(a),g=b.type==="functn"?b.MathML.childNodes[0].apply.outerMathML:f.toContentMathML(b),c=a,d=b,a.type!=="functn"?c=function(){return a}:b.type!=="functn"&&(d=function(){return b});var h='<math xmlns="http://www.w3.org/1998/Math/MathML"><lambda><bvar><ci>x</ci></bvar><domainofapplication><complexes/></domainofapplication><apply><times/>'+e+g+"</apply></lambda></math>";return f.functn(function(a){return f.times(c(a),d(a))},{MathMLString:h})}if(typeof a=="object")return a.times(b);if(typeof b=="object")return b.times(a)})};var r=function(a,b){return function(c){return typeof c=="number"?a.apply("",arguments):typeof c=="function"?function(b){return a(c(b))}:c.type==="set"?f.set(c.map(a)):c.type==="complex"?c[b].apply(c,Array.prototype.slice.call(arguments,1)):Array.isArray(c)?c.map(a):c[b]()}},s=function(a,b){return function(){var b=Array.prototype.slice.call(arguments),c=b.shift();return a.apply(c,b)}},t,u;for(t in p)p.hasOwnProperty(t)&&(u=p[t],Object.defineProperty(f,t,{value:r(p[t],t)}));h.set=[];for(t in q)q.hasOwnProperty(t)&&(u=q[t],Object.defineProperty(f,t,{value:s(q[t],t)}),f.extendPrototype("set",t,function(a){return function(b){return f[a](this,b)}}(t)));h.screen={},f.screen=function(b,c){if(arguments.length===0)return Object.create(h.screen,{});var d=a.getElementById(b),e=Object.create(h.screen),g,i={axisType:"in",axisColor:"black",axisLineWidth:.05,background:"white",down:-5,drag:!1,fillColor:"rgba(0,255,0,0.1)",fillLeft:-5,fillRight:5,fontSize:10,gridAngle:Math.PI/6,gridColor:"#cccccc",gridLineWidth:.05,gridType:"cartesian",height:parseInt(d.getAttribute("height"),10),label:!0,labelColor:"black",labelFont:"Helvetica",labelFontSize:"16px",left:-5,pan:!0,plotColor:"blue",plotLineWidth:.05,right:5,stepSizeX:1,stepSizeY:1,state:"",up:5,width:parseInt(d.getAttribute("width"),10),zoom:!0,zoomSpeed:.2};for(var j in c)c.hasOwnProperty(j)&&(i[j]=c[j]);i.id=b,i.element=d,i.type=d.localName;for(var k in i)i.hasOwnProperty(k)&&Object.defineProperty(e,k,{value:i[k],enumerable:!0,writable:!0});var l=f.matrix([[e.width/((e.right-e.left)*e.stepSizeX),0,e.width/2],[0,-e.height/((e.up-e.down)*e.stepSizeY),e.height/2],[0,0,1]]);Object.defineProperty(e,"curTransformation",{get:function(){return l},set:function(a){l=a,e.applyTransformation()}}),Object.defineProperty(e,"origTransformation",{value:f.matrix([[e.width/((e.right-e.left)*e.stepSizeX),0,e.width/2],[0,-e.height/((e.up-e.down)*e.stepSizeY),e.height/2],[0,0,1]])}),Object.defineProperty(e,"curTranslateX",{get:function(){return e.curTransformation[0][2]},set:function(a){e.curTransformation[0][2]=a,e.applyTransformation()}}),Object.defineProperty(e,"curTranslateY",{get:function(){return e.curTransformation[1][2]},set:function(a){e.curTransformation[1][2]=a,e.applyTransformation()}}),Object.defineProperty(e,"origTranslateX",{get:function(){return e.origTransformation[0][2]},set:function(a){e.origTransformation[0][2]=a}}),Object.defineProperty(e,"origTranslateY",{get:function(){return e.origTransformation[1][2]},set:function(a){e.origTransformation[1][2]=a}}),Object.defineProperty(e,"curZoomX",{get:function(){return e.curTransformation[0][0]},set:function(a){e.curTransformation[0][0]=a,e.applyTransformation()}}),Object.defineProperty(e,"curZoomY",{get:function(){return e.curTransformation[1][1]},set:function(a){e.curTransformation[1][1]=a,e.applyTransformation()}}),Object.defineProperty(e,"origZoomX",{get:function(){return e.origTransformation[0][0]},set:function(a){e.origTransformation[0][0]=a}}),Object.defineProperty(e,"origZoomY",{get:function(){return e.origTransformation[1][1]},set:function(a){i.origTransformation[1][1]=a}}),e.screenWrapper=a.createElement("div"),e.screenWrapper.className="MathLib screenWrapper",d.parentNode.insertBefore(e.screenWrapper,d),e.screenWrapper.appendChild(d),e.contextmenuWrapper=a.createElement("div"),e.contextmenuWrapper.className="MathLib contextmenuWrapper",e.screenWrapper.appendChild(e.contextmenuWrapper),g=a.createElement("ul"),g.className="MathLib contextmenu",e.contextmenuWrapper.appendChild(g);var m=a.createElement("li");m.className="MathLib menuitem",m.innerHTML='<span>Position</span><span style="float: right; padding-right: 10px">❯</span>',m.onclick=function(){e.contextmenuWrapper.style.setProperty("display","none")},g.appendChild(m);var n=a.createElement("ul");n.className="MathLib contextmenu submenu",m.appendChild(n);var o=a.createElement("li");o.className="MathLib menuitem",o.onclick=function(){e.contextmenuWrapper.style.setProperty("display","none")},n.appendChild(o);var p=a.createElement("li");p.className="MathLib menuitem",p.onclick=function(){e.contextmenuWrapper.style.setProperty("display","none")},n.appendChild(p);var q=a.createElement("li");q.className="MathLib menuitem",q.innerHTML="Reset View",q.onclick=function(){e.resetView(),e.contextmenuWrapper.style.setProperty("display","none")},g.appendChild(q);if(a.webkitCancelFullScreen){var r=a.createElement("li");r.className="MathLib menuitem",r.innerHTML="View full screen",r.onclick=function(b){a.fullScreenElement&&a.fullScreenElement!==null||!a.mozFullScreen&&!a.webkitIsFullScreen?e.enterFullscreen():e.exitFullscreen(),e.contextmenuWrapper.style.setProperty("display","none")},g.appendChild(r);var s=function(b){a.fullScreenElement&&a.fullScreenElement!==null||!a.mozFullScreen&&!a.webkitIsFullScreen?(r.innerHTML="View Fullscreen",e.resize(e.width,e.height),e.curTranslateX=e.origTranslateX,e.curTranslateY=e.origTranslateY,e.redraw()):(r.innerHTML="Exit Fullscreen",e.resize(window.outerWidth,window.outerHeight),e.curTranslateX=window.outerWidth/2,e.curTranslateY=window.outerHeight/2,e.redraw())};a.webkitCancelFullScreen?e.screenWrapper.addEventListener("webkitfullscreenchange",s,!1):a.mozCancelFullScreen&&e.screenWrapper.addEventListener("mozfullscreenchange",s,!1)}return e},f.extendPrototype("screen","axis",function(a){var b,c,d,e;arguments.length===0||b===!0?(d={lineColor:this.axisColor,fillColor:"rgba(255, 255, 255, 0)",layer:"back",lineWidth:this.axisLineWidth},e={color:this.labelColor,layer:"back",font:this.labelFont,fontSize:this.labelFontSize},b=this.axisType):b!==!1&&(d={lineColor:a.color||this.axisColor,fillColor:"rgba(255, 255, 255, 0)",layer:"back",lineWidth:a.lineWidth||this.axisLineWidth},e={color:a.textColor||this.labelColor,layer:"back",font:a.font||this.labelFont,fontSize:a.font||this.labelFontSize},b=a.type||this.axisType,this.axisColor=d.lineColor,this.axisLineWidth=d.lineWidth,this.axisType=b,this.labelColor=e.color,this.labelFont=e.font,this.labelFontSize=e.fontSize);if(b==="in"){var f=10/this.origZoomX,g=10/this.origZoomY;this.line([[-50,0],[50,0]],d),this.line([[0,-50],[0,50]],d);for(c=this.stepSizeX;c<=50*this.stepSizeX;c+=this.stepSizeX)this.line([[c,-g],[c,g]],d);for(c=-this.stepSizeX;c>=-50*this.stepSizeX;c-=this.stepSizeX)this.line([[c,-g],[c,g]],d);for(c=this.stepSizeY;c<=50*this.stepSizeY;c+=this.stepSizeY)this.line([[-f,c],[f,c]],d);for(c=-this.stepSizeY;c>=-50*this.stepSizeY;c-=this.stepSizeY)this.line([[-f,c],[f,c]],d);if(this.label){for(c=this.stepSizeX;c<=50*this.stepSizeX;c+=this.stepSizeX)this.text(c+"",c-f/2,-2.5*g,e);for(c=-this.stepSizeX;c>=-50*this.stepSizeX;c-=this.stepSizeX)this.text(c+"",c-f/2,-2.5*g,e);for(c=this.stepSizeY;c<=50*this.stepSizeY;c+=this.stepSizeY)this.text(c+"",-2.5*f,c-g/2,e);for(c=-this.stepSizeY;c>=-50*this.stepSizeY;c-=this.stepSizeY)this.text(c+"",-2.5*f,c-g/2,e)}else b!=="out"}return this}),f.extendPrototype("screen","contextmenu",function(a){a.preventDefault&&a.preventDefault(),a.returnValue=!1;var b=this.getX(a),c=this.getY(a),d=this.contextmenuWrapper.childNodes[0];d.style.setProperty("top",a.clientY-20+"px"),d.style.setProperty("left",a.clientX+"px");var e=this.contextmenuWrapper;e.style.setProperty("display","block"),e.style.setProperty("width","100%"),e.style.setProperty("height","100%"),d.childNodes[0].childNodes[2].childNodes[0].innerHTML="cartesian: ("+f.round(b,2)+", "+f.round(c,2)+")",d.childNodes[0].childNodes[2].childNodes[1].innerHTML="polar: ("+f.round(f.hypot(b,c),2)+", "+f.round(Math.atan2(c,b),2)+")";var g=this,h=function(){g.contextmenuWrapper.style.setProperty("display","none"),e.style.setProperty("width","0px"),e.style.setProperty("height","0px"),g.contextmenuWrapper.removeEventListener("click",h)};this.contextmenuWrapper.addEventListener("click",h)}),f.extendPrototype("screen","enterFullscreen",function(){var a=this.screenWrapper;return a.requestFullScreen?a.requestFullScreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullScreen&&a.webkitRequestFullScreen(),this}),f.extendPrototype("screen","exitFullscreen",function(){return a.cancelFullScreen?a.cancelFullScreen():a.mozCancelFullScreen?a.mozCancelFullScreen():a.webkitCancelFullScreen&&a.webkitCancelFullScreen(),this}),f.extendPrototype("screen","getEventPoint",function(a){var b,c;return a.offsetX?(b=a.offsetX,c=a.offsetY):(b=a.layerX,c=a.layerY),f.point([b,c,1])}),f.extendPrototype("screen","getX",function(a){var b;return a.offsetX?b=a.offsetX:b=a.layerX,(b-this.curTranslateX)/this.curZoomX}),f.extendPrototype("screen","getY",function(a){var b;return a.offsetY?b=a.offsetY:b=a.layerY,(b-this.curTranslateY)/this.curZoomY}),f.extendPrototype("screen","grid",function(a){var b,c,d,e;arguments.length===0||c===!0?(e={lineColor:this.gridColor,fillColor:"rgba(255, 255, 255, 0)",layer:"back",lineWidth:this.gridLineWidth},c=this.gridType,b=this.gridAngle):c!==!1&&(e={lineColor:a.color||this.gridColor,fillColor:"rgba(255, 255, 255, 0)",layer:"back",lineWidth:a.lineWidth||this.gridLineWidth},c=a.type||this.gridType,b=a.angle||this.gridAngle,this.girdColor=e.lineColor,this.gridLineWidth=e.lineWidth,this.gridType=c,this.gridAngle=b);if(c==="cartesian"){for(d=-50;d<=50;d+=this.stepSizeX)this.line([[d,-50],[d,50]],e);for(d=-50;d<=50;d+=this.stepSizeY)this.line([[-50,d],[50,d]],e)}else if(c==="polar"){for(d=0;d<2*Math.PI;d+=b)this.line([[0,0],[50*Math.cos(d),50*Math.sin(d)]],e);for(d=1;d<60;d+=1)this.circle(f.circle([0,0,1],d),e)}return this}),f.extendPrototype("screen","lineEndPoints",function(a){if(a.type==="line"){var b=-(a[2]+a[0]*50)/a[1],c=-(a[2]+a[1]*50)/a[0],d=-(a[2]+a[0]*-50)/a[1],e=-(a[2]+a[1]*-50)/a[0],f=[];return b<50&&b>-50&&f.push([50,b]),d<50&&d>-50&&f.push([-50,d]),c<50&&c>-50&&f.push([c,50]),e<50&&e>-50&&f.push([e,-50]),f}return a}),f.extendPrototype("screen","onmousedown",function(a){if(a.button!==0)return;a.preventDefault&&a.preventDefault(),a.returnValue=!1;if(a.target.tagName==="canvas"||a.target.tagName==="svg"||!this.drag)this.interaction="pan",this.startPoint=this.getEventPoint(a),this.startTransformation=this.curTransformation.copy()}),f.extendPrototype("screen","onmousemove",function(a){var b;a.preventDefault&&a.preventDefault(),a.returnValue=!1,this.interaction==="pan"&&this.pan&&(b=this.getEventPoint(a).minus(this.startPoint),this.curTranslateX=this.startTransformation[0][2]+b[0],this.curTranslateY=this.startTransformation[1][2]+b[1],this.redraw())}),f.extendPrototype("screen","onmouseup",function(a){a.preventDefault&&a.preventDefault(),a.returnValue=!1;if(this.interaction==="pan"||this.interaction==="drag")this.interaction=""}),f.extendPrototype("screen","onmousewheel",function(a){var b,c,d,e;if(!this.zoom)return;a.preventDefault&&a.preventDefault(),a.returnValue=!1,a.wheelDelta?b=a.wheelDelta/360:b=a.detail/-9,e=Math.pow(1+this.zoomSpeed,b),d=this.curTransformation.inverse().times(this.getEventPoint(a)),c=f.matrix([[e,0,d[0]-d[0]*e],[0,e,d[1]-d[1]*e],[0,0,1]]),this.curTransformation=this.curTransformation.times(c),this.redraw(),typeof this.startTransformation=="undefined"&&
(this.startTransformation=this.curTransformation.inverse()),this.startTransformation=this.startTransformation.times(c.inverse())}),h.canvas=f.screen(),f.canvas=function(b){var c=f.screen(b);c[g]=h.canvas,Object.defineProperty(c,"drawingStack",{value:[]});var d=a.createElement("div");d.style.setProperty("width","100%"),d.style.setProperty("height","100%"),d.style.setProperty("position","relative"),c.element.parentNode.insertBefore(d,c.element.wrapperDiv);var e=a.createElement("canvas");e.setAttribute("width",c.width+"px"),e.setAttribute("height",c.height+"px"),e.classList.add("MathLib-backLayer"),e.classList.add("MathLib-canvas"),c.backLayer={ctx:e.getContext("2d"),element:e},d.appendChild(e),c.mainLayer={ctx:a.getElementById(b).getContext("2d"),element:a.getElementById(b)},d.appendChild(c.mainLayer.element);var i=a.createElement("canvas");i.setAttribute("width",c.width+"px"),i.setAttribute("height",c.height+"px"),i.classList.add("MathLib-frontLayer"),i.classList.add("MathLib-canvas"),c.frontLayer={ctx:i.getContext("2d"),element:i},d.appendChild(i);var j=[c.mainLayer,c.backLayer,c.frontLayer];return j.forEach(function(a){a.ctx.save(),a.ctx.transform(c.curZoomX,0,0,c.curZoomY,c.curTranslateX,c.curTranslateY),a.element.style.setProperty("position","absolute"),a.element.style.setProperty("left","0px"),a.element.style.setProperty("top","0px")}),c.frontLayer.element.onselectstart=function(){return!1},c.frontLayer.element.onmousedown=function(a){c.onmousedown(a)},c.frontLayer.element.oncontextmenu=function(a){c.oncontextmenu(a)},c.frontLayer.element.onmousemove=function(a){c.onmousemove(a)},c.frontLayer.element.onmouseup=function(a){c.onmouseup(a)},"onmousewheel"in c.frontLayer.element?c.frontLayer.element.onmousewheel=function(a){c.onmousewheel(a)}:c.frontLayer.element.DOMMouseScroll=function(a){c.onmousewheel(a)},c},f.extendPrototype("canvas","applyTransformation",function(){this.clearLayer("back","main","front");var a=this.curTransformation;return this.backLayer.ctx.setTransform(a[0][0],a[1][0],a[0][1],a[1][1],a[0][2],a[1][2]),this.mainLayer.ctx.setTransform(a[0][0],a[1][0],a[0][1],a[1][1],a[0][2],a[1][2]),this.frontLayer.ctx.setTransform(a[0][0],a[1][0],a[0][1],a[1][1],a[0][2],a[1][2]),this}),f.extendPrototype("canvas","circle",function(a,b){var c={fillColor:"rgba(0, 0, 255, 0.05)",lineColor:"rgba(0, 0, 255, 1)",lineWidth:.05,dash:[],dashOffset:0},d,e,f;b=b||{},"layer"in b?d=this[b.layer+"Layer"].ctx:d=this.mainLayer.ctx,b.redraw?f=b:f=this.normalizeOptions(c,b);for(e in f)f.hasOwnProperty(e)&&(d[e]=f[e]);return d.beginPath(),d.arc(a.center[0],a.center[1],a.radius,0,2*Math.PI),d.closePath(),d.fill(),d.stroke(),d===this.mainLayer.ctx&&!f.redraw&&(f.redraw=!0,this.drawingStack.push({object:a,options:f,type:"circle"})),this}),f.extendPrototype("canvas","clearLayer",function(){var a=this,b=this.curTransformation.inverse().times(f.point(this.element.width,0)),c=this.curTransformation.inverse().times(f.point(0,this.element.height));return Array.prototype.forEach.call(arguments,function(d){a[d+"Layer"].ctx.clearRect(b[0],b[1],c[0]-b[0],c[1]-b[1])}),this}),f.extendPrototype("canvas","line",function(a,b){var c={fillColor:"rgba(0, 0, 0, 0)",lineColor:"rgba(0, 0, 0, 1)",lineWidth:.05,dash:[],dashOffset:0},d=this.lineEndPoints(a),e,f,g;b=b||{},"layer"in b?e=this[b.layer+"Layer"].ctx:e=this.mainLayer.ctx,b.redraw?g=b:g=this.normalizeOptions(c,b);for(f in g)g.hasOwnProperty(f)&&(e[f]=g[f]);return e.beginPath(),e.moveTo(d[0][0],d[0][1]),e.lineTo(d[1][0],d[1][1]),e.stroke(),e.closePath(),e===this.mainLayer.ctx&&!g.redraw&&(g.redraw=!0,this.drawingStack.push({object:a,options:g,type:"line"})),this}),f.extendPrototype("canvas","oncontextmenu",function(a){this.contextmenu(a)}),f.extendPrototype("canvas","normalizeOptions",function(a,b){return{fillStyle:b.fillColor||b.color||a.fillColor||a.color,lineWidth:b.lineWidth||a.lineWidth,font:b.font||a.font,fontSize:b.fontSize||a.fontSize,size:b.size||a.size,mozDash:b.dash||a.dash,mozDashOffset:b.dashOffset||a.dashOffset,strokeStyle:b.lineColor||b.color||a.lineColor||a.color,webkitLineDash:b.dash||a.dash,webkitLineDashOffset:b.dashOffset||a.dashOffset}}),f.extendPrototype("canvas","path",function(a,b){var c={fillColor:"rgba(0, 0, 0, 0)",lineColor:"rgba(0, 0, 255, 1)",lineWidth:.05,dash:[],dashOffset:0},d,e,f;b=b||{},"layer"in b?d=this[b.layer+"Layer"].ctx:d=this.mainLayer.ctx,b.redraw?f=b:f=this.normalizeOptions(c,b);for(e in f)f.hasOwnProperty(e)&&(d[e]=f[e]);return d.beginPath(),d.moveTo(a[0][0],a[0][1]),a.forEach(function(a){d.lineTo(a[0],a[1])}),d.stroke(),d.closePath(),d===this.mainLayer.ctx&&!f.redraw&&(f.redraw=!0,this.drawingStack.push({object:a,options:f,type:"path"})),this}),f.extendPrototype("canvas","point",function(a,b){var c={fillColor:"rgba(0, 0, 0, 1)",lineColor:"rgba(0, 0, 0, 1)",lineWidth:.05,dash:[],dashOffset:0},d,e,f;b=b||{},"layer"in b?d=this[b.layer+"Layer"].ctx:d=this.mainLayer.ctx,b.redraw?f=b:f=this.normalizeOptions(c,b);for(e in f)f.hasOwnProperty(e)&&(d[e]=f[e]);return d.beginPath(),d.arc(a[0]/a[2],a[1]/a[2],.05,0,2*Math.PI),d.closePath(),d.stroke(),d.fill(),d===this.mainLayer.ctx&&!f.redraw&&(f.redraw=!0,this.drawingStack.push({object:a,options:f,type:"point"})),this}),f.extendPrototype("canvas","redraw",function(){var a=this;return this.clearLayer("back","main","front"),this.grid(),this.axis(),this.drawingStack.forEach(function(b,c){a[b.type](b.object,b.options)}),this}),f.extendPrototype("canvas","resetView",function(){return this.curTransformation=this.origTransformation,this.redraw(),this}),f.extendPrototype("canvas","resize",function(a,b){return[this.backLayer,this.mainLayer,this.frontLayer].forEach(function(c){c.element.setAttribute("width",a+"px"),c.element.setAttribute("height",b+"px")}),this}),f.extendPrototype("canvas","text",function(a,b,c,d){var e={font:"Helvetica",fontSize:"16px",fillColor:"rgba(0, 0, 0, 1)",lineColor:"rgba(0, 0, 0, 1)",lineWidth:.05,dash:[],dashOffset:0,size:.4},f,g,h;d=d||{},"layer"in d?f=this[d.layer+"Layer"].ctx:f=this.mainLayer.ctx,d.redraw?h=d:h=this.normalizeOptions(e,d);for(g in h)h.hasOwnProperty(g)&&(f[g]=h[g]);return f.font=h.fontSize+" "+h.font,f.save(),f.transform(1/this.origZoomX,0,0,1/this.origZoomY,0,0),f.fillText(a,b*this.origZoomX,-c*this.origZoomY),f.restore(),f===this.mainLayer.ctx&&!h.redraw&&(h.redraw=!0,this.drawingStack.push({object:a,options:h,type:"text"})),this}),h.svg=f.screen(),f.svg=function(b){var c=a.getElementById(b),d=f.screen(b);d[g]=h.svg;var e=a.createElementNS("http://www.w3.org/2000/svg","g");e.setAttributeNS(null,"transform","matrix("+d.curZoomX+",0, 0,"+d.curZoomY+", "+d.width/2+", "+d.height/2+")"),c.appendChild(e),d.ctx=e;var i=a.createElementNS("http://www.w3.org/2000/svg","g");i.className.baseVal+=" MathLib-backLayer ",e.appendChild(i),d.backLayer={element:i};var j=a.createElementNS("http://www.w3.org/2000/svg","g");j.className.baseVal+=" MathLib-mainLayer ",e.appendChild(j),d.mainLayer={element:j};var k=a.createElementNS("http://www.w3.org/2000/svg","g");return k.className.baseVal+=" MathLib-frontLayer ",e.appendChild(k),d.frontLayer={element:k},c.onselectstart=function(){return!1},c.onmousedown=function(a){d.onmousedown(a)},c.oncontextmenu=function(a){d.oncontextmenu(a)},c.onmousemove=function(a){d.onmousemove(a)},c.onmouseup=function(a){d.onmouseup(a)},"onmousewheel"in c?c.onmousewheel=function(a){d.onmousewheel(a)}:c.DOMMouseScroll=function(a){d.onmousewheel(a)},d},f.extendPrototype("svg","applyTransformation",function(){var a=this.curTransformation;return this.ctx.setAttribute("transform","matrix("+a[0][0]+","+a[1][0]+","+a[0][1]+","+a[1][1]+","+a[0][2]+","+a[1][2]+")"),this}),f.extendPrototype("svg","circle",function(b,c){var d=a.createElementNS("http://www.w3.org/2000/svg","circle"),e={fillColor:"rgba(0, 0, 255, 0.05)",lineColor:"rgba(0, 0, 255, 1)",lineWidth:"0.05"},f,g,h;c=c||{},"layer"in c?f=this[c.layer+"Layer"]:f=this.mainLayer,h=this.normalizeOptions(e,c);for(g in h)h.hasOwnProperty(g)&&d.setAttributeNS(null,g,h[g]);return d.setAttributeNS(null,"cx",b.center[0]/b.center[2]),d.setAttributeNS(null,"cy",b.center[1]/b.center[2]),d.setAttributeNS(null,"r",b.radius),f.element.appendChild(d),this}),f.extendPrototype("svg","clearLayer",function(){var a=this;return Array.prototype.forEach.call(arguments,function(b){b=a[b+"Layer"].element;while(b.hasChildNodes())b.removeChild(b.firstChild)}),this}),f.extendPrototype("svg","line",function(b,c){var d=a.createElementNS("http://www.w3.org/2000/svg","line"),e=this.lineEndPoints(b),f={lineColor:"rgba(0, 0, 0, 1)",lineWidth:"0.05"},g,h,i;c=c||{},"layer"in c?g=this[c.layer+"Layer"]:g=this.mainLayer,i=this.normalizeOptions(f,c);for(h in i)i.hasOwnProperty(h)&&d.setAttributeNS(null,h,i[h]);return d.setAttributeNS(null,"x1",e[0][0]),d.setAttributeNS(null,"y1",e[0][1]),d.setAttributeNS(null,"x2",e[1][0]),d.setAttributeNS(null,"y2",e[1][1]),g.element.appendChild(d),this}),f.extendPrototype("svg","normalizeOptions",function(a,b){return{fill:b.fillColor||b.color||a.fillColor||a.color,"font-family":b.font||a.font,"font-size":b.fontSize||a.fontSize,size:b.size||a.size,stroke:b.lineColor||b.color||a.lineColor||a.color,"stroke-dasharray":b.dash||a.dash,"stroke-dashoffset":b.dashOffset||a.dashOffset,"stroke-width":b.lineWidth||a.lineWidth}}),f.extendPrototype("svg","oncontextmenu",function(a){this.contextmenu(a)}),f.extendPrototype("svg","path",function(b,c){var d=a.createElementNS("http://www.w3.org/2000/svg","path"),e="M"+b.reduce(function(a,b){return a+" L"+b.join(" ")}),f={fillColor:"rgba(255, 255, 255, 0)",lineColor:"rgba(0, 0, 255, 1)",lineWidth:"0.05"},g,h,i;c=c||{},"layer"in c?g=this[c.layer+"Layer"]:g=this.mainLayer,i=this.normalizeOptions(f,c);for(h in i)i.hasOwnProperty(h)&&d.setAttributeNS(null,h,i[h]);return d.setAttributeNS(null,"d",e),g.element.appendChild(d),this}),f.extendPrototype("svg","point",function(b,c){var d=a.createElementNS("http://www.w3.org/2000/svg","circle"),e={fillColor:"rgba(0, 0, 0, 1)",lineColor:"rgba(0, 0, 0, 1)",lineWidth:"0.05"},f,g,h;c=c||{},"layer"in c?f=this[c.layer+"Layer"]:f=this.mainLayer,h=this.normalizeOptions(e,c);for(g in h)h.hasOwnProperty(g)&&d.setAttributeNS(null,g,h[g]);return d.setAttributeNS(null,"cx",b[0]/b[2]),d.setAttributeNS(null,"cy",b[1]/b[2]),d.setAttributeNS(null,"r",.1),f.element.appendChild(d),this}),f.extendPrototype("svg","redraw",function(){return this}),f.extendPrototype("svg","resetView",function(){return this.ctx.setAttribute("transform","matrix("+this.origZoomX+", 0, 0, "+this.origZoomY+", "+this.origTranslateX+", "+this.origTranslateY+")"),this}),f.extendPrototype("svg","resize",function(a,b){return this.element.setAttribute("width",a+"px"),this.element.setAttribute("height",b+"px"),this}),f.extendPrototype("svg","text",function(b,c,d,e){var f=a.createElementNS("http://www.w3.org/2000/svg","text"),g={font:"Helvetica",fontSize:"16px",lineColor:"rgba(0, 0, 0, 1)",lineWidth:.05},h,i,j,k;e=e||{},"layer"in e?h=this[e.layer+"Layer"]:h=this.mainLayer,j=this.normalizeOptions(g,e),k=1/(3*parseFloat(j["font-size"]));for(i in j)j.hasOwnProperty(i)&&i!=="size"&&f.setAttributeNS(null,i,j[i]);return f.setAttributeNS(null,"transform","scale("+k+", -"+k+")"),f.textContent=b,f.setAttributeNS(null,"x",1/k*c),f.setAttributeNS(null,"y",1/k*d),h.element.appendChild(f),this}),h.vector=[],f.vector=function(a){var b,c,d;if(typeof a=="string"){b=a.split(":").map(parseFloat),b.length===2&&(b=b.splice(1,0,1)),a=[];for(d=b[0];d<=b[2];d+=b[1])a.push(d)}return a[g]=h.vector,a},f.extendPrototype("vector","constructor",f.vector),f.extendPrototype("vector","type","vector"),f.extendPrototype("vector","conjugate",function(){return f.vector(this.map(f.conjugate))}),f.extendPrototype("vector","dyadicProduct",function(a){return f.matrix(this.map(function(b){return a.map(function(a){return f.times(b,a)})}))}),f.extendPrototype("vector","isEqual",function(a){return this.length!==a.length?!1:this.every(function(b,c){return f.isEqual(b,a[c])})}),f.extendPrototype("vector","isZero",function(a){return this.every(f.isZero)}),f.extendPrototype("vector","map",function(a){return this.constructor(Array.prototype.map.call(this,a))}),f.extendPrototype("vector","minus",function(a){return this.plus(a.negative())}),f.extendPrototype("vector","negative",function(){return this.map(f.negative)}),f.extendPrototype("vector","normalize",function(){return this.times(1/this.size)}),f.extendPrototype("vector","plus",function(a){if(this.length===a.length)return f.vector(this.map(function(b,c){return f.plus(b,a[c])}))}),f.extendPrototype("vector","scalarproduct",function(a){var b=0,c,d;for(c=0,d=this.length;c<d;c++)b=f.plus(b,f.times(this[c],a[c]));return b}),f.extendPrototype("vector","size",function(){return Math.sqrt(this.conjugate().scalarproduct(this))}),f.extendPrototype("vector","times",function(a){var b=[],c,d;if(typeof a=="number"||a.type==="complex")return this.map(function(b){return f.times(b,a)});if(a.type==="matrix"){b=a.toColVectors();for(c=0,d=b.length;c<d;c++)b[c]=this.scalarproduct(b[c]);return f.vector(b)}}),f.extendPrototype("vector","toArray",function(){return this.slice()}),f.extendPrototype("vector","toContentMathML",function(){return this.reduce(function(a,b){return a+f.toContentMathML(b)},"<vector>")+"</vector>"}),f.extendPrototype("vector","toLaTeX",function(){return"\\begin{pmatrix}\n	"+this.reduce(function(a,b){return a+"\\\\\n	"+f.toLaTeX(b)})+"\n\\end{pmatrix}"}),f.extendPrototype("vector","toMathML",function(){return this.reduce(function(a,b){return a+"<mtr><mtd>"+f.toMathML(b)+"</mtd></mtr>"},"<mrow><mo>(</mo><mtable>")+"</mtable><mo>)</mo></mrow>"}),f.extendPrototype("vector","toString",function(){return"("+this.reduce(function(a,b){return a+", "+f.toLaTeX(b)})+")"}),f.extendPrototype("vector","vectorproduct",function(a){var b=[];return this.length===3&&a.length===3&&(b.push(f.minus(f.times(this[1],a[2]),f.times(this[2],a[1]))),b.push(f.minus(f.times(this[2],a[0]),f.times(this[0],a[2]))),b.push(f.minus(f.times(this[0],a[1]),f.times(this[1],a[0])))),f.vector(b)}),f.extend("vector","zero",function(a){var b=[],c;for(c=0;c<a;c++)b.push(0);return f.vector(b)}),h.circle={},f.circle=function(a,b){return a.type===undefined&&(a=f.point(a.concat(1))),Object.create(h.circle,{radius:{value:b,writable:!0},center:{value:a,writable:!0}})},f.extendPrototype("circle","constructor",f.circle),f.extendPrototype("circle","type","circle"),f.extendPrototype("circle","area",function(){return this.radius*this.radius*f.pi}),f.extendPrototype("circle","circumference",function(){return 2*this.radius*f.pi}),f.extendPrototype("circle","draw",function(a,b){if(Array.isArray(a)){var c=this;a.forEach(function(a){a.circle(c,b)})}else a.circle(this,b);return this}),f.extendPrototype("circle","isContaining",function(a){if(a.type==="point"&&a.dim===2)return a.distanceTo(this.center)<this.radius}),f.extendPrototype("circle","isEqual",function(a){return f.isEqual(this.radius,a.radius)&&this.center.isEqual(a.center)}),f.extendPrototype("circle","reflectAt",function(a){return f.circle(this.center.reflectAt(a),this.radius)}),f.extendPrototype("circle","toMatrix",function(){var a=this.center.get(0),b=this.center.get(1),c=this.radius;return f.matrix([[1,0,-a],[0,1,-b],[-a,-b,a*a+b*b-c*c]])}),h.complex={},f.complex=function(){var a,b,c;return arguments.length===1&&Array.isArray(arguments[0])&&arguments[0].length===2?(a=arguments[0],b=arguments[0][0],c=arguments[0][1]):arguments.length===2&&(b=arguments[0]*Math.cos(arguments[1]),c=arguments[0]*Math.sin(arguments[1]),a=[b,c]),Object.create(h.complex,{re:{value:b,enumerable:!0},im:{value:c,enumerable:!0},z:{value:a,enumerable:!0}})},f.extendPrototype("complex","constructor",f.complex),f.extendPrototype("complex","type","complex"),f.extendPrototype("complex","argument",function(a){return(Math.atan2(this.im,this.re)+2*Math.PI)%(2*Math.PI)}),f.extendPrototype("complex","abs",function(a){return f.hypot(this.re,this.im)}),f.extendPrototype("complex","arccos",function(){return f.minus(Math.PI/2,this.arcsin())}),f.extendPrototype("complex","arccot",function(){return f.minus(Math.PI/2,this.arctan())}),f.extendPrototype("complex","arccsc",function(){return f.times(f.complex([0,1]),f.ln(f.plus(f.sqrt(f.minus(1,f.divide(1,f.times(this,this)))),f.divide(f.complex([0,1]),this))))}),f.extendPrototype("complex","arcsin",function(){var a=this.re,b=this.im;return f.complex([f.sgn(a)/2*f.arccos(Math.sqrt(Math.pow(a*a+b*b-1,2)+4*b*b)-(a*a+b*b)),f.sgn(b)/2*f.arcosh(Math.sqrt(Math.pow(a*a+b*b-1,2)+4*b*b)+(a*a+b*b))])}),f.extendPrototype("complex","arctan",function(){var a=f.complex(-this.im,this.re);return f.times(f.complex([0,.5]),f.ln(f.divide(f.plus(1,a),f.minus(1,a))))}),f.extendPrototype("complex","artanh",function(){return f.times(.5,f.minus(f.ln(f.plus(1,this)),f.ln(f.minus(1,this))))}),f.extendPrototype("complex","compare",function(a){var b=f.sgn(this.abs()-a.abs());return b?b:f.sgn(this.argument()-a.argument())}),f.extendPrototype("complex","conjugate",function(){return f.complex([this.re,f.negative(this.im)])}),f.extendPrototype("complex","copy",function(){return f.complex([f.copy(this.re),f.copy(this.im)])}),f.extendPrototype("complex","cos",function(){return f.complex([f.cos(this.re)*f.cosh(this.im),-f.sin(this.re)*f.sinh(this.im)])}),f.extendPrototype("complex","cosh",function(){return f.complex([f.cos(this.im)*f.cosh(this.re),f.sin(this.im)*f.sinh(this.re)])}),f.extendPrototype("complex","divide",function(a){return this.times(f.inverse(a))}),f.extendPrototype("complex","exp",function(){return f.complex([f.exp(this.re)*f.cos(this.im),f.exp(this.re)*f.sin(this.im)])}),f.extendPrototype("complex","inverse",function(){return f.complex([f.divide(this.re,f.plus(f.pow(this.re,2),f.pow(this.im,2))),f.divide(f.negative(this.im),f.plus(f.pow(this.re,2),f.pow(this.im,2)))])}),f.extendPrototype("complex","isEqual",function(a){return typeof a=="number"?f.isEqual(this.re,a)&&f.isZero(this.im):a.type==="complex"?f.isEqual(this.re,a.re)&&f.isEqual(this.im,a.im):!1}),f.extendPrototype("complex","isFinite",function(){return f.isFinite(this.re)&&f.isFinite(this.im)}),f.extendPrototype("complex","isOne",function(){return f.isOne(this.re)&&f.isZero(this.im)}),f.extendPrototype("complex","isReal",function(){return f.isZero(this.im)}),f.extendPrototype("complex","isZero",function(){return f.isZero(this.re)&&f.isZero(this.im)}),f.extendPrototype("complex","ln",function(){return f.complex([f.ln(this.abs()),this.argument()])}),f.extendPrototype("complex","minus",function(a){return this.plus(f.negative(a))}),f.extendPrototype("complex","mod",function(a){return f.complex([f.mod(this.re,a),f.mod(this.im,a)])}),f.extendPrototype("complex","negative",function(){return f.complex([f.negative(this.re),f.negative(this.im)])}),f.extendPrototype("complex","plus",function(a){if(a.type==="complex")return f.complex([f.plus(this.re,a.re),f.plus(this.im,a.im)]);if(typeof a=="number")return f.complex([f.plus(this.re,a),this.im])}),f.extendPrototype("complex","pow",function(a){return f.complex(Math.pow(this.abs(),a),a*this.argument())}),f.extendPrototype("complex","sin",function(){return f.complex([f.sin(this.re)*f.cosh(this.im),f.cos(this.re)*f.sinh(this.im)])}),f.extendPrototype("complex","sinh",function(){return f.complex([f.cos(this.im)*f.sinh(this.re),f.sin(this.im)*f.cosh(this.re)])}),f.extendPrototype("complex","sgn",function(){return f.complex(1,this.argument())}),f.extendPrototype("complex","times",function(a){if(a.type==="complex")return f.complex([f.minus(f.times(this.re,a.re),f.times(this.im,a.im)),f.plus(f.times(this.re,a.im),f.times(this.im,a.re))]);if(typeof a=="number")return f.complex([f.times(this.re,a),f.times(this.im,a)])}),f.extendPrototype("complex","toContentMathML",function(){return'<cn type="complex-cartesian">'+this.re+"<sep/>"+this.im+"</cn>"}),f.extendPrototype("complex","toLaTeX",function(){var a="",b=!1;return f.isZero(this.re)||(a=f.toLaTeX(this.re),b=!0),f.isZero(this.im)||(a+=f.toLaTeX(this.im,b)+"i"),a.length===0&&(a="0"),a}),f.extendPrototype("complex","toMathML",function(){var a="",b=!1;return f.isZero(this.re)||(a=f.toMathML(this.re),b=!0),f.isZero(this.im)||(a+=f.toMathML(this.im,b)+"<mo>&#x2062;</mo><mi>i</mi>"),a.length===0&&(a="<mn>0</mn>"),a}),f.extendPrototype("complex","toMatrix",function(){return f.matrix([[this.re,f.negative(this.im)],[this.im,this.re]])}),f.extendPrototype("complex","toPoint",function(){return f.point(this.z.concat(1))}),f.extendPrototype("complex","toString",function(){var a="";return f.isZero(this.re)||(a=f.toString(this.re)),f.isZero(this.im)||(a+=(this.im>0?a.length?"+":"":"-")+f.toString(Math.abs(this.im))+"i"),a.length===0&&(a="0"),a}),f.extend("complex","one",f.complex([1,0])),f.extend("complex","zero",f.complex([0,0])),h.line=f.vector([]),f.line=function(a){return a[g]=h.line,Object.defineProperties(a,{dim:{value:a.length-1}}),a},f.extendPrototype("line","constructor",f.line),f.extendPrototype("line","type","line"),f.extendPrototype("line","draw",function(a,b){if(Array.isArray(a)){var c=this;a.forEach(function(a){a.line(c,b)})}else a.line(this,b);return this}),f.extendPrototype("line","isEqual",function(a){var b=this.normalize();return a=a.normalize(),this.dim!==a.dim?!1:b.every(function(b,c){return f.isEqual(b,a[c])})}),f.extendPrototype("line","isFinite",function(a){return!f.isZero(this[this.length-1])}),f.extendPrototype("line","isOrthogonalTo",function(a){return f.isEqual(f.point([0,0,1]).crossRatio(this.meet(f.line.infinteLine),a.meet(f.line.infinteLine),f.point.I,f.point.J),-1)}),f.extendPrototype("line","isParallelTo",function(a){return this.every(function(b,c){return f.isEqual(b,a[c])||c===a.length-1})}),f.extendPrototype("line","meet",function(a){return f.point([this[1]*a[2]-this[2]*a[1],a[0]*this[2]-this[0]*a[2],this[0]*a[1]-this[1]*a[0]])}),f.extendPrototype("line","normalize",function(a){var b=this[this.dim];return this.map(function(a){return a/b})}),f.extend("line","infiniteLine",f.line([0,0,1])),h.matrix=[],f.matrix=function(a){if(typeof a=="string"){if(a.indexOf("<")>-1)return f.MathML(a).parse();a=a.trim().replace(/;?\n/g,"],["),a=JSON.parse("[["+a+"]]")}return a[g]=h.matrix,Object.defineProperties(a,{cols:{value:a[0].length},rows:{value:a.length}}),a},f.extendPrototype("matrix","constructor",f.matrix),f.extendPrototype("matrix","type","matrix"),f.extendPrototype("matrix","adjugate",function(a){return this.map(function(a,b,c,d){return f.times(d.remove(c,b).determinant(),1-(b+c)%2*2)})}),f.extendPrototype("matrix","adjoint",function(a){return this.map(f.conjugate).transpose()}),f.extendPrototype("matrix","cholesky",function(){var a,b,c=[],d,e,g,h;for(a=0,b=this.rows;a<b;a++)c.push([]);for(a=0,b=this.rows;a<b;a++){for(h=0;h<a;h++){g=0;for(d=0,e=h;d<e;d++)g=f.plus(g,f.times(c[a][d],c[h][d]));c[a][h]=(this[a][h]-g)/c[h][h]}g=0;for(d=0,e=h;d<e;d++)g=f.plus(g,f.times(c[a][d],c[a][d]));c[a][h]=Math.sqrt(this[h][h]-g);for(h++;h<this.cols;h++)c[a][h]=0}return c=f.matrix(c),this.cholesky=function(){return c},c}),f.extendPrototype("matrix","copy",function(a){return this.map(f.copy)}),f.extendPrototype("matrix","determinant",function(){if(this.isSquare()){var a,b;return this.rank()<this.rows?b=0:(a=this.LU(),b=f.times(this.LUpermutation.sgn(),f.times.apply(null,a.diag()))),this.determinant=function(){return b},b}}),f.extendPrototype("matrix","diag",function(){var a=[],b,c;for(b=0,c=Math.min(this.rows,this.cols);b<c;b++)a.push(this[b][b]);return a}),f.extendPrototype("matrix","divide",function(a){return this.times(f.inverse(a))}),f.extendPrototype("matrix","every",function(a){return Array.prototype.every.call(this,function(b,c){return Array.prototype.every.call(b,function(b,d){return a(b,c,d,this)})})}),f.extendPrototype("matrix","forEach",function(a){Array.prototype.forEach.call(this,function(b,c){return Array.prototype.forEach.call(b,function(b,d){return a(b,c,d,this)})})}),f.extendPrototype("matrix","inverse",function(){if(!this.isSquare()&&this.determinant())return;return this.adjugate().divide(this.determinant())}),f.extendPrototype("matrix","isDiag",function(){var a,b,c,d;if((this.hasOwnProperty("isUpper")&&this.isUpper())+ +(this.hasOwnProperty("isLower")&&this.isLower())+ +(this.hasOwnProperty("isLower")&&this.isLower())>1)return!0;for(a=0,c=this.rows;a<c;a++)for(b=0,d=this.cols;b<d;b++)if(a!==b&&this[a][b]!==0)return!1;return!0}),f.extendPrototype("matrix","isEqual",function(a){var b,c,d,e;if(this===a)return!0;if(this.rows===a.rows&&this.cols===a.cols){for(b=0,d=this.rows;b<d;b++)for(c=0,e=this.cols;c<e;c++)if(!f.isEqual(this[b][c],a[b][c]))return!1;return!0}return!1}),f.extendPrototype("matrix","isIdentity",function(){if(!this.isSquare())return!1;var a=this.every(function(a,b,c){return b===c?f.isOne(a):f.isZero(a)});return this.isIdentity=function(){return a},a}),f.extendPrototype("matrix","isInvertible",function(){return this.isSquare()&&this.rank()===this.rows}),f.extendPrototype("matrix","isLower",function(){return this.slice(0,-1).every(function(a,b){return a.slice(b+1).every(f.isZero)})}),f.extendPrototype("matrix","isNegDefinite",function(){if(!this.isSquare())return;return this.rows===1?this[0][0]<0:this.rows%2===0?this.determinant()>0&&this.remove(this.rows-1,this.cols-1).isNegDefinite():this.determinant()<0&&this.remove(this.rows-1,this.cols-1).isNegDefinite()}),f.extendPrototype("matrix","isOrthogonal",function(){return this.transpose().times(this).isIdentity()}),f.extendPrototype("matrix","isPermutation",function(){var a=[],b=[];return this.every(function(c,d,e){return f.isOne(c)?a[d]||b[e]?!1:(a[d]=!0,b[e]=!0,!0):f.isZero(c)?!0:!1})&&a.length===this.rows&&b.length===this.cols}),f.extendPrototype("matrix","isPosDefinite",function(){if(!this.isSquare())return;return this.rows===1?this[0][0]>0:this.determinant()>0&&this.remove(this.rows-1,this.cols-1).isPosDefinite()}),f.extendPrototype("matrix","isReal",function(){return this.every(f.isReal)}),f.extendPrototype("matrix","isScalar",function(){var a=this.rows,b=this.diag,c;if(this.hasOwnProperty("isIdentity")&&this.hasOwnProperty("isZero"))return this.isIdentity()||this.isZero()?!0:!1;if(this.isDiag()){for(c=1;c<a;c++)if(!f.isEqual(b[0],b[c]))return!1;return!0}return!1}),f.extendPrototype("matrix","isSquare",function(){return this.cols===this.rows}),f.extendPrototype("matrix","isSymmetric",function(){var a,b,c=!0;if(!this.isSquare())c=!1;else a:for(a=0;a<this.rows;a++)for(b=a+1;b<this.cols;b++)if(!f.isEqual(this[a][b],this[b][a])){c=!1;break a}return this.isSymmetric=function(){return c},c}),f.extendPrototype("matrix","isUpper",function(){return this.slice(1).every(function(a,b){return a.slice(0,b+1).every(f.isZero)})}),f.extendPrototype("matrix","isVector",function(){return this.rows===1||this.cols===1}),f.extendPrototype("matrix","isZero",function(){var a=this.every(f.isZero);return this.isZero=function(){return a},a}),f.extendPrototype("matrix","LU",function(a){var b,c,d,e,g,h=this.toArray(),i=this.rows,j=this.cols,k=[];for(d=0;d<j;d++){if(!a){g=d;for(b=d+1;b<i;b++)Math.abs(h[b][d])>Math.abs(h[g][d])&&(g=b);g!==d&&(k.unshift([g,d]),e=h[g],h[g]=h[d],h[d]=e)}if(h[d][d]!==0)for(b=d+1;b<i;b++){h[b][d]=f.divide(h[b][d],h[d][d]);for(c=d+1;c<j;c++)h[b][c]=f.minus(h[b][c],f.times(h[b][d],h[d][c]))}}return h=f.matrix(h),this.LU=function(){return h},this.LUpermutation=f.permutation(k),h}),f.extendPrototype("matrix","map",function(a){var b=this;return f.matrix(Array.prototype.map.call(this,function(c,d){return Array.prototype.map.call(c,function(c,e){return a(c,d,e,b)})}))}),f.extendPrototype("matrix","minor",function(a,b){return this.remove(a,b).determinant()}),f.extendPrototype("matrix","minus",function(a){return this.plus(a.negative())}),f.extendPrototype("matrix","negative",function(){var a=[],b,c;for(b=0,c=this.rows;b<c;b++)a.push(this[b].map(f.negative));return f.matrix(a)}),f.extendPrototype("matrix","plus",function(a){var b=[],c=this.rows,d=this.cols,e,g;for(e=0;e<c;e++){b[e]=[];for(g=0;g<d;g++)b[e][g]=f.plus(this[e][g],a[e][g])}return f.matrix(b)}),f.extendPrototype("matrix","rank",function(){var a=0,b,c,d,e;b=this.rref();a:for(c=Math.min(this.rows,this.cols)-1;c>=0;c--)for(e=this.cols-1;e>=c;e--)if(!f.isZero(b[c][e])){a=c+1;break a}return this.rank=function(){return a},a}),f.extendPrototype("matrix","remove",function(a,b){var c=this.toArray();if(a||a===0)typeof a=="number"&&(a=[a]),c=c.filter(function(b,c,d){return a.indexOf(c)===-1});if(b||b===0)typeof b=="number"&&(b=[b]),b=b.sort().reverse(),b.forEach(function(a){c=c.map(function(b){return b.splice(a,1),b})});return f.matrix(c)}),f.extendPrototype("matrix","rref",function(){var a=0,b=this.toArray(),c,d,e,g,h;for(e=0;e<this.rows;e++){if(this.cols<=a)return f.matrix(b);c=e;while(b[c][a]===0){c++;if(this.rows===c){c=e,a++;if(this.cols===a)return f.matrix(b)}}var i=b[c];b[c]=b[e],b[e]=i,h=b[e][a];for(d=0;d<this.cols;d++)b[e][d]/=h;for(c=0;c<this.rows;c++){if(c===e)continue;h=b[c][a];for(d=0;d<this.cols;d++)b[c][d]=f.minus(b[c][d],f.times(h,b[e][d]))}a++}return f.matrix(b)}),f.extendPrototype("matrix","solve",function(a){var b=this.LU(),c,d,e=a.length,g=[],h=[];a=this.LUpermutation.applyTo(a);for(c=0;c<e;c++){h[c]=a[c];for(d=0;d<c;d++)h[c]=f.minus(h[c],f.times(b[c][d],h[d]))}for(c=e-1;c>=0;c--){g[c]=h[c];for(d=c+1;d<e;d++)g[c]=f.minus(g[c],f.times(b[c][d],g[d]));g[c]=f.divide(g[c],b[c][c])}return a.constructor(g)}),f.extendPrototype("matrix","some",function(a){return Array.prototype.some.call(this,function(b,c){return Array.prototype.some.call(b,function(b,d){return a(b,c,d,this)})})}),f.extendPrototype("matrix","times",function(a){var b=[],c,d,e,g;if(typeof a=="number"||a.type==="complex")return this.map(function(b){return f.times(b,a)});if(a.type==="matrix"){if(this.cols===a.rows){for(d=0;d<this.rows;d++){b[d]=[];for(e=0;e<a.cols;e++){c=0;for(g=0;g<this.cols;g++)c=f.plus(c,f.times(this[d][g],a[g][e]));b[d][e]=c}}return f.matrix(b)}}else if(a.type==="point"||a.type==="vector")if(this.cols===a.length){for(e=0;e<this.rows;e++){c=0;for(g=0;g<this.cols;g++)c=f.plus(c,f.times(this[e][g],a[g]));b.push(c)}return a.constructor(b)}}),f.extendPrototype("matrix","toArray",function(){return Array.prototype.map.call(this,function(a){return Array.prototype.map.call(a,function(a){return f.copy(a)})})}),f.extendPrototype("matrix","toColVectors",function(){return this.transpose().toRowVectors()}),f.extendPrototype("matrix","toComplex",function(){if(this.rows!==2||this.cols!==2||this[0][0]!==this[1][1]||this[0][1]!==f.negative(this[1][0]))return;return f.complex([this[0][0],this[1][0]])}),f.extendPrototype("matrix","toContentMathML",function(){return this.reduce(function(a,b){return a+b.reduce(function(a,b){return a+f.toContentMathML(b)},"<matrixrow>")+"</matrixrow>"},"<matrix>")+"</matrix>"}),f.extendPrototype("matrix","toLaTeX",function(){return"\\begin{pmatrix}\n"+this.reduce(function(a,b){return a+b.reduce(function(a,b){return a+" & "+f.toLaTeX(b)})+"\\\n"},"").slice(0,-2)+"\n\\end{pmatrix}"}),f.extendPrototype("matrix","toMathML",function(){return this.reduce(function(a,b){return a+b.reduce(function(a,b){return a+"<mtd>"+f.toMathML(b)+"</mtd>"},"<mtr>")+"</mtr>"},"<mrow><mo> ( </mo><mtable>")+"</mtable><mo> ) </mo></mrow>"}),f.extendPrototype("matrix","toRowVectors",function(){return this.toArray().map(f.vector)}),f.extendPrototype("matrix","toString",function(){return this.reduce(function(a,b){return a+b.reduce(function(a,b){return a+"	"+f.toString(b)})+"\n"},"").slice(0,-1)}),f.extendPrototype("matrix","trace",function(){var a=f.plus.apply(null,this.diag());return this.trace=function(){return a},a}),f.extendPrototype("matrix","transpose",function(){var a=[],b,c,d,e,g;for(c=0,e=this.cols;c<e;c++){b=[];for(d=0,g=this.rows;d<g;d++)b.push(this[d][c]);a.push(b)}return a=f.matrix(a),this.transpose=function(){return a},a}),f.extend("matrix","identity",function(a){var b=[],c=[],d,e;a=a||1;for(d=0,e=a-1;d<e;d++)b.push(0);b.push(1),b=b.concat(b),b=b.slice(0,-1);for(d=0,e=a;d<e;d++)c.push(b.slice(a-d-1,2*a-d-1));return f.matrix(c)}),f.extend("matrix","givensMatrix",function(a,b,c,d){var e=f.matrix.identity(a);return e[c][c]=e[b][b]=Math.cos(d),e[b][c]=Math.sin(d),e[c][b]=-e[b][c],e}),f.extend("matrix","numbers",function(a,b,c){var d=[],e=[],g,h;for(g=0,h=c||b||1;g<h;g++)d.push(a);for(g=0,h=b||1;g<h;g++)e.push(d.slice());return f.matrix(e)}),f.extend("matrix","one",function(a,b){return a=a||1,b=b||1,f.matrix.numbers(1,a,b)}),f.extend("matrix","random",function(a,b){var c,d=[],e,g,h,i;for(e=0,h=a||1;e<h;e++){c=[];for(g=0,i=b||a||1;g<i;g++)c.push(Math.random());d.push(c)}return f.matrix(d)}),f.extend("matrix","zero",function(a,b){return a=a||1,b=b||1,f.matrix.numbers(0,a,b)}),h.permutation=[],f.permutation=function(a){var b,c,d;return Array.isArray(a[0])?(b=a,c=f.permutation.cycleToList(b)):(c=a,b=f.permutation.listToCycle
(c)),c[g]=h.permutation,Object.defineProperties(c,{cycle:{value:b},max:{value:c.length-1}}),c},f.extendPrototype("permutation","constructor",f.permutation),f.extendPrototype("permutation","type","permutation"),f.extendPrototype("permutation","applyTo",function(a){var b,c;return typeof a=="number"?a<this.length?this[a]:a:(b=this,c=a.map(function(c,d){return a[b.applyTo(d)]}),a.type===undefined?c:a.constructor(c))}),f.extendPrototype("permutation","inverse",function(){var a=this.cycle.slice();return a.reverse().forEach(function(a){a.reverse()}),f.permutation(a)}),f.extendPrototype("permutation","map",function(a){return this.constructor(Array.prototype.map.call(this,a))}),f.extendPrototype("permutation","sgn",function(){var a=0,b;for(b=0;b<this.cycle.length;b++)a+=this.cycle[b].length;return a+=this.cycle.length,-2*(a%2)+1}),f.extendPrototype("permutation","times",function(a){var b=this;return a.map(function(a){return b[a]})}),f.extendPrototype("permutation","toMatrix",function(a){var b=[],c=[],d,e,g;a=a||this.length;for(e=0,g=a-1;e<g;e++)b.push(0);b=b.concat([1]).concat(b);for(e=0,g=a;e<g;e++)d=a-this.applyTo(e)-1,c.push(b.slice(d,d+a));return f.matrix(c)}),f.extendPrototype("permutation","toString",function(){var a="";return this.cycle.forEach(function(b){a+="("+(b+"")+")"}),a}),f.extend("permutation","cycleToList",function(a){var b,c=[],d,e,f,g,h;h=a.map(function(a){return Math.max.apply(null,a)}),h=Math.max.apply(null,h);for(d=0,e=h;d<=e;d++){u=d;for(f=0,g=a.length;f<g;f++)b=a[f].indexOf(u),++b&&(u=a[f][b%a[f].length]);c.push(u)}return c}),f.extend("permutation","id",f.permutation([[]])),f.extend("permutation","listToCycle",function(a){var b=[],c,d,e,f,g=[];for(d=0,e=a.length;d<e;d++){c=d,f=[];while(!b[c])b[c]=!0,f.push(c),c=a[c];f.length&&g.push(f)}return g}),h.point=f.vector([]),f.point=function(a){return arguments.length>1&&(a=Array.prototype.slice.call(arguments).concat(1)),a[g]=h.point,Object.defineProperties(a,{dim:{value:a.length-1}}),a},f.extendPrototype("point","constructor",f.point),f.extendPrototype("point","type","point"),f.extendPrototype("point","crossRatio",function(a,b,c,d){var e=this.toArray(),g=f.matrix([e,a,c]),h=f.matrix([e,b,d]),i=f.matrix([e,a,d]),j=f.matrix([e,b,c]);return g.det()*h.det()/(i.det()*j.det())}),f.extendPrototype("point","distanceTo",function(a){var b=0,c;if(arguments.length===0){for(c=0;c<this.dim;c++)b+=Math.pow(this[c],2);return Math.sqrt(b)}if(a.type==="point"&&this.dim===a.dim)for(c=0;c<this.dim;c++)b+=Math.pow(this[c]-a[c],2);return Math.sqrt(b)}),f.extendPrototype("point","draw",function(a,b){if(Array.isArray(a)){var c=this;a.forEach(function(a){a.point(c,b)})}else a.point(this,b);return this}),f.extendPrototype("point","isEqual",function(a){var b=this.normalize();return a=a.normalize(),this.dim!==a.dim?!1:b.every(function(b,c){return f.isEqual(b,a[c])})}),f.extendPrototype("point","isFinite",function(a){return!f.isZero(this[this.length-1])}),f.extendPrototype("point","isInside",function(a){if(a.type==="circle")return this.distanceTo(a.center)<a.radius}),f.extendPrototype("point","isOn",function(a){if(a.type==="line")return this.distanceTo(a.center)===a.radius;if(a.type==="circle")return this.distanceTo(a.center)===a.radius}),f.extendPrototype("point","isOutside",function(a){if(a.type==="circle")return this.distanceTo(a.center)>a.radius}),f.extendPrototype("point","lineTo",function(a){if(this.dim===2&&a.dim===2)return f.line(this,a)}),f.extendPrototype("point","normalize",function(a){var b=this[this.dim];return this.map(function(a){return a/b})}),f.extendPrototype("point","reflectAt",function(a){if(a.type==="point"&&this.dim===a.dim){var b=[],c,d=this.normalize();a=a.normalize();for(c=0;c<this.dim;c++)b.push(2*a[c]-d[c]);return b.push(1),f.point(b)}}),f.extendPrototype("point","toArray",function(){var a=[],b,c;for(b=0,c=this.dim;b<=c;b++)a.push(this[b]);return a}),f.extendPrototype("point","toComplex",function(){if(this.dim===2)return f.complex(this[0]/this[2],this[1]/this[2])}),f.extendPrototype("point","toLaTeX",function(a){var b=a?this:this.normalize().slice(0,-1);return"\\begin{pmatrix}\n	"+b.reduce(function(a,b){return a+"\\\\\n	"+f.toLaTeX(b)})+"\n\\end{pmatrix}"}),f.extendPrototype("point","toMathML",function(a){var b=a?this:this.normalize().slice(0,-1);return b.reduce(function(a,b){return a+"<mtr><mtd>"+f.toMathML(b)+"</mtd></mtr>"},"<mrow><mo>(</mo><mtable>")+"</mtable><mo>)</mo></mrow>"}),f.extendPrototype("point","toString",function(a){var b=a?this:this.normalize().slice(0,-1);return"("+b.reduce(function(a,b){return a+", "+f.toString(b)})+")"}),f.extend("point","I",function(){var a=f.complex(0,-1);return f.point([a,0,1])}()),f.extend("point","J",function(){var a=f.complex(0,1);return f.point([a,0,1])}()),h.polynomial=[],f.polynomial=function(a){var b=[];if(a===undefined||a.length===0)a=[0];else if(typeof a=="number"){while(a--)b.push(0);b.push(1),a=b}return a[g]=h.polynomial,Object.defineProperties(a,{deg:{value:a.length-1},subdeg:{value:function(a){var b=0;if(a.length>1||a[0]){while(b<a.length&&f.isZero(a[b]))b++;return b}return Infinity}(a)}}),a},f.extendPrototype("polynomial","constructor",f.polynomial),f.extendPrototype("polynomial","type","polynomial"),f.extendPrototype("polynomial","content",function(){return f.gcd(this)}),f.extendPrototype("polynomial","differentiate",function(a){if(a===0)return this;if(a<0)return this.integrate(-a);var b=[],c;a=a||1;for(c=0;c<=this.deg-a;c++)b[c]=f.times(this[c+a],f.fallingFactorial(c+a,a));return f.polynomial(b)}),f.extendPrototype("polynomial","draw",function(a,b){var c=[],d,e=this;if(this.deg<2)Array.isArray(a)?a.forEach(function(a){a.line([[-50,e.valueAt(-50)],[50,e.valueAt(50)]],b)}):a.line([[-50,this.valueAt(-50)],[50,this.valueAt(50)]],b);else{for(d=-50;d<=50;d=Math.round((d+.01)*100)/100)c.push([d,this.valueAt(d)]);Array.isArray(a)?a.forEach(function(a){a.path(c,b)}):a.path(c,b)}return this}),f.extendPrototype("polynomial","integrate",function(a){var b=[],c;a=a||1;if(f.isZero(a))return this;if(a<0)return this.differentiate(-a);for(c=0;c<a;c++)b.push(0);for(c=0;c<=this.deg;c++)b[c+a]=this[c]/f.fallingFactorial(c+a,a);return f.polynomial(b)}),f.extendPrototype("polynomial","isEqual",function(a){var b,c;if(this.deg!==a.deg||this.subdeg!==a.subdeg)return!1;for(b=0,c=this.deg;b<=c;b++)if(!f.isEqual(this[b],a[b]))return!1;return!0}),f.extendPrototype("polynomial","isPrimitive",function(){return f.gcd(this)===1}),f.extendPrototype("polynomial","isReal",function(){return this.every(f.isReal)}),f.extendPrototype("polynomial","map",function(a){return f.polynomial(Array.prototype.map.call(this,a))}),f.extendPrototype("polynomial","mod",function(a){return this.map(function(b){return f.mod(b,a)})}),f.extendPrototype("polynomial","negative",function(){return f.polynomial(this.map(f.negative))}),f.extendPrototype("polynomial","plus",function(a,b){var c=[],d;if(typeof a=="number"){if(b)return this.map(function(b){return f.plus(a,b)});c=this.slice(),c[0]=f.plus(c[0],a)}else if(a.type==="polynomial"){for(d=0;d<=Math.min(this.deg,a.deg);d++)c[d]=f.plus(this[d],a[d]);c=c.concat((this.deg>a.deg?this:a).slice(d))}return f.polynomial(c)}),f.extendPrototype("polynomial","tangent",function(a){var b=this.valueat(a),c=this.differentiate().valueAt(a);return f.polynomial([b-c*a,c])}),f.extendPrototype("polynomial","times",function(a){var b=[],c,d;if(a.type==="polynomial")for(c=0;c<=this.deg;c++)for(d=0;d<=a.deg;d++)b[c+d]=f.plus(b[c+d]?b[c+d]:0,f.times(this[c],a[d]));else b=this.map(function(b){return f.times(a,b)});return f.polynomial(b)}),f.extendPrototype("polynomial","toContentMathML",function(){var a="<apply><plus/>",b,c;for(b=0,c=this.deg;b<=c;b++)f.isZero(this[b])||(b===0?a+=f.toContentMathML(this[b]):a+="<apply><times/>"+f.toContentMathML(this[b],!0),b>1?a+="<apply><power/><ci>x</ci>"+f.toContentMathML(b)+"</apply></apply>":b===1&&(a+="<ci>x</ci></apply>"));return a+"</apply>"}),f.extendPrototype("polynomial","toLaTeX",function(){var a="",b,c;for(b=0,c=this.deg;b<=c;b++)f.isZero(this[b])||(b===0?a+=f.toLaTeX(this[b]):a+=f.toLaTeX(this[b],!0),b>1?a+="x^{"+f.toLaTeX(b)+"}":b===1&&(a+="x"));return a}),f.extendPrototype("polynomial","toMathML",function(){var a="<mrow>",b,c;for(b=0,c=this.deg;b<=c;b++)f.isZero(this[b])||(b===0?a+=f.toMathML(this[b]):a+=f.toMathML(this[b],!0),b>1?a+="<mo>&#x2062;</mo><msup><mi>x</mi>"+f.toMathML(b)+"</msup>":b===1&&(a+="<mo>&#x2062;</mo><mi>x</mi>"));return a+"</mrow>"}),f.extendPrototype("polynomial","toString",function(a){var b="",c,d;for(c=0,d=this.deg;c<=d;c++)f.isZero(this[c])||(c===0?b+=f.toString(this[c]):b+=f.toString(this[c],!0),c>1?b+="*x^"+f.toString(c):c===1&&(b+="*x"));return b}),f.extendPrototype("polynomial","valueAt",function(a){var b=f.is(a,"matrix")?f.matrix.identity(a.rows,a.cols):1,c=f.is(a,"matrix")?f.matrix.zero(a.rows,a.cols):0,d,e;for(d=0,e=this.deg;d<=e;d++)c=f.plus(c,f.times(this[d],b)),b=f.times(b,a);return c}),f.extend("polynomial","regression",function(a,b){var c=a.length,d=0,e=0,g=0,h=0,i,j,k;if(arguments.length===2)for(k=0;k<c;k++)d+=a[k]*b[k],e+=a[k],g+=b[k],h+=a[k]*a[k];else for(k=0;k<c;k++)d+=a[k][0]*a[k][1],e+=a[k][0],g+=a[k][1],h+=a[k][0]*a[k][0];return i=(c*d-e*g)/(c*h-e*e),j=(g*h-d*e)/(c*h-e*e),f.polynomial([j,i])}),f.extend("polynomial","interpolation",function(a,b){var c,d=f.polynomial([0]),e=a.length,g,h,i,j;arguments.length===2&&(a=a.map(function(a,c){return[a,b[c]]}));for(g=0;g<e;g++){c=f.polynomial([1]);for(h=0;h<e;h++)g!==h&&(c=c.times(f.polynomial([-a[h][0]/(a[g][0]-a[h][0]),1/(a[g][0]-a[h][0])])));d=d.plus(c.times(a[g][1]))}return d}),f.extend("polynomial","one",f.polynomial([1])),f.extend("polynomial","roots",function(a){var b,c=[],d,e;f.type(a)==="array"&&(a=f.set(a,!0)),b=a.powerset();for(d=0,e=a.card;d<e;d++)c[d]=0;return b.slice(1).forEach(function(a,b){c[e-a.card]=f.plus(c[e-a.card],a.times())}),c=c.map(function(a,b){return(e-b)%2?f.negative(a):a}),c.push(1),f.polynomial(c)}),f.extend("polynomial","zero",f.polynomial([0])),f.set=function(a,b){return a||(a=[]),a=a.sort(f.compare),b||(a=a.filter(function(a,b,c){return a!==c[b+1]})),a[g]=h.set,Object.defineProperties(a,{card:{get:function(){return this.length}},multiset:{value:!!b}}),a},f.extendPrototype("set","constructor",f.set),f.extendPrototype("set","type","set"),f.extendPrototype("set","compare",function(a){if(this.card!==a.card)return f.sgn(this.card-a.card);var b=0,c=!1;return this.forEach(function(d,e){if(!c){var g=f.compare(d,a[e]);g!==0&&(b=g,c=!0)}}),b}),f.extendPrototype("set","filter",function(a){return f.set(Array.prototype.filter.call(this,a))}),f.extendPrototype("set","insert",function(a){var b=this.locate(a);return(this[b]!==a||this.multiset)&&this.splice(b,0,a),this}),f.extendPrototype("set","isEmpty",function(){return this.card===0}),f.extendPrototype("set","isEqual",function(a){return this.card!==a.card?!1:this.every(function(b,c){return f.isEqual(b,a[c])})}),f.extendPrototype("set","isSubsetOf",function(a){return this.every(function(b){return a.indexOf(b)!==-1})}),f.extendPrototype("set","locate",function(a){var b=0,c=this.card-1,d,e=this.indexOf(a);if(e!==-1)return e;while(b<=c){d=b+Math.floor((c-b)/2);if(this[d]<a)b=d+1;else{if(this[d]<=a)return d;c=d-1}}return b}),f.extendPrototype("set","map",function(a){return f.set(Array.prototype.map.call(this,a))}),f.extendPrototype("set","plus",function(a){var b=[];return arguments.length?Array.isArray(a)?(this.forEach(function(c){a.forEach(function(a){b.push(f.plus(c,a))})}),f.set(b)):this.map(function(b){return f.plus(b,a)}):f.plus.apply(null,this)}),f.extendPrototype("set","powerset",function(a){var b=[],c,d,e,g,h,i;for(e=0,g=Math.pow(2,this.card);e<g;e++){c=e.toString(2).split("").reverse(),d=[];for(h=0,i=this.card;h<i;h++)c[h]==="1"&&d.push(this[h]);b.push(f.set(d))}return f.set(b)}),f.extendPrototype("set","remove",function(a){var b=this.indexOf(a);return b!==-1&&this.splice(b,1),this}),f.extendPrototype("set","times",function(a){return arguments.length?this.map(function(b){return f.times(b,a)}):f.times.apply(null,this)}),f.extendPrototype("set","toArray",function(){return this.slice()}),f.extendPrototype("set","toLaTeX",function(){return this.isEmpty()?"\\emptyset":this.reduce(function(a,b){return a+f.toLaTeX(b)+", "},"\\{").slice(0,-2)+"\\}"}),f.extendPrototype("set","toContentMathML",function(){return this.isEmpty()?"<emptyset/>":this.reduce(function(a,b){return a+f.toContentMathML(b)},"<set>")+"</set>"}),f.extendPrototype("set","toMathML",function(){return this.isEmpty()?"<mi>&#x2205;</mi>":this.reduce(function(a,b){return a+f.toMathML(b)+"<mo>,</mo>"},"<mrow><mo>{</mo>").slice(0,-10)+"<mo>}</mo></mrow>"}),f.extendPrototype("set","toMultiset",function(){return f.set(this.toArray(),!0)}),f.extendPrototype("set","toSet",function(){return f.set(this.toArray())}),f.extendPrototype("set","toString",function(){return this.isEmpty()?"∅":"("+this.join(", ")+")"}),function(){var a=function(a,b,c){return function(d){var e=[],g=0,h=0,i=this.card,j=d.card;while(g<i&&h<j){if(this[g]<d[h]){a&&e.push(this[g]),g++;continue}if(this[g]>d[h]){c&&e.push(d[h]),h++;continue}if(this[g]===d[h]){b&&e.push(this[g]),g++,h++;continue}}return a&&h===j?e=e.concat(this.slice(g)):c&&g===i&&(e=e.concat(d.slice(h))),f.set(e,!0)}};f.extendPrototype("set","union",a(!0,!0,!0)),f.extendPrototype("set","intersect",a(!1,!0,!1)),f.extendPrototype("set","without",a(!0,!1,!1)),f.extendPrototype("set","xor",a(!0,!1,!0))}(),f.extend("set","fromTo",function(a,b,c){var d,e=[];c=c||1;if(a<=b){for(d=a;d<=b;d+=c)e.push(d);return f.set(e)}}),c.MathLib=f,f.noConflict=function(){return c.MathLib=d,f}}(document);;